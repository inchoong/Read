(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{289:function(e,t,n){"use strict";n.r(t);var r=n(796),o=n(571);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(760);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(61)),o=i(n(191));function i(e){return e&&e.__esModule?e:{default:e}}var a=n(22),s=n(7);t.default={isMemberShipValid:function(e){return 0!==(0,r.default)(e).length&&(0===a.get(e,"expired",1)&&0<a.get(e,"expiredTime",0)&&(new Date).getTime()<1e3*a.get(e,"expiredTime",0))},canReceiveMemberCard:function(e){return s.inDevelopment()&&console.log(e),!1},canBookFreeReading:function(e){var t=e.bookInfo,n=e.memberCardSummary;return this.isMemberShipValid(n)&&(o.default.isSupportMemberShip(t)||-1<a.get(n,"freeBookIds",[]).indexOf(t.bookId))},discountToChinese:function(e){var t=["零","一","二","三","四","五","六","七","八","九"],n=100-e;return n<=0?"":n<10?t[0]+t[n]+"折":n<100?n%10==0?t[n/10]+"折":t[n/10]+t[n%10]+"折":""}}},529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(191)),i=r(n(518));function r(e){return e&&e.__esModule?e:{default:e}}t.default={isChapterNeedPay:function(e){var t=e.bookInfo,n=e.memberCardSummary,r=e.chapter;return(!n||!i.default.canBookFreeReading({bookInfo:t,memberCardSummary:n}))&&(!o.default.isFree(t)&&(!o.default.isLimitFree(t)&&(0===t.paid&&(!(t.maxFreeChapter>=r.chapterIdx)&&(!o.default.isBuyUnitChapter(t)||0<r.price&&0===r.paid)))))},formatChapterUids:function(e){if(0===e.length)return"";var t=[],n=-1,r=-1,o=-1;return e.forEach(function(e){-1===n?n=e:o+1===e?r=e:(t.push(-1===r?n.toString():n+"-"+r),r=-1,n=e),o=e}),-1!==n&&t.push(-1===r?n.toString():n+"-"+r),t.join(",")},getChapterTitle:function(e,t){var n=e.title;return t?n:["第"+e.chapterIdx+"章",n].filter(function(e){return 0<e.length}).join(" ")}}},571:function(e,t,n){"use strict";n.r(t);var r=n(572),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=ne(n(131)),S=ne(n(277)),I=ne(n(286)),o=ne(n(132)),s=ne(n(64)),u=ne(n(61)),d=ne(n(700)),h=ne(n(520)),f=ne(n(669)),i=ne(n(135)),p=te(n(34)),_=te(n(60)),a=n(35),l=ne(n(191)),c=ne(n(518)),g=ne(n(42)),v=ne(n(529)),m=ne(n(711)),C=ne(n(712)),b=ne(n(715)),E=ne(n(717)),R=ne(n(723)),k=ne(n(725)),T=ne(n(727)),y=ne(n(281)),w=n(63),A=ne(w),D=ne(n(134)),B=ne(n(729)),L=ne(n(731)),N=ne(n(733)),O=ne(n(278)),P=ne(n(735)),x=ne(n(738)),M=ne(n(676)),H=ne(n(746)),U=ne(n(749)),F=ne(n(44)),$=ne(n(45)),W=ne(n(46)),j=ne(n(47)),G=ne(n(751)),q=ne(n(62)),z=ne(n(192)),K=ne(n(198)),V=te(n(754)),Y=ne(n(755)),Q=ne(n(757)),X=ne(n(670)),J=ne(n(677)),Z=te(n(573)),ee=ne(n(138));function te(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function ne(e){return e&&e.__esModule?e:{default:e}}var re=n(7),oe=n(22),ie=n(137),ae=n(675),se="reader",ce="book",le="bookReview",ue=0,de=[],he=[],fe=!1,pe=null,ge=[],_e=0,ve=null,me=!1,Ce=[],be=[],Ee=!1;t.default={name:se,components:{ReaderNotePanel:Q.default,ReaderLoginGuide:N.default,ReaderBottomSettingPanel:T.default,ReaderBottomBar:k.default,ReaderMemberCardTips:U.default,PayChapterDialog:L.default,ReaderTopReviews:Y.default,PayWholeBookDialog:B.default,Loading:D.default,BackgroundMask:y.default,ReaderTopBar:R.default,ReaderCatalog:E.default,ReaderBookInfo:b.default,ReaderControls:C.default,CustomStyle:m.default},asyncData:function(e){var t=e.store,n=e.user,r=e.envConfig;t.registerModule(se,(0,d.default)()),t.registerModule(ce,(0,h.default)()),t.registerModule(le,(0,f.default)());var o=t.state.route.params.infoId,i=ie.parseReaderInfoId(o),a=i.bookId;t.commit(_.UPDATE_INIT_BOOK_ID,a);var s=i.chapterUid,c=s?parseInt(s):0,l=re.hasLogin(n);return t.dispatch(p.FETCH_READER_INIT_DATA,{initChapterUid:c,envConfig:r,isLogin:l}).then(function(){var e=t.state[se].bookInfo;0<(0,u.default)(e).length&&(t.commit(_.UPDATE_PAGE_TITLE,e.title+"-"+e.author+"-微信读书"),2===e.ispub?t.commit(_.UPDATE_PAGE_KEYWORDS,[e.title,e.author,e.category,e.title+"免费小说",e.title+"更新","免费小说","小说下载"].join(",")):t.commit(_.UPDATE_PAGE_KEYWORDS,[e.title,e.author,e.category,"免费小说",e.publisher].join(",")),t.commit(_.UPDATE_PAGE_DESCRIPTION,e.intro)),t.commit(_.UPDATE_READER_PAGE_SERVER_TIMESTAMP,parseInt((new Date).getTime()/1e3))})},created:function(){if(re.isEnvClient){var n=this;this.$store.registerModule(se,(0,d.default)(),{preserveState:!0}),this.$store.registerModule(ce,(0,h.default)(),{preserveState:!0}),this.$store.registerModule(le,(0,f.default)(),{preserveState:!0}),this.$store.commit(_.UPDATE_READER_PAGE_CLIENT_TIMESTAMP,parseInt((new Date).getTime()/1e3)),this.restoreFontSizeLevel(),(0,O.default)(),(0,P.default)(),(0,x.default)(),(0,M.default)(),(0,H.default)(),["contextmenu","dragstart","selectstart","select","copy","beforecopy"].forEach(function(e){document.addEventListener(e,function(e){return!!Ee||(e.preventDefault?e.preventDefault():e.returnValue=!1,!1)},!1)});var r=oe.throttle(this.handleClickPrevChapter,500),o=oe.throttle(this.handleClickNextChapter,500),i=67,a=85,s=37,c=39;document.addEventListener("keydown",function(e){var t=(e=e||window.event).ctrlKey||e.metaKey;switch(e.keyCode){case i:t&&n.canCopy(Ce)&&(n.copyObjsText(Ce),n.clearSelection());break;case a:t&&n.hasLogin&&n.hasSelection()&&(n.underlineObjs(Ce),n.clearSelection());break;case s:r();break;case c:o()}})}},mounted:function(){var d=this;if(re.isEnvClient){var e=this.$router.currentRoute.query;if(e&&e.packetId&&this.$store.dispatch(p.FETCH_ENCOURAGE_MONEY,{packetId:e.packetId}),this.logOnClientMounted(),!l.default.isSupportedBookType(this.bookInfo.type))return;var h=this;g.default.handleElementScrollEvent(window,null,function(e){var t=e.clientHeight,n=e.scrollTop,r=e.scrollHeight;h.$footerNote.hide(),h.tryToHideMenu(),h.$refs.readerCatalog&&h.$refs.readerCatalog.isShowing()||h.tryUpdateBottomBarClassList({clientHeight:t,scrollTop:n,scrollHeight:r}),h.isShowBottomSettingPanel&&(h.isShowBottomSettingPanel=!1)});var t=document.documentElement;t&&t.addEventListener("click",function(e){var t=(e=e||window.event).target,n=t.nodeName.toLowerCase(),r=e.target.classList,o=!0;"a"!==n&&"1"!==t.getAttribute("data-ignore-toolbar-update-hidden")&&!r.contains("reader_footer_note")||(o=!1),o&&(d.tryToHideMenu(),d.tryUpdateBottomBarClassList(),h.isShowBottomSettingPanel&&(h.isShowBottomSettingPanel=!1));var i=h.$refs.readerControls;if(i&&i.isFontSizePanelShowing()){for(var a=document.querySelector(".readerControls_fontSize"),s=!0,c=t;a&&c&&c!==document.body;){if(a&&a===c){s=!1;break}c=c.parentNode}s&&i.hideFontSizePanel()}var l=(new Date).getTime()-_e<500;if(l){var u=d.clientXY2RenderAreaXY({x:e.clientX,y:e.clientY});l=Math.pow(Math.pow(Math.abs(u.x-ve.x),2)+Math.pow(Math.abs(u.y-ve.y),2),.5)<10}l&&d.clearSelection()});var n=oe.throttle(h.resizeToReCollect,1e3);window.onresize=oe.debounce(function(){var e=h.$refs.renderTargetContainerSibling;if(e){var t=e.offsetWidth;ue!==t&&n(t)}},200),this.loadTopReviews(),this.isNeedShowNyNote&&this.$store.dispatch(p.FETCH_BOOK_BOOKMARK_LIST,{bookId:this.bookId,type:V.BookMarkTypeUnderline});var r=+new Date,o=e&&"1"===e.autoscroll&&this.isCurrentChapterTheFirst;this.$store.dispatch(p.FETCH_READER_CHAPTER_CONTENT).then(function(){return d.waitForPreRender().then(function(){if(re.inDevelopment()){var e=+new Date;console.log("[reader-layout] mounted 预加载耗费的时间 = ",e-r,"毫秒")}return d.collectPreRenderInfos()}).then(function(){var e=d.currentChapter,t=d.progress,n=oe.get(t,"book.chapterUid",0);if(e&&e.chapterUid===n&&!d.isFromWeReadApp){var r=oe.get(t,"book.chapterOffset",0);d.scrollTo({chapterOffset:r,ignoreWhenScrollToTop:!o})}else o&&d.handleClickStartReading();return{success:!0}})},function(e){return e}).then(function(e){e&&e.success&&(d.hasLogin&&d.$store.dispatch(p.UPDATE_READER_LOCAL_LAST_CHAPTER),d.setupProgressReportOnDomReady(),d.requestMemberCardPriceIfNeeded(),d.checkIfShowMemberCardFreeReadingTips(),d.handleLoginPendingActions(),d.checkIfNeedRequestLoginQRCode())}).catch(function(e){console.log("Error in FETCH_READER_CHAPTER_CONTENT",e)}),this.autoSearchOnClientMounted()}},beforeDestroy:function(){pe&&clearTimeout(pe)},destroyed:function(){this.$store.unregisterModule(se),this.$store.unregisterModule(ce),this.$store.unregisterModule(le)},data:function(){return{fontSizeLevel:2,fontSizeLevelCount:5,isShowPayWholeDialog:!1,isShowPayChapterDialog:!1,isShowBottomSettingPanel:!1,isPhoneBottomBarActive:!1,chapterContentHighLightBgHtml:"",chapterContentSelectionHtml:"",renderContentsVersion:-1,hasFetchMemberCardPrice:!1,buyMemberCardButtonLine1:"无限卡 19元/月 · 全场书籍免费读",buyMemberCardButtonLine2:"",loginGuideQRCodeImg:"",isLoginGetUidError:!1,isLoginGetInfoError:!1,isLoginQRCodeLoading:!1,autoLoadLoginQRCodeCount:1,isBalanceNeedAuth:!1}},methods:{tryToHideMenu:function(){var e=this.$refs.reader_top_bar;e&&e.isMenuShowing&&e.handleHideMenu()},tryUpdateBottomBarClassList:function(e){if(re.isEnvClient){if(this.isFromWeReadApp)return;if(document.querySelector(".readerBottomBar")){if(e){var t=e.clientHeight||0,n=e.scrollTop||0,r=e.scrollHeight||0;return void(this.isPhoneBottomBarActive=r-50<=t+n)}this.isPhoneBottomBarActive=!this.isPhoneBottomBarActive}}},handleTopWriteReviewClickEvent:function(e){var a=this,t=e.score;this.hasLogin?(this.reportClientBusiness({itemName:"Web_Reader_WriteBookReview"}),this.$showWriteReviewDialog({vid:this.user.vid||0,bookId:this.bookId,score:t},function(){a.$toast("发表中...",36e4)},function(e){var t=e.bookId,n=e.content,r=e.star,o=e.isPrivate,i=e.friendship;a.$writeReviewDialog.getIsSending()||(a.$writeReviewDialog.setIsSending(!0),a.$writeReviewDialog.setIsSendedSucc(!0),a.$store.dispatch(p.FETCH_BOOK_REVIEW_ADD,{bookId:t,content:n,star:r,isPrivate:o,friendship:i}).then(function(e){console.log("[zhoonlog] res = "+(0,s.default)(e.data));var t=oe.get(e,"data.reviewId","");t&&0<t.length?(a.$hideToast(),a.$toast("发表成功"),a.$writeReviewDialog.closeDialog()):(a.$hideToast(),a.$toast("发表失败，请重试")),a.$writeReviewDialog.setIsSending(!1),a.reportClientBusiness({itemName:"Web_WriteBookReview_Succ"})}).catch(function(e){a.$hideToast(),a.$toast("发表失败，请重试"),a.$writeReviewDialog.setIsSending(!1),console.log("[zhoonlog] err = "+e)}))})):this.$showLoginDialog({bottomTitle:"扫码登录微信读书",bottomSubTitle:"登录后可以点评此书"})},onClickLogout:function(){return this.$store.dispatch(p.FETCH_LOGOUT).then(function(e){e&&1===e.success&&window.location.reload()})},handleClickTopBarItem:function(e){switch(e){case"login":return this.$showLoginDialog();case"logout":return this.onClickLogout();case"gotoShelf":return this.onClickShelf();case"addShelf":return this.reportClientBusiness({itemName:"Web_Reader_TopAddClk"}),this.handleClickShelfButton();case"firstChapter":return this.handleClickFirstChapter()}},onClickShelf:function(){this.saveReportInfo("Nav_Shelf"),(0,i.default)("/web/shelf")},waitForPreRender:function(){var E=this;return new o.default(function(b){function n(){var e=E.$refs.renderTargetContainerSibling,t=E.$refs.preRenderContainer;if(!e||!t)return console.error("waitForPreRender-wait: dom is not exist: target="+!!e+",prerender="+!!t+",state="+E.chapterContentState),void b();var n=t.getElementsByTagName("img"),r=n.length;if(0<r){for(var o=+new Date,i=0;i<r;i++){var a=n[i],s=a.outerHTML,c=Math.min(e.offsetWidth,a.parentNode.offsetWidth);if(-1!==s.indexOf("data-w")&&-1!==s.indexOf("data-ratio")){var l=new RegExp('data-w="(.*?)px"',"ig");s.match(l);var u=RegExp.$1,d=u&&0<u.length?parseInt(u):0;l=new RegExp('data-ratio="(.*?)"',"ig"),s.match(l);var h=RegExp.$1,f=h&&0<h.length?parseFloat(h):0;if(0!==d&&0!==f){var p=a.getBoundingClientRect(),g=d/f,_=g;if((l=new RegExp("width[0-9]{2,3}","ig")).test(s)){l=new RegExp("width([0-9]{2,3})","ig"),s.match(l);var v=RegExp.$1,m=v&&0<v.length?parseInt(v):0;0<m&&m<=100&&(d*=(_=c*m/100)/g)}else-1!==s.indexOf("qqreader-fullimg")||-1!==s.indexOf("bleed-pic")||a.parentNode.classList.contains("bleed-pic")?d*=(_=c)/g:0<p.height&&p.height<d?_=(d=p.height)/f:0<p.width&&p.width<_&&(d*=(_=p.width)/g);c<_&&(d*=c/_,_=c),a.style.width=_+"px",a.style.height=d+"px"}else console.log("[img-style] img no height or ratio, height = "+d+" ratio = "+f),re.inDevelopment()&&alert("找 zhoon 看看 - img no height or ratio")}else console.log("[img-style] img no height or ratio"),re.inDevelopment()&&alert("找 zhoon 看看 - img no height or ratio")}var C=+new Date;re.inDevelopment()&&console.log("[reader-layout] 处理图片 size 耗费的时间 = ",C-o,"毫秒 ","图片个数 =",r),b()}else b()}function r(){var e=E.$refs.renderTargetContainerSibling,t=E.$refs.preRenderContainer;if(e&&t){var n=e.offsetWidth;ue=n,t.style.width=n+"px"}}E.$nextTick(function(){var e=E.$refs.renderTargetContainerSibling,t=E.$refs.preRenderContainer;e&&t?(r(),E.$nextTick(function(){n()})):(console.error("waitForPreRender-nextTick: dom is not exist: target="+!!e+",prerender="+!!t+",state="+E.chapterContentState),E.$nextTick(function(){r(),E.$nextTick(function(){n()})}))})})},collectPreRenderInfos:function(){var g=this;return new o.default(function(o){for(var e=window.devicePixelRatio,t=g.$refs.preRenderContainer,i=G.default.collect(t,{canvasMaxHeight:4e3/e,canvasMaxCount:2}),n=i.randomHtml.join(""),r=i.decoration.map(function(e){return e.html}).join(""),a="<style>"+i.customStyle.join(" ")+"</style>"+n+r,s="",c=t.offsetWidth,l=i.canvasPositions||[],u=[],d=0,h=l.length;d<h;d++){var f=l[d];if(f){u.push(f);var p=f.bottom-f.top;s+='<canvas style="position:absolute;left:0;top:'+f.top+"px;width:"+c+"px;height:"+p+'px;" width='+c*e+" height="+p*e+"></canvas>"}}g.$store.commit(_.UPDATE_READER_CHAPTER_CANVAS_TARGET_HTML,s),he=i.content||[],de=u,g.renderContentsVersion++,g.$store.commit(_.UPDATE_READER_CHAPTER_CONTENT_TARGET_HTML,a),g.$store.commit(_.UPDATE_READER_CONTENT_STATE,"DONE"),g.$nextTick(function(){var e=i.rootHeight;e<=0&&console.log("render rootHeight error !!!");var t=g.$refs.renderTargetContent;t.style.height=e+"px";var n=t.offsetWidth,r=g.$refs.renderTargetCanvasContainer;r.style.width=n+"px",r.style.height=e+"px",g.drawSomeTexts(),g.bindVideoEvent(),g.bindFooterNoteEvent(),o()})})},clearDrawTexts:function(){var e=this.$refs.renderTargetCanvasContainer;if(e)for(var t=e.getElementsByTagName("canvas"),n=0,r=t.length;n<r;n++){var o=t[n],i=o.ctx;(i=i||o.getContext("2d"))&&i.clearRect(0,0,o.width,o.height)}},drawSomeTexts:function(){var e=+new Date,t=this.$refs.renderTargetCanvasContainer;if(t){for(var n=window.devicePixelRatio,r=de,o=t.getElementsByTagName("canvas"),i=o?o.length:0,a=new Array(i),s=0,c=0;c<i;c++){var l=o[c],u=r[c],d=l.getContext("2d");d&&(d.save(),d.scale(n,n),d.translate(0,-u.top),d.textAlign="left",d.textBaseline="middle"),a[c]=d,s+=Math.max(s,u.bottom)}for(var h=he,f=this.isWhiteTheme,p=null,g=-1,_=0,v=h.length,m=0;_<v;_++){var C=h[_],b=C.rect;if(b.y>s)break;if(1===C.type){b.y>r[m].bottom&&m+1<r.length&&m++;var E=a[m];E?(g===m&&p&&p.font===C.font||(E.font=C.font),g===m&&p&&p.isHighLight()===C.isHighLight()&&p.colors.colorOnWhite===C.colors.colorOnWhite&&p.colors.colorOnBlack===C.colors.colorOnBlack||(E.fillStyle=C.isHighLight()?f?"#1B88EE":"#0097FF":C.colors[f?"colorOnWhite":"colorOnBlack"]),E.fillText(C.text,b.x,b.centerY),p=C,g=m):console.error("Cannot get canvas.context, objIdx="+_+" ,canvasIdx="+m)}}for(var R=0,k=a.length;R<k;R++){var T=a[R];T&&T.restore()}if(re.inDevelopment()){var S=+new Date;console.log("[reader-layout] Reader-drawSomeTexts","时间 =",S-e,"毫秒")}}},resizeToReCollect:function(e){var t=this,n=this;"PRERENDER"!==this.chapterContentState&&(this.clearSelection(),this.clearHighLightDom(),this.$store.commit(_.UPDATE_READER_CONTENT_STATE,"PRERENDER"),this.$nextTick(function(){return ue=e,t.$refs.preRenderContainer.style.width=e+"px",t.waitForPreRender().then(function(){return n.collectPreRenderInfos()})}))},bindVideoEvent:function(){var n=document.querySelectorAll("video");if(0<n.length)for(var e=function(e){var t=n[e];t.addEventListener("click",function(){0<t.currentTime&&!t.paused&&!t.ended&&2<t.readyState?t.pause():(t.parentNode&&t.parentNode.classList.add("wr_video_playing"),t.play())}),t.onended=function(){t.parentNode&&t.parentNode.classList.remove("wr_video_playing")},t.onpause=function(){t.parentNode&&t.parentNode.classList.remove("wr_video_playing")}},t=0;t<n.length;t++)e(t)},bindFooterNoteEvent:function(){var n=this,r=document.querySelectorAll(".js_readerFooterNote");if(0<r.length)for(var e=function(e){var t=r[e];t.addEventListener("click",function(){var e=t.getAttribute("data-wr-footernote");e&&0<e.length&&n.$showFooterNote({text:e,node:t})})},t=0;t<r.length;t++)e(t)},handleClickStartReading:function(){"DONE"===this.chapterContentState&&ae.scrollTo(".readerChapterContent",300,{container:document.body,x:!1,y:!0,offset:-72})},handleClickShelfButtonInBookInfo:function(){return this.reportClientBusiness({itemName:"Web_Reader_FirstPage_AddClk"}),this.handleClickShelfButton()},handleClickRatingButton:function(){this.saveReportInfo("Reader_Click_Rating_Button"),(0,i.default)(this.bookReviewURL(this.bookId))},handleClickShelfButton:function(){if(this.hasLogin){if(!this.isInShelf)return this.$store.dispatch(p.FETCH_READER_ADD_SHELF)}else this.$showLoginDialog({bottomTitle:"扫码登录微信读书",bottomSubTitle:"在书架随时阅读本书"})},handleClickReceiveMemberCardButton:function(){this.isPhone?this.downloadApp():this.receiveMemberCard()},handleClickNextChapter:function(){var e=this.getChapterWithIdxOffset(1);if(e)return this.changeChapter({chapterUid:e.chapterUid})},handleClickPrevChapter:function(){var e=this.getChapterWithIdxOffset(-1);if(e)return this.changeChapter({chapterUid:e.chapterUid})},handleClickFirstChapter:function(){var e=this.chapterInfos;if(e&&0<e.length){var t=e[0];return this.hideCatalog(),this.changeChapter({chapterUid:t.chapterUid})}},handleClickChapter:function(e){if(e)return this.hideCatalog(),this.changeChapter({chapterUid:e})},handleClickNoteItem:function(e){if(e.chapterUid)return this.hideNotePanel(),this.changeChapter({chapterUid:e.chapterUid,scrollTo:{chapterOffset:e.range.start}})},handleClickUnderline:function(e){this.showSelectionToolBar({objs:e.objs,rects:e.rects,clickBookmark:e.bookmark})},changeChapter:function(t){var n=this;if(l.default.isSupportedBookType(this.bookInfo.type)){this.loadTopReviews();var r=+new Date;return this.$store.dispatch(p.CHANGE_READER_CHAPTER,{chapterUid:t.chapterUid}).then(function(){return n.waitForPreRender().then(function(){if(re.inDevelopment()){var e=+new Date;console.log("[reader-layout] 切换章节预加载耗费的时间 = ",e-r,"毫秒")}return n.collectPreRenderInfos()}).then(function(){return{success:!0}})},function(e){if(e&&e.isCustomError)switch(e.reason){case"currentChapter":n.clearSelection(),n.clearHighLightDom(),t.searchItem?n.highLightDomsAndScrollTo(t.searchItem):t.scrollTo&&n.scrollTo(t.scrollTo);break;case"forceReload":window.location.reload();break;case"sessionTimeout":n.handleSessionTimeout()}else console.error("changeChapter-UnexpectedError:",e);return e}).then(function(e){if(e&&e.success)return n.clearSelection(),n.clearHighLightDom(),t.searchItem?n.highLightDomsAndScrollTo(t.searchItem):t.scrollTo&&n.scrollTo(t.scrollTo),n.checkIfShowMemberCardFreeReadingTips(),n.checkIfNeedRequestLoginQRCode(),n.reportReadingProgress()})}},reloadCurrentChapter:function(){var t=this;return this.$store.dispatch(p.RELOAD_READER_CURRENT_CHAPTER).then(function(){return t.waitForPreRender().then(function(){return t.collectPreRenderInfos()}).then(function(){return{success:!0}})},function(e){if(e&&e.isCustomError)switch(e.reason){case"forceReload":window.location.reload();break;case"sessionTimeout":t.handleSessionTimeout()}else console.error("reloadCurrentChapter-UnexpectedError:",e);return e})},onAfterLoginToGetMemberCard:function(){this.saveReportInfo("Login_Has_Login"),A.default.setSessionStorage(w.KEY_READER_LOGIN_PENDING_ACTION,(0,s.default)({toFreeRead:1})),window.location.reload()},showCatalog:function(){this.$refs.readerCatalog.show(),this.isShowAutoSearchHint&&this.$store.commit(_.UPDATE_READER_IS_SHOW_AUTO_SEARCH_HINT,!1)},hideCatalog:function(){this.$refs.readerCatalog.close()},toggleCatalog:function(){this.$refs.readerCatalog.toggle()},handleClickControls:function(e){switch(e){case"catalog":return this.reportClientBusiness({itemName:"Web_Reader_ContentClk"}),this.showCatalog();case"note":return this.reportClientBusiness({itemName:"Web_Reader_NoteClk"}),this.hasLogin?this.toggleNotePanel():this.$showLoginDialog({bottomTitle:"扫码登录微信读书",bottomSubTitle:"查看我的笔记"});case"theme":return this.isWhiteTheme?this.$store.dispatch(p.TOGGLE_THEME,{isWhite:!1}):(this.reportClientBusiness({itemName:"Web_Reader_LightClk"}),this.$store.dispatch(p.TOGGLE_THEME,{isWhite:!0}));case"download":return this.downloadAppToRead()}},showNotePanel:function(){this.$refs.readerNotePanel.show()},hideNotePanel:function(){this.$refs.readerNotePanel.close()},toggleNotePanel:function(){this.$refs.readerNotePanel.isShowing()?this.hideNotePanel():this.showNotePanel()},toggleBottomSettingPanel:function(){this.isShowBottomSettingPanel=!this.isShowBottomSettingPanel},handleClickBottomBarItem:function(e){switch(e){case"shelf":return this.handleClickShelfButton();case"catalog":return this.isShowBottomSettingPanel&&(this.isShowBottomSettingPanel=!1),this.toggleCatalog();case"setting":return this.$refs.readerCatalog&&this.$refs.readerCatalog.isShowing()&&this.hideCatalog(),this.toggleBottomSettingPanel()}},handleClickBottomSettingPanelItem:function(e){switch(e){case"white":return this.reportClientBusiness({itemName:"Web_Reader_LightClk"}),this.$store.dispatch(p.TOGGLE_THEME,{isWhite:!0});case"dark":return this.$store.dispatch(p.TOGGLE_THEME,{isWhite:!1});case"download":(0,F.default)(function(e){e?(0,W.default)({openUrl:(0,j.default)("",{})}):(0,$.default)()})}},doSearch:function(e){return e.isLoadMore||this.reportClientBusiness({itemName:"Web_Reader_Search"}),this.$store.dispatch(p.FETCH_READER_SEARCH,e)},enterSearch:function(){return this.$store.commit(_.UPDATE_READER_IS_IN_SEARCH,!0)},exitSearch:function(){this.$store.commit(_.CLEAR_READER_SEARCH_RESULT),this.$store.commit(_.UPDATE_READER_IS_IN_SEARCH,!1)},handleClickSearchItem:function(e){return this.hideCatalog(),this.reportClientBusiness({itemName:"Web_Reader_Search_ResultClk"}),this.changeChapter({chapterUid:e.chapterUid,searchItem:e})},clearHighLightDom:function(){this.chapterContentHighLightBgHtml="",(0,I.default)(document.querySelectorAll(".wr_highlight_char")).forEach(function(e){e.classList.remove("wr_highlight_char")})},highLightDomsAndScrollTo:function(e){if(e){var t=e.absStart,n=e.absEnd,r=e.keywordStart,o=e.keyword||[];if(e.abstract&&!(n<=t||r<t||n<r)){var i=this.findObjsInOffsetRange(he,t,n),a=i.length,s=[];if(0<a)for(var c=0,l=null,u=0,d=[];c<a;){var h=i[c];if(h.getOffset()<r)c++;else{var f=h.isTextOrCanvasType()&&h.text;if(f&&0!==f.length){if(l)l.indexOf(f)===u?(u+=f.length,d.push(h)):(l=null,u=0,d=[]);else for(var p=0;p<o.length;p++){var g=o[p];if(0===g.indexOf(f)){l=g,u=f.length,d.push(h);break}}l&&0<l.length&&l.length===u&&(s.push.apply(s,(0,S.default)(d)),d=[]),c++}else c++}}var _=this.getRectsByContentObjs(i);if(0<_.length){var v="";_.forEach(function(e){v+='<div class="wr_highlight_bg" style="'+e.toCSSPositionString()+'"></div>'}),this.chapterContentHighLightBgHtml=v}else this.chapterContentHighLightBgHtml="";(0,I.default)(document.querySelectorAll(".wr_highlight_char")).forEach(function(e){e.classList.remove("wr_highlight_char")});for(var m=ge,C=0,b=m.length;C<b;C++)m[C].setHighLight(!1);for(var E=0,R=(ge=s).length;E<R;E++){var k=s[E];if(k.setHighLight(!0),0===k.type){var T=document.querySelector("[data-wr-id="+k.id+"]");T&&T.classList.add("wr_highlight_char")}}this.clearDrawTexts(),this.drawSomeTexts(),this.$nextTick(function(){if(0<_.length){var e=document.querySelector(".wr_highlight_bg");if(e){var t=e.offsetTop+e.offsetParent.offsetTop-20-72;0<t&&window.scrollTo(0,t)}}})}}},scrollTo:function(e){if(e&&0!==he.length){var t=e.chapterOffset;if(!("number"!=typeof t||t<0)){if(!0===e.ignoreWhenScrollToTop){var n=he[0].getOffset();if(0===t||t<=n)return}var r=this.findObjsInOffsetRange(he,t,t+1);r&&0<r.length&&this.scrollToObj(r[0])}}},scrollToObj:function(e){var t=0,n=this.$refs.renderTargetContainer;n&&(t=e.rect.y-20-72+n.offsetTop),0<t&&window.scrollTo(0,t)},findFirstObjIndexContainingText:function(e){for(var t=0;t<e.length;){var n=e[t];if(n.isTextOrCanvasType()&&n.text&&0<n.text.length)return t;t++}return-1},binaryFindObjIndex:function(e,t,n){var r=!(2<arguments.length&&void 0!==n)||n,o=e.length;if(0===o)return-1;if(1===o)return t(e[0])?0:-1;for(var i=0,a=o-1;i<a;){if(i===a-1)return r?t(e[i])?i:t(e[a])?a:-1:t(e[a])?a:t(e[i])?i:-1;var s=Math.floor((i+a)/2),c=t(e[s]);if(r)if(c){if(!(0!==s))return s;if(!t(e[s-1]))return s;a=s}else i=s;else if(c){if(!(s!==o-1))return s;if(!t(e[s+1]))return s;i=s}else a=s}return-1},getContentStringFromObjIdx:function(e,t,n){for(var r="";t<e.length&&r.length<n;){r+=e[t].text||"",t++}return r},findObjsInOffsetRange:function(e,t,n){var r=this.binaryFindObjIndex(e,function(e){return e.getOffset()>=t}),o=this.binaryFindObjIndex(e,function(e){return e.getOffset()<n},!1);return-1<r&&-1<o&&r<=o?e.slice(r,o+1):[]},getRectsByContentObjs:function(e){var r=[],o=void 0;return e.forEach(function(e){var t=e.rect;if(o)if((J.default.isVerticalContain(o,t)||J.default.isVerticalOverLap(o,t))&&o.isLeftOn(t)){var n=J.default.union(o,t);o.set(n)}else o=t.clone(),r.push(o);else o=t.clone(),r.push(o)}),r},reportEnterReading:function(){var t=this;if(this.needReportReadingProgress){var e="",n=0,r=he,o=this.findFirstObjIndexContainingText(r);return-1!==o&&(n=r[o].getOffset(),e=this.getContentStringFromObjIdx(r,o,20)),this.$store.dispatch(p.FETCH_READER_ENTER_BOOK_READ,{firstDomOffset:n,firstDomSummaryText:e}).then(function(e){e&&1===e.sessionTimeout&&t.handleSessionTimeout()})}},reportReadingProgress:function(){var t=this;if(this.needReportReadingProgress)return this.$store.dispatch(p.FETCH_READER_BOOK_READ,{retryCount:1,progressData:this.computeProgressData()}).then(function(e){e&&1===e.sessionTimeout?t.handleSessionTimeout():t.startReportTimer()}).catch(function(e){console.error("[chantlog] Reader.vue-reportReadingProgress","err",e),t.startReportTimer()})},clearReportTimer:function(){pe&&clearTimeout(pe)},startReportTimer:function(){this.clearReportTimer(),pe=setTimeout(this.reportReadingProgress,3e4)},computeProgressData:function(){if(!l.default.isSupportReaderProgress(this.bookInfo))return null;var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;if(void 0===e||e<0)return null;var t=this.$refs.renderTargetContainer;if(!t)return console.log("Reader-computeProgressData","renderTargetContainer is undefined"),null;var n=e+72-t.offsetTop,r=he,o=this.binaryFindObjIndex(r,function(e){return e.rect.y>=n});return-1===o?(console.log("Reader-computeProgressData","obj idx === -1"),null):{offset:r[o].getOffset(),content:this.getContentStringFromObjIdx(r,o,20)}},showConfirmAuthDialog:function(){var e=this;this.$showConfirmAuthDialog({requireVid:this.user.vid},function(){e.isBalanceNeedAuth=!1,e.$store.dispatch(p.FETCH_READER_BALANCE)})},showPayDialog:function(){var n=this;this.hasLogin?(this.$store.dispatch(p.FETCH_READER_BALANCE).then(function(e){var t=(0,K.default)(e);return t&&-12013===t.errCode&&(n.isBalanceNeedAuth=!0,n.showConfirmAuthDialog()),e}),l.default.isBuyUnitWholeBook(this.bookInfo)?(this.isShowPayWholeDialog=!0,this.$nextTick(function(){n.$refs.payWholeBookDialog.showDialog()})):(this.isShowPayChapterDialog=!0,this.$nextTick(function(){n.$refs.payChapterDialog.showDialog(n.currentChapter.chapterUid)}))):this.isPhone&&this.downloadApp()},hidePayDialog:function(){l.default.isBuyUnitWholeBook(this.bookInfo)?this.$refs.payWholeBookDialog.closeDialog():this.$refs.payChapterDialog.closeDialog()},payWholeBook:function(){var n=this;if(l.default.isBuyUnitWholeBook(this.bookInfo)){if(this.isBalanceNeedAuth)return void this.showConfirmAuthDialog();var e=this.balance.iOS>this.balance.Android?"ios":"android",t=oe.get(this.bookInfo,"price",0);if(this.hasMemberCardDiscount)t=t*(100-oe.get(this.bookInfo,"mcardDiscount",0))/100;if(t<=(this.balance.iOS>this.balance.Android?this.balance.iOS:this.balance.Android))return this.$store.dispatch(p.FETCH_READER_BUY_BOOK,{pf:e,price:t,isMCard:this.hasMemberCard}).then(function(e){var t=oe.get(e,"errCode",0);-12013===t?n.showConfirmAuthDialog():-2010===t||-2012===t||-2013===t?n.handleSessionTimeout():-2281===t?(void 0!==oe.get(e,"info.price")&&n.$store.commit(_.UPDATE_READER_BOOK_INFO_PRICE,oe.get(e,"info.price")),void 0!==oe.get(e,"info.payType")&&n.$store.commit(_.UPDATE_READER_BOOK_INFO_PAY_TYPE,oe.get(e,"info.payType")),n.$toast("书籍价格已更新，请重新购买")):1===oe.get(e,"succ",0)?(n.$toast("购买成功"),n.hidePayDialog(),n.$store.dispatch(p.FETCH_READER_ADD_SHELF),n.$store.dispatch(p.FETCH_READER_BOOK_INFO,{envConfig:{},isLogin:!0}),n.$store.dispatch(p.RELOAD_READER_CHAPTER_INFOS,{isLogin:!0}),n.reloadCurrentChapter()):n.$toast("购买失败，请重试")});this.hidePayDialog(),this.downloadAppToAccount()}},payChapter:function(e){var n=this,r=e.chapterIds,t=e.totalPrice,o=e.isAutoPay;if(!l.default.isBuyUnitWholeBook(this.bookInfo)){var i=v.default.formatChapterUids(r);if(0===i.length)return;if(this.isBalanceNeedAuth)return void this.showConfirmAuthDialog();var a=this.balance.iOS>this.balance.Android?"ios":"android";if(t<=(this.balance.iOS>this.balance.Android?this.balance.iOS:this.balance.Android))return this.$store.dispatch(p.FETCH_READER_BUY_CHAPTERS,{pf:a,chapterIds:i,totalPrice:t,isAutoPay:o,isMCard:this.hasMemberCard}).then(function(e){var t=oe.get(e,"errCode",0);-12013===t?n.showConfirmAuthDialog():-2010===t||-2012===t||-2013===t?n.handleSessionTimeout():-2281===t?n.$toast("书籍价格已更新，请刷新后重试"):1===oe.get(e,"succ",0)?(n.$toast("购买成功"),n.hidePayDialog(),n.$store.dispatch(p.FETCH_READER_ADD_SHELF),n.$store.dispatch(p.RELOAD_READER_CHAPTER_INFOS,{isLogin:!0}).then(function(){if(-1!==r.indexOf(oe.get(n.currentChapter,"chapterUid")))return n.reloadCurrentChapter()})):n.$toast("购买失败，请重试")});this.hidePayDialog(),this.downloadAppToAccount()}},showMemberCardTips:function(e){this.$refs.readerMemberCardTips.show(e)},checkIfShowMemberCardFreeReadingTips:function(){if(re.isEnvClient&&(this.hasLogin&&!this.isNeedPay&&this.isNeedPayWithoutMemberCard)){var e=oe.get(this.user,"vid"),t=A.default.getReaderMemberCardTipsBookIdsOperator(e);t.isBookExist(this.bookId)||(this.showMemberCardTips("你正在使用无限卡阅读付费部分"),t.addBook(this.bookId),t.save())}},checkIfSyncReadingProgress:function(){var n=this;return this.$store.dispatch(p.FETCH_READER_PROGRESS,{compareWithLocal:!0}).then(function(e){if(e&&e.book){var t=e.book;return n.$toast("正在跳转到最新进度"),n.changeChapter({chapterUid:t.chapterUid,scrollTo:{chapterOffset:t.chapterOffset}}).then(function(){return!0})}return!1})},checkIfNeedRequestLoginQRCode:function(){this.isNeedShowLoginGuide&&(this.loginGuideQRCodeImg&&!this.isLoginGetInfoError&&!this.isLoginGetUidError||this.requestLoginUid())},requestLoginUid:function(){var t=this;this.isLoginQRCodeLoading=!0,(0,q.default)("/web/login/getuid",{},function(e){e&&e.data&&e.data.uid?(t.isLoginQRCodeLoading=!1,t.isLoginGetUidError=!1,t.isLoginGetInfoError=!1,t.generateLoginGuideQRCode(e.data.uid),t.requestLoginInfo(e.data.uid)):(t.isLoginQRCodeLoading=!1,t.isLoginGetUidError=!0,t.isLoginGetInfoError=!1)})},generateLoginGuideQRCode:function(e){this.loginGuideQRCodeImg=n(66).getQrBase64("https://weread.qq.com/web/confirm?uid="+e,{padding:6,width:144,height:144,correctLevel:QRErrorCorrectLevel.H,background:"#FFF",foreground:"#000"})},requestLoginInfo:function(e){var t=this;(0,q.default)("/web/login/getinfo",{uid:e},function(e){e&&e.data&&e.data.vid&&e.data.skey&&e.data.code?t.requestLogin(e.data):(t.isLoginGetInfoError=!0,0<t.autoLoadLoginQRCodeCount&&(t.autoLoadLoginQRCodeCount--,t.checkIfNeedRequestLoginQRCode()))})},requestLogin:function(e){var t=this,n=e.pf;(0,q.default)("/web/login/weblogin",{vid:e.vid,skey:e.skey,code:e.code},function(e){e&&e.data&&e.data.vid&&e.data.accessToken&&e.data.refreshToken&&(e.data.pf=n,t.handleLoginResult(e.data))})},handleLoginResult:function(e){var t=this;(0,q.default)("/web/login/session/init",{vid:e.vid,skey:e.accessToken,rt:e.refreshToken,pf:e.pf},function(e){e&&e.data&&e.data.success,t.onAfterLoginToGetMemberCard()})},receiveMemberCard:function(){},downloadApp:function(){this.isPhone&&this.reportClientBusiness({itemName:"Web_Phone_Reader_DownloadClk"}),this.$showDownloadAppDialog(),this.$downloadAppComponent.beginToLoadQrCode({subTitle:"全场书籍免费读"})},downloadAppToRead:function(){this.reportClientBusiness({itemName:"Web_Download_ReaderToolExp"}),this.$showDownloadAppDialog();var e=void 0;e=l.default.isMPBookType(this.bookInfo.type)?{schemeName:"book",bId:this.bookId,type:this.bookInfo.type}:l.default.isComicType(this.bookInfo.type)?{schemeName:"comicReader",bId:this.bookId}:{schemeName:"reading",bId:this.bookId,type:this.bookInfo.type,chapterUid:oe.get(this.currentChapter,"chapterUid",0)},e=oe.merge(e,{subTitle:"在手机上继续阅读本书",from:"ReaderControl"}),this.$downloadAppComponent.beginToLoadQrCode(e)},downloadAppToMemberCard:function(){this.$showDownloadAppDialog(),this.$downloadAppComponent.beginToLoadQrCode({schemeName:"memCard",from:"ReaderMemberCard",memCardExpand:1,title:"扫码去微信读书 App 续期无限卡",subTitle:"全场书籍免费读"}),this.reportClientBusiness({itemName:"Web_Download_ReaderCardExp"})},downloadAppToAccount:function(){this.$showDownloadAppDialog(),this.$downloadAppComponent.beginToLoadQrCode({schemeName:"account",from:"ReaderRecharge",title:"扫码去微信读书 App 充值",subTitle:""}),this.reportClientBusiness({itemName:"Web_Download_ReaderRechargeExp"})},logOnClientMounted:function(){if(re.isEnvClient){this.haveReportInfo("Index_Recommend")&&this.reportClientBusiness({itemName:"Web_Home_GuessClk"},"Index_Recommend"),this.haveReportInfo("Index_Shelf_Book")&&this.reportClientBusiness({itemName:"Web_Home_ShelfBookClk"},"Index_Shelf_Book"),this.haveReportInfo("Shelf_Enter_Reader")&&this.reportClientBusiness({itemName:"Web_Shelf_BookClk"},"Shelf_Enter_Reader"),this.haveReportInfo("Search_HotBook_Reader")&&this.reportClientBusiness({itemName:"Web_Search_HotClk"},"Search_HotBook_Reader"),this.haveReportInfo("SearchResult_Click_BookId")&&this.reportClientBusiness({itemName:"Web_Search_BookId_Clk",value:this.bookId},"SearchResult_Click_BookId"),this.haveReportInfo("SearchResult_Click_BookName")&&(this.reportClientBusiness({itemName:"Web_Search_ResultClk"},"SearchResult_Click_BookName"),this.reportClientBusiness({itemName:"Web_Search_ResultClk_Name"})),this.haveReportInfo("SearchResult_Click_Content")&&(this.reportClientBusiness({itemName:"Web_Search_ResultClk"},"SearchResult_Click_Content"),this.reportClientBusiness({itemName:"Web_Search_ResultClk_Content"}));var e=this.haveReportInfo("CategoryBook_Enter_Reader");if((e||e&&e.categoryId)&&(this.reportClientBusiness({itemName:"Web_Ranking_All_BookClk"},"CategoryBook_Enter_Reader"),e.categoryId&&this.reportClientBusiness({itemName:"Web_Ranking_Type_BookClk",value:(0,s.default)({type:e.categoryId})})),this.haveReportInfo("Index_Book_All")?this.reportClientBusiness({itemName:"Web_Home_Top200_Clk"},"Index_Book_All"):this.haveReportInfo("Index_Book_Novel")?this.reportClientBusiness({itemName:"Web_Home_TopFic_Clk"},"Index_Book_Novel"):this.haveReportInfo("Index_Book_New")?this.reportClientBusiness({itemName:"Web_Home_TopNew_Clk"},"Index_Book_New"):this.haveReportInfo("Index_Book_Rise")&&this.reportClientBusiness({itemName:"Web_Home_TopRise_Clk"},"Index_Book_Rise"),this.isShowTopBarAddShelfButton&&this.reportClientBusiness({itemName:"Web_Reader_TopAddExp"}),this.isCurrentChapterTheFirst&&(this.reportClientBusiness({itemName:"Web_Reader_FirstPage"}),this.showFirstPageAddShelfButton&&this.reportClientBusiness({itemName:"Web_Reader_FirstPage_AddExp"})),this.isPhone&&this.reportClientBusiness({itemName:"Web_Phone_Reader_DownloadExp"}),this.isWeiXin&&this.hasLogin){var t=this.$router.currentRoute.query,n=t.wtype&&"shareOneGetOne"===t.wtype,r=t.wvid&&"app"===t.wfrom;if((n||r)&&this.reportClientGlobal({itemName:"Web_Enter_Activity"}),n){this.reportClientBusiness({itemName:"Web_ShareOneGetOne_Enter_Reader"}),this.reportClientAppSharePage({itemName:"page|Web_ShareOneGetOne_Enter_Reader"}),this.reportClientAppSharePage({itemName:"page|Web_ShareOneGetOne_Enter_Reader|h5"});var o=t.senderVid,i=t.campaignId;if(!o||!i)return;var a=i.split("_")[0];a&&(this.reportClientAppSharePage({itemName:"page|Web_ShareOneGetOne_Enter_Reader_"+a}),this.reportClientAppSharePage({itemName:"page|Web_ShareOneGetOne_Enter_Reader_"+a+"|h5"})),ee.default.post("https://weread.qq.com/i/share-one-get-one/redeem",{bookId:this.bookId,campaignId:i,senderVid:o}).then(function(e){1===oe.get(e,"data.succ",0)?console.log("[zhoonlog] succ = 1"):console.log("[zhoonlog] succ != 1")}).catch(function(e){console.log("[zhoonlog] err = "+e)})}else r&&(this.reportClientAppSharePage({itemName:"page|Web_AppShare_Enter_Reader"}),this.reportClientAppSharePage({itemName:"page|Web_AppShare_Enter_Reader|h5"}),this.reportClientBusiness({itemName:"Web_AppShare_Enter_Reader"}),this.reportClientBusiness({itemName:"Web_AppShare_Enter_ReaderSelf",vid:t.wvid}))}}},autoSearchOnClientMounted:function(){var e=A.default.getSessionStorage(w.KEY_READER_AUTO_SEARCH);if(e){var t=JSON.parse(e);t.keyword&&(this.$store.dispatch(p.FETCH_READER_SEARCH_AUTO,{keyword:t.keyword}),this.$refs.readerCatalog.setSearchKeyword(t.keyword)),A.default.setSessionStorage(w.KEY_READER_AUTO_SEARCH)}},setupProgressReportOnDomReady:function(){if(this.needReportReadingProgress&&!fe){fe=!0;var r=this;this.reportEnterReading(),this.$store.commit(_.UPDATE_READER_START_READING_TIME),this.startReportTimer();var e=n(759).ifvisible;e.setIdleDuration(120),e.on("statusChanged",function(e){switch(e.status){case"hidden":case"idle":r.$store.dispatch(p.READER_MARK_PAUSE),r.clearReportTimer();break;case"active":o.default.all([r.$store.dispatch(p.READER_MARK_ACTIVE),r.checkIfSyncReadingProgress()]).then(function(e){var t=e[0],n=e[1];if(t&&!n)return r.$store.dispatch(p.FETCH_READER_BOOK_READ,{retryCount:1,progressData:r.computeProgressData()})}),r.startReportTimer()}})}},handleLoginPendingActions:function(){if(re.isEnvClient){var e=A.default.getSessionStorage(w.KEY_READER_LOGIN_PENDING_ACTION);if(e)if(A.default.setSessionStorage(w.KEY_READER_LOGIN_PENDING_ACTION),this.hasLogin)if(1===oe.get(JSON.parse(e),"toFreeRead",0))if(this.isNeedPayWithoutMemberCard)if(!this.isNeedPay&&this.isNeedPayWithoutMemberCard);else if(this.hasMemberCard);else{if(this.isBlackUser&&2===oe.get(this.bookInfo,"ispub"));else{if(this.canReceiveMemberCard)return this.receiveMemberCard();this.$toast("你已领取过该福利")}}else;}},requestMemberCardPriceIfNeeded:function(){var i=this;this.isShowBuyMemberCardButton&&!this.hasFetchMemberCardPrice&&(0,z.default)("/web/pay/memberprice",{vid:oe.get(this.user,"vid"),pf:oe.get(this.user,"pf",0)},function(e){i.hasFetchMemberCardPrice=!0;var t=e.data,n=oe.get(t,"promoPrice",0),r=oe.get(t,"promoLabel","");if(0<n&&0<r.length)i.buyMemberCardButtonLine1="无限卡 "+r+Math.round(n)/100+"元 · 全场书籍免费读";else if(0<oe.get(t,"price",0)){var o=oe.get(t,"price",0);i.buyMemberCardButtonLine1="无限卡 "+Math.round(o)/100+"元/月 · 全场书籍免费读"}else i.buyMemberCardButtonLine1="无限卡 19元/月 · 全场书籍免费读"},function(){})},handleSessionTimeout:function(){this.isWeiXin||this.$toast("登录过期，请重新登录"),setTimeout(function(){window.location.reload()},3e3)},clientXY2RenderAreaXY:function(e){var t=this.$refs.renderTargetContainer;if(t){var n=t.offsetLeft,r=t.offsetTop,o=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;return e.x=e.x-n+o,e.y=e.y-r+i,e}return e},findObjsWithPoints:function(e,t){var n,r,o=he,i=o.length,a=[e,t].sort(function(e,t){return e.y!==t.y?e.y-t.y:e.x-t.x}),s=this.binaryFindObjIndex(o,function(e){return e.rect.bottom>=a[0].y});if(-1!==s){for(;s<i&&(n=o[s],void 0,!((r=n.rect).centerX>=a[0].x||r.y>=a[0].y));)s++;s===i&&(s=-1)}var c,l,u=this.binaryFindObjIndex(o,function(e){return e.rect.y<a[1].y},!1);if(-1!==u)for(;0<=u&&(c=o[u],void 0,!((l=c.rect).centerX<=a[1].x||l.bottom<=a[1].y));)u--;var d=[],h=[];return-1!==s&&-1!==u&&(h=s<=u?[s,u+1]:[u+=1,(s-=1)+1],d=o.slice(h[0],h[1])),d},getRangeFromObjs:function(e){for(var t=new X.default(e[0].getOffset(),e[0].getOffset()),n=1,r=e.length;n<r;n++){var o=e[n].getOffset();t.start>o&&(t.start=o),t.end<o&&(t.end=o)}return t.end++,t},hasSelection:function(){return 0<Ce.length},clearSelection:function(){this.chapterContentSelectionHtml="",be=[],Ce=[],this.$hideSelectionToolBar()},onContentMouseDown:function(e){"DONE"===this.chapterContentState&&(e=e||window.event,me=!0,ve=this.clientXY2RenderAreaXY({x:e.clientX,y:e.clientY}),_e=(new Date).getTime())},onContentMouseMove:function(e){if("DONE"===this.chapterContentState&&me&&null!==ve){e=e||window.event;var t=this.clientXY2RenderAreaXY({x:e.clientX,y:e.clientY}),n=this.findObjsWithPoints(ve,t);if(500<n.length){var r=!1;if(0<Ce.length?n[0]===Ce[0]?(n=n.slice(0,500),r=!0):n[n.length-1]===Ce[Ce.length-1]&&(n=n.slice(n.length-500),r=!0):(n=n.slice(0,500),r=!0),!r)return}var o=this.getRectsByContentObjs(n);if(0<o.length){var i="";o.forEach(function(e){i+='<div class="wr_selection" style="'+e.toCSSPositionString()+'"></div>'}),this.chapterContentSelectionHtml=i}else this.chapterContentSelectionHtml="";Ce=n,be=o}},onContentMouseUp:function(){if("DONE"===this.chapterContentState&&(me=!1,0<be.length)){for(var e=this.getRangeFromObjs(Ce),t=null,n=this.bookmarkListInCurrentChapter,r=0,o=n.length;r<o;r++){var i=n[r];if(X.default.isContain(i.range,e)){t=i;break}}this.showSelectionToolBar({objs:Ce,rects:be,clickBookmark:t})}},showSelectionToolBar:function(e){var t=this,n=e.objs,r=e.rects,o=e.clickBookmark,i=this.$refs.renderTargetContainer,a=this.$refs.appContent,s=window.innerHeight||Math.min(document.documentElement.clientHeight,document.body.clientHeight),c=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,l=i.offsetTop,u=g.default.getDomsRelativeOffset(i,a);this.$showSelectionToolBar({parentNode:i,toolbarBoundsLimit:{left:-u.left,right:a.offsetWidth-u.left,top:c-l+72,bottom:c-l+s},canCopy:this.canCopy(n),rects:r,bookmark:o,onClickToolBarItem:function(e){if(!t.hasLogin&&-1!==["underline","removeUnderline"].indexOf(e.type))return t.$showLoginDialog({bottomTitle:"扫码登录微信读书",bottomSubTitle:"多设备同步划线"});switch(e.type){case"copy":t.copyObjsText(n);break;case"underline":o?t.updateBookmark(o,e.styleId):t.underlineObjs(n,e.styleId);break;case"removeUnderline":t.removeBookmark([o.bookmarkId]);break;default:t.$toast("功能开发中",1500)}t.clearSelection()}})},underlineObjs:function(e,t){for(var n=this.getRangeFromObjs(e),r=this.bookmarkListInCurrentChapter,o=[],i=0,a=r.length;i<a;i++){var s=r[i];X.default.isIntersection(n,s.range)&&(o.push(s.bookmarkId),n=X.default.union(n,s.range))}this.removeBookmark(o),void 0===t&&(t=A.default.getLocalSettingOperator().getValueWithType(w.LOCAL_SETTING_OBJ_KEYS.UNDERLINE_STYLE,"number")||1);this.addBookmark(n,t)},removeBookmark:function(e){var t=this;e.forEach(function(e){t.$store.dispatch(p.REMOVE_BOOKMARK,{bookmarkId:e})})},updateBookmark:function(e,t){var n=this;return this.$store.dispatch(p.UPDATE_BOOKMARK,{bookmarkId:e.bookmarkId,style:t}).then(function(e){1===e.succ&&n.saveLastBookmarkStyle(t)})},addBookmark:function(e,t){var n=this,r=this.findObjsInOffsetRange(he,e.start,e.end);return this.$store.dispatch(p.ADD_BOOKMARK,{bookId:this.bookId,chapterUid:this.currentChapter.chapterUid,bookVersion:this.bookInfo.version,type:1,style:t,range:e.start+"-"+e.end,markText:r.map(function(e){return e.text}).join("")}).then(function(e){1===e.succ?n.saveLastBookmarkStyle(t):n.$toast("划线失败，请重试")})},saveLastBookmarkStyle:function(e){var t=A.default.getLocalSettingOperator();t.value[w.LOCAL_SETTING_OBJ_KEYS.UNDERLINE_STYLE]=e,t.save()},canCopy:function(e){for(var t=0,n=e.length;t<n;t++){if(e[t].isTextOrCanvasType())return!0}return!1},copyObjsText:function(e){if(this.canCopy(e)){for(var t="",n=0,r=e.length;n<r&&!(500<=n);n++)t+=e[n].text;0!==t.length&&this.copyText(t)&&this.$toast("已复制到剪贴板")}},copyText:function(e){Ee=!0;var t=document.createElement("input");t.setAttribute("type","text"),t.setAttribute("readonly","readonly"),t.setAttribute("value",e),document.body.appendChild(t),t.select();var n=document.execCommand("copy");return document.body.removeChild(t),Ee=!1,n},loadTopReviews:function(){this.topReviewList&&0<this.topReviewList.length||(this.$store.dispatch(p.FETCH_BOOK_REVIEW_LIST,{bookId:this.bookId,count:3,listType:Z.ReviewListTypeBookTop}),this.$store.dispatch(p.FETCH_BOOK_REVIEW_LIST,{bookId:this.bookId,count:3,listType:Z.ReviewListTypeBookFriendTop}))},changeFontSize:function(e){var t=this;if(!(e<1||5<e)){var n=this.computeProgressData();return this.$store.commit(_.UPDATE_READER_CONTENT_STATE,"PRERENDER"),this.fontSizeLevel=e,new o.default(function(e){setTimeout(e,0)}).then(this.waitForPreRender).then(this.collectPreRenderInfos).then(function(){t.clearSelection(),t.clearHighLightDom(),n&&t.scrollTo({chapterOffset:n.offset,ignoreWhenScrollToTop:!0})}).then(function(){t.saveLocalFontSizeLevel(e),t.reportClientBusiness({itemName:"Web_Reader_FontChange"})})}},saveLocalFontSizeLevel:function(e){var t=A.default.getLocalSettingOperator();t.value[w.LOCAL_SETTING_OBJ_KEYS.FONT_SIZE_LEVEL]=e,t.save()},restoreFontSizeLevel:function(){var e=A.default.getLocalSettingOperator().getValueWithType(w.LOCAL_SETTING_OBJ_KEYS.FONT_SIZE_LEVEL,"number");null!=e&&1<=e&&e<=5&&(this.fontSizeLevel=e)}},watch:{isInShelf:function(e){this.hasLogin&&e&&this.$store.dispatch(p.UPDATE_READER_LOCAL_LAST_CHAPTER)},currentChapter:function(){re.isEnvClient&&(this.requestMemberCardPriceIfNeeded(),this.isCurrentChapterTheFirst&&(this.reportClientBusiness({itemName:"Web_Reader_FirstPage"}),this.showFirstPageAddShelfButton&&this.reportClientBusiness({itemName:"Web_Reader_FirstPage_AddExp"})))},isShowAutoSearchHint:function(e){re.isEnvClient&&(e?this.reportClientBusiness({itemName:"Web_Search_ReaderContentExp"}):this.reportClientBusiness({itemName:"Web_Search_ReaderContentClk"}))},memberCardSummary:function(){re.isEnvClient&&this.checkIfShowMemberCardFreeReadingTips()},isWhiteTheme:function(){this.clearDrawTexts(),this.drawSomeTexts()}},computed:(0,r.default)({displayTopTotalReviewList:function(){var e=this.topFriendReviewList.concat(this.topReviewList);return e&&3<e.length?e.slice(0,3):e}},(0,a.mapState)({bookId:function(e){return e[se].bookId},isBookInfoError:function(e){return e[se].isBookInfoError},bookInfo:function(e){return e[se].bookInfo},isInShelf:function(e){return e[se].isInShelf},memberCardSummary:function(e){return e[se].memberCardSummary},infiniteInfo:function(e){return e[se].infiniteInfo},readingStat:function(e){return e[se].readingStat},chapterInfos:function(e){return e[se].chapterInfos},progress:function(e){return e[se].progress},currentChapter:function(e){return e[se].currentChapter},chapterContentHtml:function(e){return e[se].chapterContentHtml},chapterContentStyles:function(e){return e[se].chapterContentStyles},chapterContentTargetHtml:function(e){return e[se].chapterContentTargetHtml},chapterContentTargetCanvasHtml:function(e){return e[se].chapterContentTargetCanvasHtml},chapterContentState:function(e){return e[se].chapterContentState},isChapterContentDirty:function(e){return e[se].isChapterContentDirty},isInSearchMode:function(e){return e[se].isInSearchMode},isShowAutoSearchHint:function(e){return e[se].isShowAutoSearchHint},isSearchLoading:function(e){return e[se].isSearchLoading},searchResult:function(e){return e[se].searchResult},balance:function(e){return e[se].balance},topReviewList:function(e){return e[le].topReviews.reviewList},topFriendReviewList:function(e){return e[le].topFriendReviews.reviewList},bookmarks:function(e){return e[le].bookmarks}}),(0,a.mapGetters)(["getChapterWithIdxOffset","hasPrevChapter","hasNextChapter","isCurrentChapterTheFirst","chapterTitleText","isBlackUser","isNeedPay","isNeedPayWithoutMemberCard"]),{isShowBuyMemberCardButton:function(){return this.hasLogin&&this.isNeedPay&&!this.isPhone&&!this.canReceiveMemberCard&&!this.isBlackUser&&!this.hasMemberCard&&!this.isSoldOut},isShowLoading:function(){var e=this.chapterContentState;return"LOADING"===e||"PRERENDER"===e},isShowPreRender:function(){return"PRERENDER"===this.chapterContentState||re.inDevelopment()},chapterContentForEPub:function(){return this.chapterContentHtml},isShowReaderTopBar:function(){return!this.isCurrentChapterTheFirst},isEpub:function(){return l.default.isEPub(this.bookInfo)},isSoldOut:function(){return l.default.isSoldOut(this.bookInfo)},isShowTopBarAddShelfButton:function(){return!this.hasLogin||!this.isInShelf},showFirstPageAddShelfButton:function(){return!this.hasLogin||!this.isInShelf},showBottomBarAddShelfButton:function(){return!this.hasLogin||!this.isInShelf},hasCurrentChapter:function(){return this.currentChapter&&0<(0,u.default)(this.currentChapter).length},needReportReadingProgress:function(){return re.isEnvClient&&this.hasLogin},hasMemberCard:function(){return c.default.isMemberShipValid(this.memberCardSummary)},hasMemberCardDiscount:function(){return this.hasMemberCard&&0<oe.get(this.bookInfo,"mcardDiscount",0)},canReceiveMemberCard:function(){return c.default.canReceiveMemberCard(this.infiniteInfo)},payButtonDisplayInfos:function(){var e=!1,t=[];if(l.default.isBuyUnitWholeBook(this.bookInfo))if(l.default.isLimitFree(this.bookInfo)){var n=oe.get(this.bookInfo,"price",0);t.push('限时免费 <span class="lineThrough">'+n.toFixed(2)+"</span>")}else if(l.default.isFree(this.bookInfo))t.push("免费获取");else if(this.hasMemberCardDiscount){var r=oe.get(this.bookInfo,"price",0),o=r*(100-oe.get(this.bookInfo,"mcardDiscount",0))/100;t.push("无限卡 · 购买本书 "+o.toFixed(2)),t.push(' 原价 <span class="lineThrough">'+r.toFixed(2)+"</span>"),e=!0}else{var i=oe.get(this.bookInfo,"price",0);t.push("购买本书 "+i.toFixed(2))}else if(this.hasMemberCardDiscount){var a=oe.get(this.currentChapter,"price",0),s=a*(100-oe.get(this.bookInfo,"mcardDiscount",0))/100;t.push("无限卡 · 购买本章 "+s.toFixed(2)),t.push(' 原价 <span class="lineThrough">'+a.toFixed(2)+"</span>"),e=!0}else{var c=oe.get(this.currentChapter,"price",0);t.push("购买本章 "+c.toFixed(2))}return{isMCard:e,lines:t}},endingTexts:function(){var e=this.bookInfo;if(1===e.finished)return["全书完"];var t=["未完待续"];if(l.default.isBuyUnitChapter(e)){var n=e.updateTime;if(n){var r=new Date(1e3*n),o=g.default.formatTime(r);t.push("已阅读至最新章节 · 最近更新于 "+o)}}return t},isNeedShowLoginGuide:function(){return this.isNeedPay&&!this.hasLogin&&!this.isPhone},isNeedShowPhoneDownloadGuide:function(){return this.isPhone},isNeedShowNyNote:function(){return this.hasLogin},bookmarkListInCurrentChapter:function(){var e=this.currentChapter;if(!e)return[];var t=this.bookmarks;if(t.isFetching||0===t.bookmarkList.length)return[];var n=e.chapterUid,r=t.bookmarkList,o=[];return r.forEach(function(e){e.chapterUid===n&&o.push(e)}),o},underlineRenderDatas:function(){var l=this;if(-1===this.renderContentsVersion)return[];if(!this.isNeedShowNyNote||0===he.length)return[];var e=this.bookmarks;if(e.isFetching||0===e.bookmarkList.length)return[];var u=[];return this.bookmarkListInCurrentChapter.forEach(function(e){if(e.type===V.BookMarkTypeUnderline){var t=e.range;if(!(isNaN(t.end)||t.start>=t.end)){var n=l.findObjsInOffsetRange(he,t.start,t.end),r=l.getRectsByContentObjs(n);if(0<r.length)for(var o=0,i=r.length;o<i;o++){var a=r[o],s={id:e.bookmarkId+"_"+o,bookmark:e,objs:n,rects:r,rect:a,classNames:["wr_underline","s"+e.style]};if(1===e.style){var c=parseInt(a.y)%3;s.classNames.push("bg"+c)}u.push(s)}}}}),u}})}},574:function(e,t,n){"use strict";n.r(t);var r=n(575),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"CustomStyle.vue"}},576:function(e,t,n){"use strict";n.r(t);var r=n(577),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(713),i=(r=o)&&r.__esModule?r:{default:r};t.default={name:"ReaderControls",components:{VueSlider:i.default},props:{disableChapterLink:{type:Boolean,required:!1,default:!1},isShowSearchHint:{type:Boolean,required:!1,default:!1},searchHintTotalCount:{type:Number,required:!1,default:0},disableFontSizeSlider:{type:Boolean,required:!1,default:!1},fontSizeLevelCount:{type:Number,required:!0},initFontSizeLevel:{type:Number,required:!0}},data:function(){return{isFontSizeExpand:!1,fontSizeLevels:function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=n+1;return t}(this.fontSizeLevelCount),fontSizeLevel:this.initFontSizeLevel}},computed:{searchHint:function(){return this.isShowSearchHint?["搜索结果",this.searchHintTotalCount?"共"+this.searchHintTotalCount+"条":""].filter(function(e){return e}).join(" · "):""}},methods:{emitClick:function(e){if("catalog"===e&&this.disableChapterLink)return!1;this.$emit("onClickItem",e)},emitFontSizeLevelChange:function(){var e=this,t=this.$refs.fontSizeSlider.getValue();setTimeout(function(){e.$emit("fontSizeLevelChange",t)},0)},toggleFontSizeExpand:function(){this.isFontSizeExpand=!this.isFontSizeExpand},hideFontSizePanel:function(){this.isFontSizeExpand&&(this.isFontSizeExpand=!1)},isFontSizePanelShowing:function(){return this.isFontSizeExpand}}}},578:function(e,t,n){},579:function(e,t,n){"use strict";n.r(t);var r=n(580),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s(n(517)),r=s(n(61)),o=s(n(276)),i=s(n(528)),u=s(n(42)),a=s(n(43)),d=s(n(191));function s(e){return e&&e.__esModule?e:{default:e}}var h=n(22);t.default={name:"ReaderBookInfo",components:{Dialog:a.default,BookCover:o.default,RankBar:i.default},props:{bookInfo:{type:Object,required:!0},chapterInfos:{type:Array,required:!0},readingStat:{type:Object,required:!0},showAddShelfButton:{type:Boolean,required:!1,default:!1}},computed:{isEmptyBookInfo:function(){return!this.bookInfo||0===(0,r.default)(this.bookInfo).length},isSupportBook:function(){return d.default.isSupportedBookType(this.bookInfo.type)},canShowDownloadButton:function(){return!d.default.isSupportedBookType(this.bookInfo.type)||this.isPhone&&this.isFromWeReadApp},needShowRankListImg:function(){return 0<this.rankListCategoryId.length&&0<this.rankListCategoryClassName.length},rankListCategoryId:function(){return h.get(this.bookInfo,"ranklist.categoryId","")},rankListCategoryClassName:function(){var e=this.rankListCategoryId;return-1!==["all","rising","newbook","novel","novel_male","novel_female"].indexOf(e)?"rankList_"+(h.startsWith(e,"novel")?"novel":e):""},introParaArray:function(){var e=this.bookInfo.lPushName||"",t=this.bookInfo.intro||"";return[e.trim(),t.trim()].filter(function(e){return 0<e.length})},moreChildCount:function(){var e=0;return this.showRating&&e++,this.readingCount&&e++,++e},showRating:function(){return 0<this.bookInfo.ratingCount&&0<this.starScore},ratingCountString:function(){var e=this.bookInfo.ratingCount||0,t=u.default.formatNumber(e);return t.number+t.unit},starScore:function(){return this.bookInfo.star||0},starString:function(){return(this.starScore/10).toFixed(1)},readingCount:function(){return this.readingStat.readingCount||0},readingCountStrings:function(){if(0<this.readingCount){var e=this.readingStat.readingUsers||[],t=u.default.formatNumber(this.readingCount),n='<span class="bookInfo_more_line1_number">'+t.number+"</span>"+t.unit+(0<e.length?"人阅读":"人"),r=null;if(0<e.length){for(var o=0;o<e.length;o++){var i=e[o].name||"";if(9<(r=null===r?i:r+"、"+i).length){r=r.slice(0,10);break}}0<r.length&&(r+="等好友在读")}else r="阅读此书";return[n,r]}return["",""]},chaptersToPreview:function(){var i=this,e=this.chapterInfos;if(!e||0===e.length)return[];var t=d.default.isBuyUnitChapter(this.bookInfo)&&2===h.get(this.bookInfo,"ispub");if(!t)return[];function a(e){return"第"+e.chapterIdx+"章"}function s(e){return(e.title||"").substr(0,10)}if(t){var n=Math.max(0,e.length-3),r=n+3,o=e.slice(n,r).reverse(),c=!0;return o.map(function(e){var t=1e3*h.get(e,"updateTime",0),n=(new Date).getTime()-2592e6<t,r={line1:"",line2:"",isLine2Blue:!1,isLine2Title:!1,link:i.readerURL(i.bookInfo.bookId,{chapterUid:e.chapterUid})};if(n){if(r.line1=a(e)+" "+s(e),r.line2=u.default.formatTime(new Date(t),{useYearMonthDateChar:!0,showTimeWhenShowDate:!1})+" · 已更新",c){var o=new Date;o.setHours(0,0,0,0),r.isLine2Blue=t>=o.getTime()}r.isLine2Blue||(c=!1)}else r.line1=a(e),r.line2=s(e),r.isLine2Title=!0;return r})}},publishInfos:function(){var e=[];if(this.bookInfo.publisher&&e.push({title:"出版社",content:this.bookInfo.publisher,needConsiderLong:!0}),this.bookInfo.publishTime)try{var t=this.bookInfo.publishTime.split(" "),n=new Date(t[0]);e.push({title:"出版时间",content:n.getFullYear()+"年"+(n.getMonth()+1)+"月",needConsiderLong:!1})}catch(e){}return this.bookInfo.ISBN&&e.push({title:"ISBN",content:this.bookInfo.ISBN,needConsiderLong:!1}),this.bookInfo.totalWords&&e.push({title:"字数",content:this.bookInfo.totalWords.toLocaleString("en-US"),needConsiderLong:!1}),this.bookInfo.category&&e.push({title:"分类",content:this.bookInfo.category,needConsiderLong:!0}),e},isPublishInfoLong:function(){var e=this.publishInfos,t=!0,n=!1,r=void 0;try{for(var o,i=(0,l.default)(e);!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.needConsiderLong,c=a.content;if(s&&11<c.length)return!0}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!1}},mounted:function(){var e=this.$refs.introDom;e&&(e.scrollHeight>e.offsetHeight?e.classList.add("hasMore"):e.classList.remove("hasMore"))},methods:{emitClickAddShelf:function(){this.$emit("clickAddShelf")},showIntroDialog:function(){this.$refs.introDialog.showDialog()},emitClickShowCatalog:function(){this.$emit("clickShowCatalog")},emitDownloadApp:function(){this.$emit("clickDownloadApp")},emitClickRatingButton:function(){this.$emit("clickRatingButton")},emitClickStartReading:function(){this.$emit("clickStartReading")}}}},581:function(e,t,n){},582:function(e,t,n){"use strict";n.r(t);var r=n(583),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},583:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(65)),o=p(n(191)),i=p(n(529)),a=p(n(276)),s=p(n(671)),c=p(n(281)),l=p(n(672)),u=p(n(7)),d=p(n(42)),h=p(n(673)),f=p(n(674));function p(e){return e&&e.__esModule?e:{default:e}}var g=n(282),_=n(675),v=n(22);t.default={name:"ReaderCatalog",components:{ReaderPanelListLoadingView:f.default,ReaderPanelListEmptyView:h.default,ReaderPanelSectionListItem:l.default,BackgroundMask:c.default,ReaderCatalogBookInfo:s.default,BookCover:a.default},props:{bookInfo:{type:Object,required:!0},memberCardSummary:{type:Object,required:!1},chapterInfos:{type:Array,required:!0},currentChapter:{type:Object,required:!0},isSearchLoading:{type:Boolean,required:!1,default:!1},isInSearchMode:{type:Boolean,required:!1,default:!1},searchResult:{type:Object,required:!1}},data:function(){return{isShow:!1,isScrollToBottom:!0,searchKeyword:"",searchXSS:void 0}},watch:{isInSearchMode:function(e){var t=this;if(e&&u.default.isEnvClient){var n=this;this.$nextTick(function(){var e=t.$refs.searchResultDom;e&&!e.addedScrollEvent&&(e.addedScrollEvent=1,d.default.handleElementScrollEvent(e,function(){n.emitSearchLoadMore()}))})}}},computed:{isEpub:function(){return o.default.isEPub(this.bookInfo)},needShowScroller:function(){return this.chapterInfos&&50<this.chapterInfos.length},isSearchResultHasMore:function(){return v.get(this.searchResult,"hasMore",!1)}},created:function(){this.debouncedDoSearch=v.debounce(this.emitSearch,500)},methods:{setSearchKeyword:function(e){this.searchKeyword=e},show:function(){this.$refs.mask.showMask(),this.isShow=!0},close:function(){this.$refs.mask.closeMask(),this.isShow=!1},isShowing:function(){return this.isShow},toggle:function(){this.isShow?this.close():this.show()},getChapterTitle:function(e){return i.default.getChapterTitle(e,this.isEpub)},isLock:function(e){return i.default.isChapterNeedPay({bookInfo:this.bookInfo,memberCardSummary:this.memberCardSummary,chapter:e})},isCurrent:function(e){return"object"===(0,r.default)(this.currentChapter)&&"number"==typeof this.currentChapter.chapterUid&&this.currentChapter.chapterUid===e.chapterUid},onShow:function(){this.scrollToCurrent(),this.searchResult.isNeedAutoSearchWhenShow&&this.emitAutoSearch()},scrollToCurrent:function(){var e=this.$refs.catalogListDom;if(e){var t=e.querySelector(".chapterItem_current");if(t){var n=t.parentNode;e.scrollTop=t.offsetTop-n.offsetTop}}},scrollToBottom:function(){var e=this.$refs.catalogListDom;if(e){var t=e.lastChild;t&&_.scrollTo(t,300,{container:e,x:!1,y:!0,offset:0})}},scrollToTop:function(){var e=this.$refs.catalogListDom;if(e){var t=e.firstChild;t&&_.scrollTo(t,300,{container:e,x:!1,y:!0,offset:0})}},handleClickScroller:function(){this.isScrollToBottom?this.scrollToBottom():this.scrollToTop(),this.isScrollToBottom=!this.isScrollToBottom},handleClickBookInfo:function(){this.$emit("clickBookInfo")},handleClickChapter:function(e){this.$emit("clickChapter",e)},getSearchResultChapterTitle:function(e){for(var t=this.chapterInfos,n=e.chapterUid,r=void 0,o=0,i=t.length;o<i;o++)if(t[o].chapterUid===n){r=t[o];break}var a="";return r&&(a=this.getChapterTitle(r)),a.trim()},getSearchResultChapterContent:function(e){var t=e.abstract||"",n=v.get(e,"keyword",[]);if(0<n.length){var r=new RegExp(n.map(function(e){return e.replace(d.default.getRegExpKeyWordReExp(),"\\$&")}).join("|"),"gi");t=t.replace(r,'<span class="highLight">$&</span>')}return t=t.trim(),this.getSearchXSS().process(t)},getSearchXSS:function(){return this.searchXSS||(this.searchXSS=new g.FilterXSS({whiteList:{span:["class"]}})),this.searchXSS},emitSearch:function(){this.searchKeyword.length<=0||0<v.get(this.searchResult,"resultList",[]).length&&this.searchResult.keyword===this.searchKeyword||this.$emit("search",{keyword:this.searchKeyword})},emitSearchLoadMore:function(){if(this.isSearchResultHasMore&&!this.isSearchLoading){var e=this.searchResult.keyword;if(!(e<=0)){var t=0,n=v.get(this.searchResult,"resultList",[]);0<n.length&&(t=v.get(v.last(n),"searchIdx",0)),this.$emit("search",{keyword:e,maxIdx:t,isLoadMore:!0})}}},emitAutoSearch:function(){this.searchKeyword.length<=0||this.$emit("search",{keyword:this.searchKeyword})},emitClickSearchItem:function(e){this.$emit("clickSearchItem",e)},handleInputFocused:function(){this.$emit("enterSearch")},exitSearch:function(){this.searchKeyword="",this.$emit("exitSearch")}}}},584:function(e,t,n){"use strict";n.r(t);var r=n(585),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(42)),o=a(n(191)),i=a(n(276));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ReaderCatalogBookInfo",components:{BookCover:i.default},props:{bookInfo:{type:Object,required:!0}},computed:{needShowUpdateTime:function(){return o.default.isBuyUnitChapter(this.bookInfo)},updateTimeString:function(){if(!this.needShowUpdateTime)return"";if(this.bookInfo.finished)return"已完结";if(this.bookInfo.updateTime){var e=this.bookInfo.updateTime,t=new Date(1e3*e);return"更新于 "+r.default.formatTime(t)}return""}},methods:{emitClickBookInfo:function(){this.$emit("clickBookInfo")}}}},586:function(e,t,n){},587:function(e,t,n){"use strict";n.r(t);var r=n(588),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},588:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ReaderPanelSectionListItem",props:{showSectionTitle:{type:Boolean,default:!1},sectionTitle:{type:String,default:""},dividerLeftIndent:{type:Boolean,default:!1},customContentClass:{type:String,default:""}},methods:{emitClickItem:function(){this.$emit("clickItem")}}}},589:function(e,t,n){},590:function(e,t,n){"use strict";n.r(t);var r=n(591),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},591:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ReaderPanelListEmptyView"}},592:function(e,t,n){},593:function(e,t,n){"use strict";n.r(t);var r=n(594),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(134),i=(r=o)&&r.__esModule?r:{default:r};t.default={name:"ReaderPanelListLoadingView",components:{Loading:i.default}}},595:function(e,t,n){},596:function(e,t,n){},597:function(e,t,n){"use strict";n.r(t);var r=n(598),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(279)),o=a(n(280)),i=a(n(191));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(22);t.default={name:"ReaderTopBar",components:{Avatar:r.default,Menu:o.default},props:{bookInfo:{type:Object,required:!0},currentChapter:{type:Object,required:!0},isShowAddShelf:{type:Boolean,required:!0},shelfBookCount:{type:Number,default:0}},computed:{bookTitleString:function(){return s.get(this.bookInfo,"title","")+" "},chapterTitleString:function(){var e=s.get(this.currentChapter,"title","");return[i.default.isEPub(this.bookInfo)?"":"第"+s.get(this.currentChapter,"chapterIdx","")+"章",e].join(" ")},avatarOptionList:function(){return this.isWeiXin?["我的书架"+(this.shelfBookCount?" · "+this.shelfBookCount:"")]:["我的书架"+(this.shelfBookCount?" · "+this.shelfBookCount:""),"退出登录"]},canShowLogin:function(){return!this.hasLogin&&!this.isPhone}},methods:{handleHideMenu:function(){var e=this.$refs.topBar_avatarMenu;e&&e.hideMenu()},isMenuShowing:function(){var e=this.$refs.topBar_avatarMenu;return!!e&&e.menuShowing},emitClickItem:function(e){this.$emit("onClickItem",e)},handleClickAvatarMenuOption:function(e){switch(e.index){case 0:this.emitClickItem("gotoShelf");break;case 1:this.emitClickItem("logout")}},handleClickAvatar:function(){this.$refs.topBar_avatarMenu.showMenu()}}}},599:function(e,t,n){},600:function(e,t,n){"use strict";n.r(t);var r=n(601),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},601:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ReaderBottomBar",props:{showShadow:{type:Boolean,required:!1,default:!0},showAddShelfButton:{type:Boolean,required:!1,default:!1}},methods:{emitClick:function(e){this.$emit("onClickItem",e)}}}},602:function(e,t,n){},603:function(e,t,n){"use strict";n.r(t);var r=n(604),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(19),i=(r=o)&&r.__esModule?r:{default:r};t.default={name:"ReaderBottomSettingPanel",props:{},computed:{canShowDownload:function(){return(new i.default).isPhone()}},methods:{emitClick:function(e){this.$emit("onClickItem",e)}}}},605:function(e,t,n){},606:function(e,t,n){"use strict";n.r(t);var r=n(607),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},607:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(191)),a=o(n(518)),r=o(n(43));function o(e){return e&&e.__esModule?e:{default:e}}var s=n(22);t.default={name:"PayWholeBookDialog",components:{Dialog:r.default},props:{bookInfo:{type:Object,required:!0},memberCardSummary:{type:Object,required:!1},balance:{type:Object,required:!1}},data:function(){return{}},computed:{payInfos:function(){var e={dialogPriceText:"",dialogAccountBalance:"",dialogBuyButtonText:"",isNeedDeposit:!1},t=this.balance,n=t.iOS>t.Android?t.iOS:t.Android;if(t.hasFetched?e.dialogAccountBalance="余额 "+Math.max(0,n).toFixed(2):e.dialogAccountBalance=" ",i.default.isLimitFree(this.bookInfo))e.dialogPriceText="限时免费",e.dialogBuyButtonText="获 取";else if(i.default.isFree(this.bookInfo))e.dialogPriceText="免费",e.dialogBuyButtonText="获 取";else if(a.default.isMemberShipValid(this.memberCardSummary)&&0<s.get(this.bookInfo,"mcardDiscount",0)){var r=(i.default.isBuyUnitWholeBook(this.bookInfo)?s.get(this.bookInfo,"price",0):s.get(this.currentChapter,"price",0))*(100-s.get(this.bookInfo,"mcardDiscount",0))/100;e.dialogPriceText=r.toFixed(2),e.isNeedDeposit=n<r,e.dialogBuyButtonText=e.isNeedDeposit?"去微信读书 App 充值":"购 买"}else{var o=i.default.isBuyUnitWholeBook(this.bookInfo)?s.get(this.bookInfo,"price",0):s.get(this.currentChapter,"price",0);e.dialogPriceText=o.toFixed(2),e.isNeedDeposit=n<o,e.dialogBuyButtonText=e.isNeedDeposit?"去微信读书 App 充值":"购 买"}return e}},methods:{showDialog:function(){this.$refs.dialog.showDialog()},closeDialog:function(){this.$refs.dialog.closeDialog()},emitDoPay:function(){this.$emit("doPay")}}}},608:function(e,t,n){},609:function(e,t,n){"use strict";n.r(t);var r=n(610),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(277)),o=a(n(518)),i=a(n(43));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(22);t.default={name:"PayChapterDialog",components:{Dialog:i.default},props:{bookInfo:{type:Object,required:!0},chapters:{type:Array,required:!0},memberCardSummary:{type:Object,required:!1},balance:{type:Object,required:!1}},data:function(){return{initSelectedChapterUid:-1,isAutoPay:1===s.get(this.bookInfo,"isAutoPay",0),sections:this.splitChaptersToSection(this.chapters)}},computed:{accountBalance:function(){var e=this.balance.iOS>this.balance.Android?this.balance.iOS:this.balance.Android;return Math.max(0,e)},isSelectedAll:function(){var t=this;return this.sections.every(function(e){return t.isSectionSelectedAll(e)})},selectedChaptersSize:function(){return s.sumBy(this.sections,function(e){return e.selected.length})},selectedChaptersPrice:function(){var n=0;return this.sections.forEach(function(e){var t=e.selected;e.chapters.forEach(function(e){-1!==t.indexOf(e.chapterUid)&&(n+=e.price)})}),n},selectedChaptersPriceWithDiscount:function(){var e=this.selectedChaptersPrice;this.hasMCardDiscount&&(e=e*(100-s.get(this.bookInfo,"mcardDiscount",0))/100);return e},hasMCardDiscount:function(){return o.default.isMemberShipValid(this.memberCardSummary)&&0<s.get(this.bookInfo,"mcardDiscount",0)},priceTitleWithMCardDiscount:function(){if(this.hasMCardDiscount){var e=s.get(this.bookInfo,"mcardDiscount",0);return"总价 · 无限卡"+o.default.discountToChinese(e)}return"总价"},isValid:function(){for(var e=0;e<this.sections.length;e++){if(0<this.sections[e].selected.length)return!0}return!1},isNeedDeposit:function(){return this.balance.hasFetched&&this.accountBalance<this.selectedChaptersPriceWithDiscount}},watch:{chapters:function(e){this.sections=this.splitChaptersToSection(e)}},methods:{showDialog:function(e){var n=this;this.initSelectedChapterUid=e,this.sections.forEach(function(t){t.selected.length=0,t.isExpand=!1,t.chapters.forEach(function(e){n.initSelectedChapterUid===e.chapterUid&&0<e.price&&1!==e.paid&&(t.selected.push(e.chapterUid),t.isExpand=!0)})}),this.$refs.dialog.showDialog()},closeDialog:function(){this.$refs.dialog.closeDialog()},onShow:function(){var e=this;this.$nextTick(function(){e.scrollToCurrent()})},scrollToCurrent:function(){var e=this.$refs.scrollDom;if(e){var t=document.getElementById("pcd_chapter_current");t&&(e.scrollTop=t.offsetTop)}},emitDoPay:function(){var e=Math.round(100*this.selectedChaptersPriceWithDiscount)/100,t={chapterIds:this.sortedSelectedChapterIds(),totalPrice:e,isAutoPay:this.isAutoPay};this.$emit("doPay",t)},splitChaptersToSection:function(c){for(var l=this,u=[],e=function(e,t){var n=c.slice(e,e+20),r=0,o=0,i=!0,a=[];n.forEach(function(e){r+=e.price,o+=1===e.paid?0:e.price,0<e.price&&1!==e.paid&&(i=!1),l.initSelectedChapterUid===e.chapterUid&&0<e.price&&1!==e.paid&&a.push(e.chapterUid)});var s=0<a.length;n.length&&u.push({key:n[0].chapterIdx,chapters:n,title:"第"+n[0].chapterIdx+"-"+n[n.length-1].chapterIdx+"章",isAllPaid:i,unpaidPrice:o,totalPrice:r,isExpand:s,selected:a})},t=0,n=c.length;t<n;t+=20)e(t);return u},sortedSelectedChapterIds:function(){var t=[];return this.sections.forEach(function(e){0<e.selected.length&&t.push.apply(t,(0,r.default)(e.selected))}),t.sort(),t},toggleSectionExpand:function(e){e.isExpand=!e.isExpand},changeTitleChecked:function(e,t){var n=t.target.checked;this.selectSection(e,n)},selectSection:function(t,e){var n=this;e?t.chapters.forEach(function(e){n.canChapterSelect(e)&&-1===t.selected.indexOf(e.chapterUid)&&t.selected.push(e.chapterUid)}):t.selected=[]},canChapterSelect:function(e){return 0<e.price&&1!==e.paid},isTitleChecked:function(e){return this.isSectionSelectedAll(e)},isSectionSelectedAll:function(t){return t.chapters.every(function(e){return 0===e.price||1===e.paid||-1!==t.selected.indexOf(e.chapterUid)})},toggleSection:function(e){var t=!this.isSectionSelectedAll(e);this.selectSection(e,t)},toggleChapter:function(e,t){if(this.canChapterSelect(t)){var n=e.selected.indexOf(t.chapterUid);-1===n?e.selected.push(t.chapterUid):e.selected.splice(n,1)}},toggleAllSelect:function(){var t=this,n=!this.isSelectedAll;this.sections.forEach(function(e){t.selectSection(e,n)})}}}},611:function(e,t,n){},612:function(e,t,n){"use strict";n.r(t);var r=n(613),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},613:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(134),i=(r=o)&&r.__esModule?r:{default:r};t.default={name:"ReaderLoginGuide",components:{Loading:i.default},props:{qrCodeImg:{type:String},getUidErr:{type:Boolean},getInfoErr:{type:Boolean},loadingQRCode:{type:Boolean}},methods:{emitReload:function(){this.$emit("reload")}}}},614:function(e,t,n){},615:function(e,t,n){"use strict";n.r(t);var r=n(616),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},616:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"FooterNote.vue",props:{text:{type:String,default:""}},data:function(){return{showing:!1,customStyle:""}},methods:{getOffset:function(e){for(var t=e.offsetTop,n=e.offsetLeft,r=e.offsetWidth,o=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return{top:t,left:n,width:r,height:o}},show:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(!this.showing){var s=this;this.showing=!0,this.text=t.text||"";var n=t.node||{},c=this.getOffset(n);this.$nextTick(function(){var e=s.$refs.footerNote_bubble,t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=window.innerHeight||Math.min(document.documentElement.clientHeight,document.body.clientHeight);if(c.top-t<n/2){this.$refs.footerNote_container.classList.add("reader_footerNote_container_Top");var r=c.left-e.offsetWidth/2+c.width/2,o=c.top+c.height+12;s.customStyle="left:"+r+"px;top:"+o+"px;"}else{this.$refs.footerNote_container.classList.remove("reader_footerNote_container_Top");var i=c.left-e.offsetWidth/2+c.width/2,a=c.top-e.offsetHeight-12;s.customStyle="left:"+i+"px;top:"+a+"px;"}})}},hide:function(){this.showing&&(this.showing=!1)},handleMaskClick:function(){this.hide()}}}},617:function(e,t,n){},618:function(e,t,n){"use strict";n.r(t);var r=n(619),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},619:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(43),i=(r=o)&&r.__esModule?r:{default:r};var a=n(137);t.default={name:"ReceiveMCardSuccessDialog",components:{Dialog:i.default},props:{},data:function(){return{day:0,qrCodeImg:""}},computed:{titleText:function(){return 0<this.day?"你已领取"+this.day+"天无限卡":"成功领取无限卡"}},methods:{beginToLoadQrCode:function(){this.reportClientBusiness({itemName:"Web_Download_GiftExp"});var e=a.generateDownloadAppURL({from:"ReceiveMemberCard"});this.qrCodeImg=n(66).getQrBase64(e,{padding:16,width:206,height:206,correctLevel:QRErrorCorrectLevel.H,background:"#FFF",foreground:"#000"})},showDialog:function(e){this.day=e&&e.day?e.day:0,this.$refs.dialog.showDialog()},closeDialog:function(){this.$refs.dialog.closeDialog()}}}},620:function(e,t,n){},631:function(e,t,n){"use strict";n.r(t);var r=n(632),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},632:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ReaderSelectionToolBar",data:function(){return{isBelow:!1,showing:!1,posStyle:"",arrowStyle:"",onClickToolBarItem:null,bookmark:null,canCopy:!1}},computed:{showItems:function(){var e=this.bookmark,t=[];return this.canCopy&&t.push({key:"copy",classNames:["copy"],text:"复制",type:"copy"}),t.push({key:"underline1",classNames:["underlineBg",e&&1===e.style?"selected":""],text:"马克笔",type:"underline",styleId:1}),t.push({key:"underline2",classNames:["underlineHandWrite",e&&2===e.style?"selected":""],text:"波浪线",type:"underline",styleId:2}),t.push({key:"underline0",classNames:["underlineStraight",e&&0===e.style?"selected":""],text:"直线",type:"underline",styleId:0}),e&&t.push({key:"removeUnderline",classNames:["removeUnderline"],text:"删除划线",type:"removeUnderline"}),t}},methods:{show:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.onClickToolBarItem=t.onClickToolBarItem,this.bookmark=t.bookmark,this.canCopy=t.canCopy;var v=t.toolbarBoundsLimit,m=t.rects;this.showing=!0;var C=this;this.$nextTick(function(){var e=this.$refs.toolbarContainer,t=e.offsetWidth,n=e.offsetHeight+12;function r(e){return e-n>=v.top}var o=!1,i="",a=null,s=0;if(o||r((a=m[0]).y)&&(i="above",s=a.y,o=!0),o||(a=m[m.length-1],a.y+a.h+n<=v.bottom&&(i="below",s=a.y+a.h,o=!0)),!o)for(var c=1;c<m.length;){if(r((a=m[c]).y)){i="above",s=a.y,o=!0;break}c++}if(!o){for(var l={left:Number.MAX_VALUE,top:Number.MAX_VALUE,right:Number.MIN_VALUE,bottom:Number.MIN_VALUE},u=0,d=m.length;u<d;u++){var h=m[u];l.left=Math.min(l.left,h.x),l.top=Math.min(l.top,h.y),l.right=Math.max(l.right,h.x+h.w),l.bottom=Math.max(l.bottom,h.y+h.h)}i="above",s=(l.top+l.bottom)/2,a={x:l.left,y:l.top,w:l.right-l.left,h:l.bottom-l.top}}var f=a.x+a.w/2-t/2,p=Math.max(Math.min(f,v.right-t),v.left),g=f-p-8;f=p;var _=0;switch(i){case"above":_=s-n;break;case"below":_=s+12}C.isBelow="below"===i,C.posStyle="left:"+f+"px;top:"+_+"px;",C.arrowStyle="margin-left:"+g+"px;"})},hide:function(){this.showing=!1},handleClickItem:function(e){return this.onClickToolBarItem&&this.onClickToolBarItem(e)}}}},633:function(e,t,n){},634:function(e,t,n){"use strict";n.r(t);var r=n(635),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},635:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ReaderMemberCardTips",props:{customSelector:{type:String,required:!1,default:""}},data:function(){return{showing:!1,text:""}},methods:{show:function(e){this.text=e,this.showing=!0},close:function(){this.showing=!1},onShow:function(){var e=this;setTimeout(function(){e.close()},5e3)}}}},636:function(e,t,n){},637:function(e,t,n){"use strict";n.r(t);var r=n(638),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},638:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(626)),o=a(n(279)),i=a(n(528));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(7);t.default={name:"ReaderTopReviews",props:{bookId:{type:String,require:!0},reviewList:{type:Array,require:!0}},components:{ReviewStarControl:r.default,Avatar:o.default,RankBar:i.default},mounted:function(){s.isEnvClient&&this.$nextTick(function(){for(var e=document.querySelectorAll(".reader_topReview_item .content"),t=0;t<e.length;t++){var n=e[t];n&&(n.scrollHeight>n.offsetHeight?n.classList.add("hasMore"):n.classList.remove("hasMore"))}})},methods:{handleBookReviewClick:function(e){var t=e.score;this.$emit("emit-book-review-click",{score:t})},handleContentClick:function(e){var t=document.querySelectorAll(".reader_topReview_item .content");if(t&&0<t.length&&0<=e&&e<=t.length-1){var n=t[e];n&&n.classList.contains("hasMore")&&n.classList.remove("content_Normal")}}}}},639:function(e,t,n){},640:function(e,t,n){"use strict";n.r(t);var r=n(641),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t.default=o.a},641:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(191)),o=h(n(529)),i=h(n(276)),a=h(n(671)),s=h(n(281)),c=h(n(134)),l=h(n(672)),u=h(n(673)),d=h(n(674));function h(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ReaderNotePanel",components:{ReaderPanelListLoadingView:d.default,ReaderPanelListEmptyView:u.default,ReaderPanelSectionListItem:l.default,BackgroundMask:s.default,ReaderCatalogBookInfo:a.default,BookCover:i.default,Loading:c.default},props:{bookInfo:{type:Object,required:!0},chapterInfos:{type:Array,required:!0},bookmarks:{type:Object,required:!0}},data:function(){return{isShow:!1}},computed:{bookmarkList:function(){return this.bookmarks.bookmarkList},isLoading:function(){return this.bookmarks.isFetching},isEpub:function(){return r.default.isEPub(this.bookInfo)}},methods:{show:function(){this.$refs.mask.showMask(),this.isShow=!0},close:function(){this.$refs.mask.closeMask(),this.isShow=!1},isShowing:function(){return this.isShow},toggle:function(){this.isShow?this.close():this.show()},onShow:function(){},getChapterTitle:function(e){return o.default.getChapterTitle(e,this.isEpub)},getNoteItemChapterTitle:function(e){for(var t=this.chapterInfos,n=e.chapterUid,r=void 0,o=0,i=t.length;o<i;o++)if(t[o].chapterUid===n){r=t[o];break}var a="";return r?a=this.getChapterTitle(r):n&&(a="第"+n+"章"),a.trim()},emitClickNoteItem:function(e){this.$emit("clickNoteItem",e)}}}},642:function(e,t,n){},643:function(e,t,n){},671:function(e,t,n){"use strict";n.r(t);var r=n(831),o=n(584);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(718);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},672:function(e,t,n){"use strict";n.r(t);var r=n(830),o=n(587);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(719);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},673:function(e,t,n){"use strict";n.r(t);var r=n(833),o=n(590);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(720);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},674:function(e,t,n){"use strict";n.r(t);var r=n(832),o=n(593);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(721);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},677:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(193));function r(e){return e&&e.__esModule?e:{default:e}}var i=((0,r(n(194)).default)(a,[{key:"toCSSPositionString",value:function(){return"left:"+this.x+"px;top:"+this.y+"px;width:"+this.w+"px;height:"+this.h+"px;"}},{key:"isLeftOn",value:function(e){return this.x<e.x}},{key:"set",value:function(e){this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h}},{key:"clone",value:function(){return new a(this.x,this.y,this.w,this.h)}},{key:"right",get:function(){return this.x+this.w}},{key:"bottom",get:function(){return this.y+this.h}},{key:"centerX",get:function(){return this.x+this.w/2}},{key:"centerY",get:function(){return this.y+this.h/2}}],[{key:"isVerticalContain",value:function(e,t){return(e.y-t.y)*(e.bottom-t.bottom)<=0}},{key:"isVerticalOverLap",value:function(e,t){var n=Math.min(e.y,t.y),r=Math.max(e.bottom,t.bottom);return e.h+t.h-r+n>=Math.min(e.h,t.h)/2}},{key:"union",value:function(e,t){var n=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return new a(n,r,Math.max(e.right,t.right)-n,Math.max(e.bottom,t.bottom)-r)}}]),a);function a(e,t,n,r){(0,o.default)(this,a),this.x=e,this.y=t,this.w=n,this.h=r}t.default=i},700:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=T(n(523)),p=T(n(65)),g=T(n(197)),_=T(n(64)),l=T(n(277)),f=T(n(132)),o=T(n(133)),u=T(n(61)),h=T(n(131)),d=T(n(701));t.default=function(){var e,t;return{state:{bookId:"",isBookInfoError:!1,bookInfo:{},isInShelf:!1,memberCardSummary:{},infiniteInfo:{},activeInfiniteInfo:{},readingStat:{},chapterInfos:[],progress:{},currentChapter:{},chapterContentHtml:"",chapterContentStyles:"",chapterContentState:"NORMAL",chapterContentTargetHtml:"",chapterContentTargetCanvasHtml:"",isChapterContentDirty:!1,isSearchLoading:!1,isInSearchMode:!1,isShowAutoSearchHint:!1,searchResult:{keyword:"",resultList:[],hasMore:!1,totalCount:0,isNeedAutoSearchWhenShow:!1},startReadingTime:0,pauseTime:0,activeTime:0,token:"",balance:{hasFetched:!1,iOS:0,Android:0},psvts:0,pclts:0},getters:{getChapterWithIdxOffset:function(r){return function(e){var t=S.get(r.currentChapter,"chapterIdx",0);if(t&&0<r.chapterInfos.length){var n=t-r.chapterInfos[0].chapterIdx+e;if(-1<n&&n<r.chapterInfos.length)return r.chapterInfos[n]}return null}},getChapterWithChapterUid:function(o){return function(e){for(var t=0,n=o.chapterInfos.length;t<n;t++){var r=o.chapterInfos[t];if(r&&r.chapterUid===e)return r}return null}},hasPrevChapter:function(e,t){return null!==t.getChapterWithIdxOffset(-1)},hasNextChapter:function(e,t){return null!==t.getChapterWithIdxOffset(1)},isCurrentChapterTheFirst:function(e){return!!e.bookInfo&&(!e.currentChapter||!e.chapterInfos||0===e.chapterInfos.length||e.chapterInfos[0].chapterIdx===e.currentChapter.chapterIdx)},chapterTitleText:function(e){if(!R.default.isSupportedBookType(e.bookInfo.type))return"";var t=e.currentChapter;if(!t)return"";var n=S.get(t,"title","");return[R.default.isEPub(e.bookInfo)?"":"第"+S.get(t,"chapterIdx","")+"章",n].join(" ")},isBlackUser:function(e){return"black"===S.get(e.activeInfiniteInfo,"userType")},isNeedPay:function(e){return a.default.isChapterNeedPay({bookInfo:e.bookInfo,memberCardSummary:e.memberCardSummary,chapter:e.currentChapter})},isNeedPayWithoutMemberCard:function(e){return a.default.isChapterNeedPay({bookInfo:e.bookInfo,chapter:e.currentChapter})}},mutations:(e={},(0,o.default)(e,E.UPDATE_INIT_BOOK_ID,function(e,t){e.bookId=t||""}),(0,o.default)(e,E.UPDATE_READER_BOOK_INFO_ERROR,function(e){e.isBookInfoError=!0}),(0,o.default)(e,E.UPDATE_READER_BOOK_INFO_PRICE,function(e,t){e.bookInfo.price=t||0}),(0,o.default)(e,E.UPDATE_READER_BOOK_INFO_PAY_TYPE,function(e,t){e.bookInfo.payType=t||0}),(0,o.default)(e,E.UPDATE_READER_BOOK_INFO,function(e,t){e.bookInfo=t||{}}),(0,o.default)(e,E.UPDATE_READER_READING_STAT,function(e,t){e.readingStat=t||{}}),(0,o.default)(e,E.UPDATE_BOOK_IN_SHELF,function(e,t){e.isInShelf=t||!1}),(0,o.default)(e,E.UPDATE_READER_MEMBER_CARD_SUMMARY,function(e,t){e.memberCardSummary=t||{}}),(0,o.default)(e,E.UPDATE_READER_INFINITE_INFO,function(e,t){e.infiniteInfo=t||{}}),(0,o.default)(e,E.UPDATE_READER_ACTIVE_INFINITE_INFO,function(e,t){e.activeInfiniteInfo=t||{}}),(0,o.default)(e,E.UPDATE_READER_CHAPTER_INFOS,function(e,t){e.chapterInfos=t||[]}),(0,o.default)(e,E.UPDATE_READER_PROGRESS,function(e,t){e.progress=t||{}}),(0,o.default)(e,E.UPDATE_READER_LOCAL_PROGRESS,function(e,t){var n=t.appId,r=t.chapterUid,o=t.chapterOffset,i=t.updateTime,a=t.summary,s=(0,h.default)({},e.progress.book,{appId:n,chapterUid:r,chapterOffset:o,updateTime:i,summary:a});e.progress=(0,h.default)({},e.progress,{book:s})}),(0,o.default)(e,E.UPDATE_READER_CURRENT_CHAPTER,function(e,t){e.currentChapter=t||{}}),(0,o.default)(e,E.UPDATE_READER_CONTENT_HTML,function(e,t){var n=+new Date;if(e.chapterContentHtml=function(e,t){if(!e||e.length<=0)return"";var n=new RegExp('<img(?!<img).+?data-wr-co="(.+?)"(?!<img).+?alt="(.+?)"(?!<img).+?qqreader-footnote(?!<img).+?>',"gi");return(e=(e=(e=e.replace(n,'<span class="reader_footer_note js_readerFooterNote" data-wr-co="$1" data-wr-footernote="$2"></span>')).replace(/\.\.\/video\/(.*?\.(mp4|wmv|3gp|rm|rmvb|mov|m4v|avi))/gi,"https://res.weread.qq.com/wrepub/web/"+t+"/$1")).replace(/\.\.\/images\/(.*?\.(png|jpg|jpeg|gif))/gi,"https://res.weread.qq.com/wrepub/web/"+t+"/$1")).trim()}(t||"",e.bookId),B.inDevelopment()){var r=+new Date;console.log("[reader-layout] DOM 过滤处理时间 = ",r-n,"毫秒")}}),(0,o.default)(e,E.UPDATE_READER_CONTENT_STYLES,function(e,t){var n=+new Date;if(e.chapterContentStyles=function(e,t){if(!e||e.length<=0)return"";e=e.trim();var n=new RegExp("[^{}]*?{[\\s\\S]+?}","gi");return e.replace(/\/\*.*?\*\//gi,"").match(n).map(function(e){return".readerChapterContent "+(e=e.trim()).split("\n").map(function(e){return-1===(e=e.trim()).indexOf("{")&&-1===e.indexOf("}")&&-1===e.indexOf(";")?e+";":e}).join("")}).join("").trim().replace(/\.\.\/images\/(.*?\.(png|jpg|jpeg|gif))/gi,"https://res.weread.qq.com/wrepub/web/"+t+"/$1")}(t||"",e.bookId),B.inDevelopment()){var r=+new Date;console.log("[reader-layout] Style 过滤处理时间 = ",r-n,"毫秒")}}),(0,o.default)(e,E.UPDATE_READER_CHAPTER_CONTENT_TARGET_HTML,function(e,t){e.chapterContentTargetHtml=t||""}),(0,o.default)(e,E.UPDATE_READER_CHAPTER_CANVAS_TARGET_HTML,function(e,t){e.chapterContentTargetCanvasHtml=t||""}),(0,o.default)(e,E.UPDATE_READER_CONTENT_STATE,function(e,t){e.chapterContentState=t}),(0,o.default)(e,E.UPDATE_READER_CONTENT_IS_DIRTY,function(e,t){e.isChapterContentDirty=t||!1}),(0,o.default)(e,E.UPDATE_READER_SEARCH_RESULT,function(e,t){t.isLoadMore?e.searchResult.resultList=e.searchResult.resultList.concat(t.resultList):e.searchResult.resultList=t.resultList,e.searchResult.hasMore=t.hasMore,e.searchResult.totalCount=t.totalCount,e.searchResult.isNeedAutoSearchWhenShow=t.isNeedAutoSearchWhenShow}),(0,o.default)(e,E.CLEAR_READER_SEARCH_RESULT,function(e){e.searchResult.keyword="",e.searchResult.resultList=[],e.searchResult.hasMore=!1,e.searchResult.totalCount=0,e.isSearchLoading=!1}),(0,o.default)(e,E.UPDATE_READER_SEARCH_RESULT_KEYWORD,function(e,t){e.searchResult.keyword=t||""}),(0,o.default)(e,E.UPDATE_READER_IS_IN_SEARCH,function(e,t){e.isInSearchMode=t||!1}),(0,o.default)(e,E.UPDATE_READER_IS_SHOW_AUTO_SEARCH_HINT,function(e,t){e.isShowAutoSearchHint=t||!1}),(0,o.default)(e,E.UPDATE_READER_SEARCH_LOADING,function(e,t){e.isSearchLoading=t||!1}),(0,o.default)(e,E.UPDATE_READER_START_READING_TIME,function(e,t){e.startReadingTime=t||(new Date).getTime()}),(0,o.default)(e,E.UPDATE_READER_TOKEN,function(e,t){e.token=t||""}),(0,o.default)(e,E.UPDATE_READER_PAUSE_TIME,function(e){e.pauseTime=(new Date).getTime()}),(0,o.default)(e,E.UPDATE_READER_ACTIVE_TIME,function(e){e.activeTime=(new Date).getTime()}),(0,o.default)(e,E.UPDATE_READER_BALANCE,function(e,t){var n=S.get(t,"balance",0),r=S.get(t,"peerBalance",0);e.balance={hasFetched:!0,iOS:n,Android:r}}),(0,o.default)(e,E.UPDATE_READER_PAGE_SERVER_TIMESTAMP,function(e,t){e.psvts=y.e(t)||""}),(0,o.default)(e,E.UPDATE_READER_PAGE_CLIENT_TIMESTAMP,function(e,t){e.pclts=y.e(t)||""}),e),actions:(t={},(0,o.default)(t,b.FETCH_READER_INIT_DATA,function(e,t){var r=e.commit,n=e.dispatch,o=e.state,i=e.getters,a=t.initChapterUid,s=t.envConfig,c=t.isLogin;return f.default.all([f.default.all([n(b.FETCH_READER_BOOK_INFO,{envConfig:s,isLogin:c}),n(b.FETCH_READER_CHAPTER_INFOS,{envConfig:s,isLogin:c})].concat((0,l.default)(c?[n(b.FETCH_READER_PROGRESS,{envConfig:s,compareWithLocal:!1})]:[]))).then(function(e){var t=e[0]||{},n=e[1]||[];r(E.UPDATE_READER_CHAPTER_INFOS,N(t,n))}).then(function(){var e=function(e){var t=e.bookInfo,n=e.chapterInfos,r=e.initChapterUid,o=e.progress,i=null;if(R.default.isSupportedBookType(t.type)){var a=r;if(!r||!(0,d.default)(r)){var s=S.get(o,"book.chapterUid",0);0<s&&(a=s)}for(var c=0,l=n.length;c<l;c++){var u=n[c];if(u&&u.chapterUid===a){i=u;break}}}i&&i.chapterUid||(i=n[0]);L("chapterToShow","initChapterUid="+r,"progressChapterUid="+S.get(o,"book.chapterUid",0),"result="+(i?i.chapterUid:-1)),i||L("Error in chapterToShow. Can not find target Chapter");return i||{}}({bookInfo:o.bookInfo,chapterInfos:o.chapterInfos,initChapterUid:a,progress:o.progress});r(E.UPDATE_READER_CURRENT_CHAPTER,e),r(E.UPDATE_SHOW_NAV_BAR,i.isCurrentChapterTheFirst),r(E.UPDATE_READER_CONTENT_IS_DIRTY,!0),R.default.isSupportedBookType(o.bookInfo.type)?r(E.UPDATE_READER_CONTENT_STATE,"LOADING"):r(E.UPDATE_READER_CONTENT_STATE,"DONE")})].concat((0,l.default)(c?[n(b.FETCH_READER_BOOK_IN_SHELF,s),n(b.FETCH_READER_MEMBER_CARD_SUMMARY,s),n(b.FETCH_READER_INFINITE_INFO,s),n(b.FETCH_READER_ACTIVE_INFINITE,s),n(b.FETCH_READER_GET_CONFIG,s)]:[]),[n(b.FETCH_READER_BOOK_READING_STAT,{envConfig:s,isLogin:c})])).catch(function(e){L("Error in initData",e)})}),(0,o.default)(t,b.FETCH_READER_BOOK_INFO,function(e,t){var n=e.commit,r=e.state,o=e.dispatch,i=t.envConfig,a=t.isLogin,s=r.bookId;if(s)return o(b.FETCH_BOOK_INFO,{envConfig:i,bookId:s,isLogin:a}).then(function(e){var t=e||{};return console.log("[zhoonlog] bookinfo = "+(0,_.default)(t)),n(E.UPDATE_READER_BOOK_INFO,t),t.title&&n(E.UPDATE_PAGE_TITLE,t.title),t}).catch(function(e){n(E.UPDATE_READER_BOOK_INFO_ERROR),L("Error in loadBookInfo(bookId="+s,e)})}),(0,o.default)(t,b.FETCH_READER_CHAPTER_INFOS,function(e,t){var n=e.state,r=t.envConfig,o=t.isLogin,a=n.bookId;if(a)return o?(0,C.default)("/web/book/chapterInfos",(0,h.default)({bookIds:[a]},r)).then(function(e){for(var t=(e.data||{}).data||[],n={},r=0,o=t.length;r<o;r++){var i=t[r];if(i&&i.bookId===a){n=i;break}}return n.updated||[]}).catch(function(e){L("Error in chapterInfos",e)}):(0,C.default)("/web/book/publicchapterInfos",(0,h.default)({bookIds:[a]},r)).then(function(e){for(var t=(e.data||{}).data||[],n={},r=0,o=t.length;r<o;r++){var i=t[r];if(i&&i.bookId===a){n=i;break}}return n.updated||[]}).catch(function(e){L("Error in publicchapterInfos",e)})}),(0,o.default)(t,b.RELOAD_READER_CHAPTER_INFOS,function(e,t){var n=e.dispatch,r=e.commit,o=e.state,i=t.isLogin;return n(b.FETCH_READER_CHAPTER_INFOS,{envConfig:{},isLogin:i}).then(function(e){r(E.UPDATE_READER_CHAPTER_INFOS,N(o.bookInfo,e))})}),(0,o.default)(t,b.FETCH_READER_PROGRESS,function(e,t){var l=e.commit,u=e.state,n=t.envConfig,d=t.compareWithLocal,r=u.bookId;if(r)return(0,m.default)("/web/book/getProgress",(0,h.default)({bookId:r},n),function(e){if(d){var t=e.data,n=u.progress;if(!t||!n)return null;if(S.get(t,"book.updateTime",0)<=S.get(n,"book.updateTime",0))return null;if(S.get(t,"book.appId","")===S.get(n,"book.appId",""))return null;for(var r=S.get(t,"book.chapterUid",0),o=u.chapterInfos||[],i=!1,a=0,s=o.length;a<s;a++){var c=o[a];if(c&&c.chapterUid===r){i=!0;break}}return i?(l(E.UPDATE_READER_PROGRESS,t),t):null}l(E.UPDATE_READER_PROGRESS,e.data)},function(e){L("Error in fetchBookProgress",e)})}),(0,o.default)(t,b.FETCH_READER_BOOK_READING_STAT,function(e,t){var n=e.commit,r=e.state,o=t.envConfig,i=t.isLogin,a=r.bookId;if(a)return i?(0,m.default)("/web/book/readingStat",(0,h.default)({bookId:a,showUserNum:2},o),function(e){n(E.UPDATE_READER_READING_STAT,e.data)},function(e){L("Error in fetchReadingStat",e)}):(0,m.default)("/web/readingStat",(0,h.default)({bookId:a},o),function(e){n(E.UPDATE_READER_READING_STAT,e.data)},function(e){L("Error in fetchReadingStatNoSession",e)})}),(0,o.default)(t,b.FETCH_READER_BOOK_IN_SHELF,function(e,t){var a=e.commit,n=e.dispatch,s=e.state,r=s.bookId;if(r)return n(b.FETCH_IN_SHELF,{envConfig:t,bookIds:r}).then(function(e){for(var t={},n=0,r=e.length;n<r;n++){var o=e[n];if(o.bookId===s.bookId){t=o;break}}var i=1===t.onShelf;a(E.UPDATE_BOOK_IN_SHELF,i)}).catch(function(e){L("Error in fetchBookInShelf",e)})}),(0,o.default)(t,b.FETCH_READER_ADD_SHELF,function(e){var t=e.commit,n=e.dispatch,r=e.state.bookId;if(r)return n(b.FETCH_ADD_SHELF,{bookIds:[r]}).then(function(e){return e&&t(E.UPDATE_BOOK_IN_SHELF,!0),e}).catch(function(e){L("Error in addShelf",e)})}),(0,o.default)(t,b.FETCH_READER_ACTIVE_INFINITE,function(e,t){var n=e.commit;return(0,m.default)("/web/act/activeinfinite",(0,h.default)({},t),function(e){n(E.UPDATE_READER_ACTIVE_INFINITE_INFO,e.data)},function(e){L("Error in fetchReaderActiveInfinite",e)})}),(0,o.default)(t,b.FETCH_READER_MEMBER_CARD_SUMMARY,function(e,t){var n=e.commit;return(0,m.default)("/web/pay/memberCardSummary",(0,h.default)({},t,{pf:"ios"}),function(e){n(E.UPDATE_READER_MEMBER_CARD_SUMMARY,e.data)},function(e){L("Error in fetchMemberCardSummary",e)})}),(0,o.default)(t,b.FETCH_READER_INFINITE_INFO,function(e,t){var n=e.commit;return(0,m.default)("/web/act/sendinfinite",(0,h.default)({},t),function(e){n(E.UPDATE_READER_INFINITE_INFO,e.data)},function(e){L("Error in fetchReaderInfiniteInfo",e)})}),(0,o.default)(t,b.FETCH_READER_RECEIVE_MEMBERCARD,function(){}),(0,o.default)(t,b.FETCH_READER_CHAPTER_CONTENT,function(e){var t=e.dispatch,s=e.commit,o=e.state,c=e.getters;if(o.isChapterContentDirty){var i=o.bookId,n=o.currentChapter,a=S.get(n,"chapterUid");if(i&&a){s(E.UPDATE_READER_CONTENT_STATE,"LOADING"),s(E.UPDATE_READER_CHAPTER_CONTENT_TARGET_HTML,"");var r=function(e){var t=0<arguments.length&&void 0!==e?e:{},n={b:y.e(i),c:y.e(a),r:Math.pow(parseInt(1e4*Math.random()),2),st:0,ct:parseInt((new Date).getTime()/1e3),ps:o.psvts,pc:o.pclts};(0,g.default)(n,t);var r=x(n);return n.s=P(r),n},l=void 0;l=R.default.isEPub(o.bookInfo)?f.default.all([(0,C.default)(O("255e4h4e254e565652254f4k4d575b4h59254h4b26"),r(),function(e){var t=e.data;return t&&"string"==typeof t?w.chk(t):""},function(e){return L("Error in fetchContent",e),e}),(0,C.default)(O("255e4h4e254e565652254f4k4d575b4h59254h4b27"),r(),function(e){var t=e.data;return t&&"string"==typeof t?w.chk(t):""},function(e){return L("Error in fetchContent",e),e}),(0,C.default)(O("255e4h4e254e565652254f4k4d575b4h59254h4b28"),r({st:1}),function(e){var t=e.data;return t&&"string"==typeof t?w.chk(t):""},function(e){return L("Error in fetchContent",e),e}),(0,C.default)(O("255e4h4e254e565652254f4k4d575b4h59254h4b29"),r(),function(e){var t=e.data;return t&&"string"==typeof t?w.chk(t):""},function(e){return L("Error in fetchContent",e),e})]).then(function(e){if("string"==typeof e[0]&&0<e[0].length&&"string"==typeof e[1]&&0<e[1].length&&"string"==typeof e[2]&&0<e[2].length&&"string"==typeof e[3]&&0<e[3].length){var t=w.dS(e[2]);t=D.parse(t);var n=e[0]+e[1]+e[3];"..."===(n=w.dH(n))&&(n=c.chapterTitleText);var r=+new Date;if(n=A.parse(n,t),B.inDevelopment()){var o=+new Date;console.log("[reader-layout] DOM 预处理时间 = ",o-r,"毫秒")}s(E.UPDATE_READER_CONTENT_HTML,n),s(E.UPDATE_READER_CONTENT_STYLES,t),s(E.UPDATE_READER_CONTENT_STATE,"PRERENDER")}else{var i=null;if("object"===(0,p.default)(e[0])?i=e[0]:"object"===(0,p.default)(e[1])?i=e[1]:"object"===(0,p.default)(e[2])?i=e[2]:"object"===(0,p.default)(e[3])&&(i=e[3]),i){var a=i.errCode;if(-2012===a)return f.default.reject({isCustomError:!0,reason:"forceReload"});if(-2010===a||-2013===a)return f.default.reject({isCustomError:!0,reason:"sessionTimeout"})}s(E.UPDATE_READER_CONTENT_STATE,"ERROR")}},function(e){s(E.UPDATE_READER_CONTENT_STATE,"ERROR"),L("Error in fetchContent",e)}):f.default.all([(0,C.default)(O("255e4h4e254e565652254f4k4d575b4h59255b4b26"),r(),function(e){var t=e.data;return t&&"string"==typeof t?w.chk(t):""},function(e){return L("Error in fetchContent",e),e}),(0,C.default)(O("255e4h4e254e565652254f4k4d575b4h59255b4b27"),r(),function(e){var t=e.data;return t&&"string"==typeof t?w.chk(t):""},function(e){return L("Error in fetchContent",e),e})]).then(function(e){var t=e[0],n=e[1];if("string"==typeof t&&0<t.length&&"string"==typeof n&&0<n.length){var r=t+n;r=w.dT(r);var o=A.parseTxt(r);s(E.UPDATE_READER_CONTENT_HTML,o),s(E.UPDATE_READER_CONTENT_STATE,"PRERENDER")}else{var i=null;if("object"===(void 0===t?"undefined":(0,p.default)(t))?i=t:"object"===(void 0===n?"undefined":(0,p.default)(n))&&(i=n),i){var a=i.errCode;if(-2012===a)return f.default.reject({isCustomError:!0,reason:"forceReload"});if(-2010===a||-2013===a)return f.default.reject({isCustomError:!0,reason:"sessionTimeout"})}s(E.UPDATE_READER_CONTENT_STATE,"ERROR")}},function(e){s(E.UPDATE_READER_CONTENT_STATE,"ERROR"),L("Error in fetchContent",e)});var u=c.isNeedPay,d=k.default.isMemberShipValid(o.memberCardSummary),h=k.default.canBookFreeReading({bookInfo:o.bookInfo,memberCardSummary:o.memberCardSummary});return l.then(function(){if(s(E.UPDATE_READER_CONTENT_IS_DIRTY,!1),u&&d&&!h)return t(b.FETCH_READER_MEMBER_CARD_SUMMARY,{})})}}}),(0,o.default)(t,b.CHANGE_READER_CHAPTER,function(e,t){var n=e.dispatch,r=e.commit,o=e.state,i=e.getters,a=t.chapterUid;if("DONE"!==o.chapterContentState)return f.default.reject({isCustomError:!0,reason:o.chapterContentState});if(S.get(o.currentChapter,"chapterUid",0)===a)return f.default.reject({isCustomError:!0,reason:"currentChapter"});var s=void 0,c=i.getChapterWithIdxOffset(1);return c&&c.chapterUid===a&&(s=c),(s=s||i.getChapterWithChapterUid(a))?s?(r(E.UPDATE_READER_CURRENT_CHAPTER,s),r(E.UPDATE_SHOW_NAV_BAR,i.isCurrentChapterTheFirst),r(E.UPDATE_READER_CONTENT_IS_DIRTY,!0),window&&window.history.replaceState(null,null,I.readerURL(o.bookId,{chapterUid:a})),n(b.FETCH_READER_CHAPTER_CONTENT)):void 0:f.default.reject({isCustomError:!0,reason:"chapterNotExist"})}),(0,o.default)(t,b.RELOAD_READER_CURRENT_CHAPTER,function(e){var t=e.dispatch,n=e.commit,r=e.state,o=e.getters;if(r.currentChapter){n(E.UPDATE_READER_CONTENT_IS_DIRTY,!0);var i=r.currentChapter.chapterUid,a=o.getChapterWithChapterUid(i);return n(E.UPDATE_READER_CURRENT_CHAPTER,a),t(b.FETCH_READER_CHAPTER_CONTENT)}}),(0,o.default)(t,b.FETCH_READER_SEARCH_AUTO,function(e,t){var n=e.dispatch,r=e.commit,o=t.keyword;return r(E.UPDATE_READER_IS_SHOW_AUTO_SEARCH_HINT,!0),r(E.UPDATE_READER_IS_IN_SEARCH,!0),n(b.FETCH_READER_SEARCH,{keyword:o,isOnlyCount:!0})}),(0,o.default)(t,b.FETCH_READER_SEARCH,function(e,i){var a=e.commit,s=e.state;i.isLoadMore||(a(E.CLEAR_READER_SEARCH_RESULT),a(E.UPDATE_READER_SEARCH_RESULT_KEYWORD,i.keyword)),a(E.UPDATE_READER_SEARCH_LOADING,!0);var c=S.get(i,"isOnlyCount",!1);return(0,m.default)("/web/book/search",{bookId:s.bookId,keyword:i.keyword||"",maxIdx:i.maxIdx||0,count:10,fragmentSize:i.fragmentSize||150,onlyCount:c?1:0},function(e){a(E.UPDATE_READER_SEARCH_LOADING,!1);var t=e.data,n=S.get(t,"result",[]),r=1===S.get(t,"hasMore",0),o=S.get(t,"totalCount",0);a(E.UPDATE_READER_SEARCH_RESULT,{resultList:function(e,t){if(0===t.length)return t;var n=[],r=0<(e=e||[]).length?e[e.length-1].chapterUid:-1;return t.forEach(function(e){var t=(0,h.default)({},e,{firstInChapter:!1});r!==e.chapterUid&&(r=e.chapterUid,t.firstInChapter=!0),n.push(t)}),n}(s.searchResult.resultList,n),isLoadMore:i.isLoadMore,totalCount:o,hasMore:r,isNeedAutoSearchWhenShow:c})},function(e){a(E.UPDATE_READER_SEARCH_LOADING,!1),L("Error in readerSearch",e)})}),(0,o.default)(t,b.FETCH_READER_GET_CONFIG,function(e,t){var n=e.commit;return(0,m.default)("/web/getConfig",(0,h.default)({},t),function(e){var t=S.get(e.data,"token","");n(E.UPDATE_READER_TOKEN,t)},function(e){L("Error in getConfig",e)})}),(0,o.default)(t,b.FETCH_READER_ENTER_BOOK_READ,function(e,t){var n=e.state,r=e.commit,o=t.firstDomOffset,i=t.firstDomSummaryText;if(!n.isBookInfoError){var a=n.currentChapter,s={appId:M(navigator.userAgent),b:y.e(n.bookId),c:y.e(a.chapterUid),ci:a.chapterIdx,co:0,sm:"",ct:parseInt((new Date).getTime()/1e3),ps:n.psvts,pc:n.pclts};if(R.default.isSupportReaderProgress(n.bookInfo)){var c=n.progress;S.get(c,"book.chapterUid",0)===a.chapterUid?(s.co=S.get(c,"book.chapterOffset",s.co),s.sm=S.get(c,"book.summary",s.sm)):(s.co=o,s.sm=i)}return s.s=P(x(s)),r(E.UPDATE_READER_LOCAL_PROGRESS,{appId:s.appId,chapterUid:a.chapterUid,chapterOffset:s.co,updateTime:parseInt((new Date).getTime()/1e3),summary:s.sm}),L("enterBookRead",new Date,"params="+(0,_.default)(s)),(0,C.default)("/web/book/read",s,function(e){return e},function(e){L("Error in enterBookRead",e);var t=S.get(e,"errCode",0);return-2010===t||-2012===t||-2013===t?{sessionTimeout:1}:e})}L("enterBookRead","return bcs of bookInfoError")}),(0,o.default)(t,b.FETCH_READER_BOOK_READ,function(e,n){var r=e.dispatch,t=e.commit,o=e.state;if(!o.isBookInfoError){var i=S.get(n,"retryCount",0),a=o.currentChapter,s=o.token,c=(new Date).getTime(),l=o.startReadingTime,u=0===l?0:Math.max(0,parseInt((c-l)/1e3)),d=parseInt(1e3*Math.random()),h={appId:M(navigator.userAgent),b:y.e(o.bookId),c:y.e(a.chapterUid),ci:a.chapterIdx,co:0,sm:"",rt:u,ts:c,rn:d,sg:(0,v.sha256)(""+c+d+s),ct:parseInt((new Date).getTime()/1e3),ps:o.psvts,pc:o.pclts};if(R.default.isSupportReaderProgress(o.bookInfo)){var f=S.get(n,"progressData",null);null!==f&&"object"===(void 0===f?"undefined":(0,p.default)(f))&&(h.co=f.offset,h.sm=f.content.substr(0,20))}return h.s=P(x(h)),t(E.UPDATE_READER_LOCAL_PROGRESS,{appId:h.appId,chapterUid:a.chapterUid,chapterOffset:h.co,updateTime:parseInt(c/1e3),summary:h.sm}),L("reportTime","reportTime at",new Date,"duration="+u+"s","params="+(0,_.default)(h)),(0,C.default)("/web/book/read",h,function(e){return t(E.UPDATE_READER_START_READING_TIME),e.data},function(e){L("Error in bookRead",e);var t=S.get(e,"errCode",0);return-2010===t||-2012===t||-2013===t?{sessionTimeout:1}:0<i&&-2054===t?r(b.FETCH_READER_GET_CONFIG).then(function(){return r(b.FETCH_READER_BOOK_READ,(0,g.default)(n,{retryCount:i-1}))}):e})}L("bookRead","return bcs of bookInfoError")}),(0,o.default)(t,b.READER_MARK_PAUSE,function(e){(0,e.commit)(E.UPDATE_READER_PAUSE_TIME),L("hidden/idle at",new Date)}),(0,o.default)(t,b.READER_MARK_ACTIVE,function(e){var t=e.commit,n=e.state;t(E.UPDATE_READER_ACTIVE_TIME);var r=0;n.activeTime>n.pauseTime&&0<n.pauseTime&&0<n.startReadingTime&&(r=n.activeTime-n.pauseTime,t(E.UPDATE_READER_START_READING_TIME,n.startReadingTime+r));var o=3e4<(new Date).getTime()-n.startReadingTime;return L("active at",new Date(n.activeTime),", ignored duration="+parseInt(r/1e3)+"s",", isNeedForceReport="+o),o}),(0,o.default)(t,b.UPDATE_READER_LOCAL_LAST_CHAPTER,function(e){var t=e.state;if(t.bookId&&t.bookInfo&&0!==t.chapterInfos.length&&t.isInShelf&&R.default.isBuyUnitChapter(t.bookInfo)){var n=t.bookId,r=t.chapterInfos;if(n&&0<r.length){var o=s.default.getBookLastChaptersOperator(S.get(this.user,"vid")),i=S.get(r[r.length-1],"chapterIdx",0);o.set(n,i),o.save()}}}),(0,o.default)(t,b.FETCH_READER_BALANCE,function(e){var t=e.commit;return(0,C.default)("/web/pay/balance",{pf:"ios_html"},function(e){return t(E.UPDATE_READER_BALANCE,e.data),e},function(e){return L("Error in fetchReaderBalance",e),e})}),(0,o.default)(t,b.FETCH_READER_BUY_BOOK,function(e,t){var n=e.state,r=t.pf,o=t.price,i=t.isMCard,a={b:y.e(n.bookId),pt:n.bookInfo.payType,pf:r,pr:o,mm:i?1:0,ct:parseInt((new Date).getTime()/1e3),ps:n.psvts,pc:n.pclts};return a.s=P(x(a)),(0,C.default)("/web/pay/buyBook",a,function(e){return e.data},function(e){return L("Error in fetchReaderBuyBook",e),e})}),(0,o.default)(t,b.FETCH_READER_BUY_CHAPTERS,function(e,t){var n=e.state,r=t.pf,o=t.chapterIds,i=t.totalPrice,a=t.isMCard,s=t.isAutoPay,c={b:y.e(n.bookId),pt:n.bookInfo.payType,pf:r,ci:o,tp:i,mm:a?1:0,ap:s?"1":"0",ct:parseInt((new Date).getTime()/1e3),ps:n.psvts,pc:n.pclts};return c.s=P(x(c)),(0,C.default)("/web/pay/buyChapters",c,function(e){return e.data},function(e){return L("Error in fetchReaderBuyChapters",e),e})}),(0,o.default)(t,b.FETCH_ENCOURAGE_MONEY,function(e,t){(0,r.default)(e);var n=t.packetId||"";return(0,m.default)("/web/pay/memberCardCouponPacket",{packetId:n},function(){},function(){})}),t)}};var v=n(705),m=T(n(192)),C=T(n(62)),b=c(n(34)),E=c(n(60)),i=T(n(42)),R=T(n(191)),a=T(n(529)),k=T(n(518)),s=T(n(63));function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}var S=n(22),I=n(137),y=n(67),w=n(707),A=n(709),D=n(710),B=n(7);function L(){var e;B.isEnvServer,B.inDevelopment()&&(e=console).log.apply(e,["[readerLog]"].concat(Array.prototype.slice.call(arguments)))}function N(e,t){if(!e||!t)return[];var n=t.map(function(e){return{chapterUid:e.chapterUid,chapterIdx:e.chapterIdx,title:i.default.replaceBlankToSpace(e.title).trim(),paid:e.paid||0,price:e.price||0,level:e.level||1,updateTime:e.updateTime}});return(R.default.isBuyUnitWholeBook(e)||R.default.isEPub(e))&&(n=n.filter(function(e){return"封面"!==e.title})),n}function O(e,t){for(var n=1<arguments.length&&void 0!==t?t:21,r="",o=0;o<e.length;o+=2)r+=String.fromCharCode(parseInt(e.slice(o,o+2),n));return r}function P(e){for(var t=352654597,n=t,r=e.length,o=r-1;0<o;o-=2)t=2147483647&(t^e.charCodeAt(o)<<(r-o)%30),n=2147483647&(n^e.charCodeAt(o-1)<<o%30);return(t+n).toString(16).toLowerCase()}function x(e,t){for(var n=1<arguments.length&&void 0!==t?t:[],r="",o=0===n.length,i=(0,u.default)(e).sort(),a=0;a<i.length;a++){var s=i[a];if(o||-1!==n.indexOf(s)){var c=e[s];r+=s+"="+encodeURIComponent(c),r+="&"}}return 0<r.length&&"&"===r.charAt(r.length-1)&&(r=r.slice(0,r.length-1)),r}function M(e){for(var t="",n=e.split(" "),r=0,o=Math.min(n.length,12);r<o;r++)t+=n[r].length%10;var i=function(e){for(var t=0,n=0,r=e.length;n<r;n++){t=131*t+e.charCodeAt(n)&2147483647}return t}(e);return 16<i.length&&(i=i.slice(0,16)),"wb"+t+"h"+i}},707:function(e,t,n){"use strict";var r=n(708).Base64,o=n(285);function i(e){if(!e||"string"!=typeof e||e.length<=1)return"";var t=e.slice(1);return t=function(u){var e=function(){var e=u.length;if(e<4)return[];if(e<11)return[0,2];for(var t=Math.min(4,Math.ceil(e/10)),n="",r=e-1;e-1-t<r;r--){var o=u.charCodeAt(r);n+=parseInt(o.toString(2),4)}for(var i=e-t-2,a=i.toString().length,s=[],c=0;s.length<10&&c+a<n.length;c+=a){var l=parseInt(n.slice(c,c+a));s.push(l%i),l=parseInt(n.slice(c+1,c+1+a)),s.push(l%i)}return s}();return function(e,t){for(var n=e.split(""),r=t.length-1;0<=r;r-=2)for(var o=1;0<=o;o--){var i=n[t[r]+o];n[t[r]+o]=n[t[r-1]+o],n[t[r-1]+o]=i}return n.join("")}(u,e)}(t),t=r.decode(t)}e.exports={chk:function(e){if(!e||e.length<=32)return e;var t=e.slice(0,32),n=e.slice(32);return t===o.createHash("md5").update(n).digest("hex").toUpperCase()?n:""},dT:function(e){return e&&0!==e.length?i(e):""},dH:function(e){return e&&0!==e.length?i(e):""},dS:function(e){return e&&0!==e.length?i(e):""}}},709:function(e,t,n){"use strict";var r,o=n(277),R=(r=o)&&r.__esModule?r:{default:r};var i=n(282),a=void 0,s=[],c=[];function m(e){for(var t=e.srcPos,n=0,r=0;r<c.length;r++){var o=c[r];if(e.srcPos>=n&&e.srcPos<n+o.contentLength){t+=o.indexInFullHtml-n;break}n+=o.contentLength}return t}function l(e){if(!e||"string"!=typeof e)return"";for(var t=e.split(/\n/),n=[],r=-1,o=0,i=t.length;o<i;o++){var a=t[o],s=a.trim();r+=1,0<s.length&&n.push({content:s,offset:r+a.indexOf(s)}),r+=a.length}for(var c="",l=0,u=n.length;l<u;l++){var d=n[l];c+='<p class="chapterContent_p" data-wr-co="'+d.offset+'">'+C(d.content,0,d.content.length,d.offset)+"</p>"}return c}function k(e,t,n){for(var r=e.slice(t,n),o=new RegExp("[0-9]+","g"),i=0,a=o.exec(r),s=[];a;){if(0<a.length){for(var c=a.index,l=a[0].length;i<c;){var u=k(e,t+i,t+c);s.push.apply(s,(0,R.default)(u)),i+=u.reduce(function(e,t){return e+t})}s.push(l),i=c+l}a=o.exec(r)}if(0<s.length)return s;for(var d=new RegExp("[A-Za-z]+","g"),h=0,f=d.exec(r),p=[];f;){if(0<f.length){var g=f[0].length,_=f.index,v=_,m=g;for(h<=_-1&&"&"===r.charAt(_-1)&&";"===r.charAt(_+g)&&(v=_-1,m=g+2);h<v;){var C=k(e,t+h,t+v);p.push.apply(p,(0,R.default)(C)),h+=C.reduce(function(e,t){return e+t})}p.push(m),h=v+m}f=d.exec(r)}if(0<p.length)return p;for(var b=new Array(n-t),E=0;E<b.length;E++)b[E]=1;return b}function C(t,n,e,r){var o=t.slice(n,e);if(function(e){return 0===(e=e.trim().replace(/&nbsp;/g,"")).length||u.test(e)}(o))return o;for(var i="",a=n;a<e;){k(t,a,e).forEach(function(e){i+='<span data-wr-id="layout" data-wr-co="%%OFFSET%%">'.replace("%%OFFSET%%",r+a-n)+t.slice(a,a+e)+"</span>",a+=e})}return i}var u=/^\s*$/;e.exports={parse:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(-1===e.indexOf("<body"))return l(e);a=a||function(){var e=["class"],t={whiteList:{body:e.concat(["class","style"]),a:e.concat(["target","href","title"]),abbr:e.concat(["title"]),address:e,area:e.concat(["shape","coords","href","alt"]),article:e,aside:e,audio:e.concat(["autoplay","controls","loop","preload","src"]),b:e,bdi:e.concat(["dir"]),bdo:e.concat(["dir"]),big:e,blockquote:e.concat(["cite"]),br:e,caption:e,center:e,cite:e,code:e,col:e.concat(["align","valign","span","width"]),colgroup:e.concat(["align","valign","span","width"]),dd:e,del:e.concat(["datetime"]),details:e.concat(["open"]),div:e,dl:e,dt:e,em:e,font:e.concat(["color","size","face"]),footer:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,header:e,hr:e,i:e,img:e.concat(["src","alt","title","width","height","data-w","data-ratio"]),ins:e.concat(["datetime"]),li:e,mark:e,nav:e,ol:e,p:e,pre:e,s:e,section:e,small:e,span:e,sub:e,sup:e,strong:e,table:e.concat(["width","border","align","valign"]),tbody:e.concat(["align","valign"]),td:e.concat(["width","rowspan","colspan","align","valign"]),tfoot:e.concat(["align","valign"]),th:e.concat(["width","rowspan","colspan","align","valign"]),thead:e.concat(["align","valign"]),tr:e.concat(["rowspan","align","valign"]),tt:e,u:e,ul:e,video:e.concat(["autoplay","controls","loop","preload","src","height","width"])},onTag:function(e,t,n){n.isWhite&&s.push({tag:e,srcHtml:t,isClosing:n.isClosing,pos:n.position,srcPos:n.sourcePosition})},onIgnoreTag:function(e,t,n){return n.isClosing||console.log("[chantlog] readerHtmlParser-onIgnoreTag",t),""},onIgnoreTagAttr:function(e,t,n){if("style"===t)return'style="'+n+'"'},safeAttrValue:function(e,t,n,r){var o=i.safeAttrValue(e,t,n,r);return"video"===e&&"src"===t&&""===o&&0===n.indexOf("../")?n:o}};return new i.FilterXSS(t)}();var n=function(e){var t={allContentMerged:"",contentLengthAndIndex:[]};if(!e||0===e.length)return t;for(var n=/<body[^>]*>\s*([\s\S]*?)\s*<\/body>/g,r=n.exec(e);r;){if(r&&2===r.length){var o=r[0],i=r.index;t.allContentMerged=t.allContentMerged+o,t.contentLengthAndIndex.push({contentLength:o.length,indexInFullHtml:i})}r=n.exec(e)}return t}(e);return e=n.allContentMerged,c=n.contentLengthAndIndex,s.length=0,e=function(e,t){for(var n="",r=0,o=/<body[^>]*>/g,i=/class="([^"]+)">/,a=o.exec(e);a;){if(1===a.length){var s=a[0],c=a.index,l=c+s.length,u=-1!==s.indexOf("background-image");if(!u){var d=i.exec(s);if(d&&2===d.length)for(var h=d[1].split(" "),f=0,p=h.length;f<p;f++){var g=h[f],_=t.indexOf(g);if(-1!==_){var v=t.indexOf("{",_);if(-1!==v){var m=t.indexOf("}",v);if(-1!==m)if(-1!==t.slice(v,m).indexOf("background-image")){u=!0;break}}}}}n+=e.slice(r,c),n+=u?s.replace("<body",'<div data-wr-bd="1" data-wr-inset="1"'):s.replace("<body",'<div data-wr-bd="1"'),r=l}a=o.exec(e)}return r<e.length&&(n+=e.slice(r)),n}(e=function(h,f){if(!h||0===h.length)return h;for(var p="",g=0,_=0,v=0,e=function(){var t=f[v];if(t.isClosing){_=h.indexOf(">",t.pos)+1,p+=h.slice(g,_),g=_;var e=v+1<f.length?f[v+1]:void 0;if(e){var n=e.pos,r=m(t)+t.srcHtml.length;p+=C(h,g,n,r),g=n}v++}else{var o=t.pos+1+t.tag.length;p+=h.slice(g,o);var i=m(t);p+=' data-wr-co="'+i+'"',g=o;var a=h.indexOf(">",t.pos)+1;if(p+=h.slice(g,a),g=a,"pre"===t.tag){var s=function(e,t,n){if(n>=e.length)return-1;for(var r=n;r<e.length;r++)if(t(e[r]))return r;return-1}(f,function(e){return e.tag===t.tag&&e.isClosing},v);if(-1!==s){var c=f[s];p+=h.slice(g,c.pos),g=c.pos,v=s+1}else v++}else{var l=v+1<f.length?f[v+1]:void 0;if(l){var u=l.pos,d=i+t.srcHtml.length;p+=C(h,g,u,d),g=u}v++}}};v<f.length;)e();return g<h.length&&(p+=h.slice(g)),p}(e=a.process(e),s),t)},parseTxt:l}},710:function(e,t,n){"use strict";e.exports={parse:function(e){return e&&0!==e.length?e=e.replace(/font-family:([^;]*?);/g,'font-family:$1,"PingFang SC", -apple-system, "SF UI Text",  "Lucida Grande", STheiti, "Microsoft YaHei", sans-serif;'):e}}},711:function(e,t,n){"use strict";n.r(t);var r=n(815),o=n(574);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},712:function(e,t,n){"use strict";n.r(t);var r=n(823),o=n(576);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(714);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},714:function(e,t,n){"use strict";var r=n(578);n.n(r).a},715:function(e,t,n){"use strict";n.r(t);var r=n(818),o=n(579);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(716);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},716:function(e,t,n){"use strict";var r=n(581);n.n(r).a},717:function(e,t,n){"use strict";n.r(t);var r=n(820),o=n(582);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(722);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},718:function(e,t,n){"use strict";var r=n(586);n.n(r).a},719:function(e,t,n){"use strict";var r=n(589);n.n(r).a},720:function(e,t,n){"use strict";var r=n(592);n.n(r).a},721:function(e,t,n){"use strict";var r=n(595);n.n(r).a},722:function(e,t,n){"use strict";var r=n(596);n.n(r).a},723:function(e,t,n){"use strict";n.r(t);var r=n(822),o=n(597);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(724);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},724:function(e,t,n){"use strict";var r=n(599);n.n(r).a},725:function(e,t,n){"use strict";n.r(t);var r=n(821),o=n(600);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(726);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},726:function(e,t,n){"use strict";var r=n(602);n.n(r).a},727:function(e,t,n){"use strict";n.r(t);var r=n(819),o=n(603);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(728);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},728:function(e,t,n){"use strict";var r=n(605);n.n(r).a},729:function(e,t,n){"use strict";n.r(t);var r=n(817),o=n(606);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(730);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},730:function(e,t,n){"use strict";var r=n(608);n.n(r).a},731:function(e,t,n){"use strict";n.r(t);var r=n(816),o=n(609);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(732);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},732:function(e,t,n){"use strict";var r=n(611);n.n(r).a},733:function(e,t,n){"use strict";n.r(t);var r=n(814),o=n(612);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(734);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},734:function(e,t,n){"use strict";var r=n(614);n.n(r).a},735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(26)),o=i(n(736));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var t=new(r.default.extend(o.default))({});r.default.prototype.$footerNote=t,r.default.prototype.$showFooterNote=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};t.$el&&t.$el.parentNode||(t.$mount(document.createElement("div")),document.body.appendChild(t.$el)),t.show(e)}}},736:function(e,t,n){"use strict";n.r(t);var r=n(824),o=n(615);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(737);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},737:function(e,t,n){"use strict";var r=n(617);n.n(r).a},738:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(26)),o=i(n(739));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var t=new(r.default.extend(o.default))({});r.default.prototype.$showReceiveMCardSuccessDialog=function(e){t.$el&&t.$el.parentNode||(t.$mount(document.createElement("div")),document.body.appendChild(t.$el)),t.showDialog(e),t.beginToLoadQrCode()}}},739:function(e,t,n){"use strict";n.r(t);var r=n(826),o=n(618);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(740);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},740:function(e,t,n){"use strict";var r=n(620);n.n(r).a},746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(26)),o=i(n(747));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var t=new(r.default.extend(o.default))({});r.default.prototype.$showSelectionToolBar=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};t.$el||t.$mount(document.createElement("div")),t.$el.parentNode&&t.$el.parentNode!==e.parentNode&&t.$el.parentNode.removeChild(t.$el),t.$el.parentNode||e.parentNode.appendChild(t.$el),t.show(e)},r.default.prototype.$hideSelectionToolBar=function(){t.hide()}}},747:function(e,t,n){"use strict";n.r(t);var r=n(829),o=n(631);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(748);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},748:function(e,t,n){"use strict";var r=n(633);n.n(r).a},749:function(e,t,n){"use strict";n.r(t);var r=n(811),o=n(634);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(750);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},750:function(e,t,n){"use strict";var r=n(636);n.n(r).a},751:function(e,t,n){"use strict";var k=r(n(752)),T=r(n(753));function r(e){return e&&e.__esModule?e:{default:e}}var u=n(7),m=n(22);function C(e){var t=e.node,n=e.nodeName;return u.inDevelopment()?!("span"!==n||!t.getAttribute("data-wr-footernote"))||("img"===n||"pre"===n||"video"===n||"audio"===n||"table"===n||"ul"===n||"ol"===n||"hr"===n):!("span"!==n||!t.getAttribute("data-wr-footernote"))||("img"===n||"pre"===n||"video"===n||"hr"===n)}function S(){return"wr"+Math.random().toString(36).slice(2)}function I(e){return window.getComputedStyle(e,null)}function b(e,t,n,r,o){var i=function(e){return{node:e,nodeName:e.nodeName.toLowerCase(),nodeType:e.nodeType}}(e);if(function(e){return"style"!==e.nodeName&&e.nodeType===Node.ELEMENT_NODE}(i)){var a=function(e){var t=e.nodeName,n=e.node;if("style"===t||"hr"===t)return!1;if("span"===t&&"layout"===n.getAttribute("data-wr-id"))return!1;var r=n.getAttribute("id");return"preRenderContainer"!==r&&"preRenderContent"!==r}(i),s=function(e){return"div"===e.nodeName&&e.node.hasAttribute("data-wr-bd")}(i);if(a||s){var c=function(e,t,n){var r=e.node,o=I(r),i=k.default.getDecorationTagStyle(r,o);if(m.isEmpty(i)&&!t)return null;var a=new T.default(4),s=t?r.classList.toString():"",c=i.styleText||"",l=i.className||"";n.customStyle.push(c);var u=k.default.style.getLeft(e)+k.default.style.getTop(e)+k.default.style.getWidth(e)+k.default.style.getHeight(e);if(t){var d=r.getAttribute("style");l+=" wr_readerBackground_opacity",d&&0<d.length&&(u+=d)}return u=u.replace(/"/gi,"'"),a.id=S(),a._offset=r.getAttribute("data-wr-co"),a.html='<div class="wr_decoration'+(0<s.length?" "+s:"")+(0<l.length?" "+l:"")+'" style="'+u+'"></div>',a.text="",a.rect.x=k.default.style.getNodeOffsetLeftRaw(e),a.rect.y=k.default.style.getNodeOffsetTopRaw(e),a.rect.w=k.default.style.getNodeWidthRaw(e),a.rect.h=k.default.style.getNodeHeightRaw(e),a}(i,s,n);c&&n.decoration.push(c)}if(function(e){var t=e.nodeName;return("span"===t||"a"===t)&&"layout"===e.node.getAttribute("data-wr-id")}(i)){var l=+new Date,u=function(e,t,n,r){var o=new T.default(0),i=e.node,a=i.innerText||"";o.text=a;var s=+new Date,c=void 0,l=i.outerHTML;l=l.replace(/data-wr-co="([0-9]*)"/,""),o._offset=RegExp.$1||0,A&&(c=+new Date,D["4-html.replace(data-wr-co)"]+=c-s,s=c);var u=S();if(o.id=u,A&&(c=+new Date,D["5-getRandomId"]+=c-s,s=c),o.rect.x=i.offsetLeft,o.rect.y=i.offsetTop,o.rect.w=k.default.style.getNodeWidthRaw(e),o.rect.h=k.default.style.getNodeHeightRaw(e),A&&(c=+new Date,D["7-dom.getBoundingClientRect"]+=c-s,s=c),0===o.rect.w||0===o.rect.h)return null;var d=o.rect.bottom,h=d<w.canvasMaxHeight*w.canvasMaxCount;o.type=h?1:0;var f=function(e,t,n){if(e&&e.type===n&&e.text&&1===e.text.length&&1===t.length){var r=t.charCodeAt(0);if(19968<=r&&r<=40869){var o=e.text.charCodeAt(0);if(19968<=o&&o<=40869)return!0}}return!1}(r,a,o.type);if(h){if(f)o.font=r.font,o.colors=r.colors,A&&D["1-reuseCount"]++;else{var p=I(i);A&&(c=+new Date,D["0-dom.getComputedStyle"]+=c-s,s=c),o.font=k.default.style.getNodeFontRaw(e,p),o.colors=k.default.style.getNodeColorRaw(e,p,n),A&&(c=+new Date,D["1-styleManager.getCustomTagStyle"]+=c-s,s=c)}var g=Math.floor(d/w.canvasMaxHeight),_=t.canvasPositions[g]||{top:Number.MAX_VALUE,bottom:Number.MIN_VALUE};_.top=Math.min(o.rect.y,_.top),_.bottom=Math.max(d,_.bottom),t.canvasPositions[g]=_}else{if(f)o.className=r.className||"",A&&D["1-reuseCount"]++;else{var v=I(i);A&&(c=+new Date,D["0-dom.getComputedStyle"]+=c-s,s=c);var m=k.default.getCustomTagStyle(e,v,n);A&&(c=+new Date,D["1-styleManager.getCustomTagStyle"]+=c-s,s=c);var C=m.className||"";o.className=C;var b=m.styleText||"";0<b.length&&-1===y.indexOf(C)&&t.customStyle.push(b),0<C.length&&y.push(C),A&&(c=+new Date,D["3-customClassNames"]+=c-s,s=c)}var E=k.default.style.getLeft(e)+k.default.style.getTop(e)+k.default.style.getWidth(e);A&&(c=+new Date,D["2-styleManager.style.getLeft/getTop/getWidth"]+=c-s,s=c);var R='data-wr-id="'+u+'" class="wr_absolute'+(0<o.className.length?" "+o.className:"")+'" style="'+E+'"';l=l.replace(/data-wr-id="layout"/,R),o.html=l,A&&(c=+new Date,D["6-html.replace(data-wr-id)"]+=c-s,s=c)}return o}(i,n,r,o);if(A){var d=+new Date;E+=d-l}if(u)if(n.content.push(u),n.content.length<Math.floor(t/2))n.randomHtml.push(u.html);else{var h=Math.floor(Math.random()*n.content.length);n.randomHtml.splice(h,0,u.html)}return u}if(!C(i)&&e.childNodes)for(var f=e.childNodes||[],p=null,g=0,_=f.length;g<_;g++){p=b(f[g],t,n,r,p)}else{var v=function(e){if(C(e)){var t=new T.default(3);t.text="[插图]";var n=e.node,r=k.default.getOtherTagStyle(e),o=n.outerHTML;o=o.replace(/data-wr-co="([0-9]*)"/,""),t._offset=RegExp.$1||0,t.id=S();var i=e.nodeName;"img"===i&&(o.match(/style="(.*?)"/gi),r+=RegExp.$1||"");var a=o.indexOf("<"+i),s=o.indexOf("class="),c=o.indexOf(">"),l="img"===i?"wr_absolute wr_readerImage_opacity":"wr_absolute";if("video"===i)o='<div class="wr_absolute" style="'+r+'">'+(o=o.replace(/class="([^"]+?)"/i,'class="$1" style="" data-wr-id="'+t.id+'" '))+'<span class="wr_video_playButton">点击播放</span></div>';else if(a<s&&s<c){o=o.replace(/class="([^"]+?)"/i,'class="$1 '+l+'" style="'+r+'" data-wr-id="'+t.id+'" '),RegExp.$1&&-1!==RegExp.$1.indexOf("reader_footer_note")&&(t.type=2)}else{var u=new RegExp("<"+i,"i");o=o.replace(u,'$& class="'+l+'" style="'+r+'" data-wr-id="'+t.id+'" ')}t.html=o;var d=n.getBoundingClientRect();return t.rect.x=n.offsetLeft,t.rect.y=n.offsetTop,t.rect.w=d.width,t.rect.h=d.height,t}return null}(i);n&&(n.content.push(v),n.randomHtml.push(v.html))}}}var y=[],w={},A=u.inDevelopment(),E=0,D={"0-dom.getComputedStyle":0,"1-styleManager.getCustomTagStyle":0,"1-reuseCount":0,"2-styleManager.style.getLeft/getTop/getWidth":0,"3-customClassNames":0,"4-html.replace(data-wr-co)":0,"5-getRandomId":0,"6-html.replace(data-wr-id)":0,"7-dom.getBoundingClientRect":0};e.exports={collect:function(e,t){var n={rootHeight:0,randomHtml:[],content:[],decoration:[],customStyle:[],canvasPositions:[]};if(!e)return n;w=t;var r=e.innerHTML||"",o=e.getBoundingClientRect()||{},i=r.match(/data-wr-id/gi),a=i?i.length:0;u.inDevelopment()&&console.log("[reader-layout] span 大概个数 =",a,"总高度 =",o.height),y=[],n.rootHeight=o.height;var s=+new Date;if(A)for(var c in E=0,D)D[c]=0;if(b(e,a,n,document.body.classList.contains("wr_whiteTheme"),null),A){var l=+new Date;console.log("[reader-layout] 渲染遍历 DOM 时间 = ",l-s,"毫秒","timeForCustomNode=",E,"ts=",D)}return n}}},752:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(61)),r=o(n(19));function o(e){return e&&e.__esModule?e:{default:e}}var f=n(22),d=n(7),p=new r.default;function h(){return"ccn-"+Math.random().toString(36).slice(2)}function i(e){if(!e||-1===e.indexOf("#")||4!==e.length&&7!==e.length)return null;var t=b[e];if(t)return t;if(4===e.length){for(var n="#",r=1;r<4;r+=1)n+=e.slice(r,r+1).concat(e.slice(r,r+1));e=n}return t={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},b[e]=t}function g(e){var t=e.match(/\d{1,3}/g);if(!t||t.length<3)return null;var n=b[e];if(n)return n;var r=t[0]/255,o=t[1]/255,i=t[2]/255,a=Math.max(r,o,i),s=Math.min(r,o,i),c=void 0,l=void 0,u=(a+s)/2;if(a===s)c=l=0;else{var d=a-s;switch(l=.5<u?d/(2-a-s):d/(a+s),a){case r:c=(o-i)/d+(o<i?6:0);break;case o:c=(i-r)/d+2;break;case i:c=(r-o)/d+4}c/=6}return n={h:c,s:l,l:u},b[e]=n}function _(e,t,n){var r="hsl:"+e+"-"+t+"-"+n,o=b[r];if(o)return o;var i=void 0,a=void 0,s=void 0;if(0===t)i=a=s=n;else{var c=n<.5?n*(1+t):n+t-n*t,l=2*n-c;i=v(l,c,e+1/3),a=v(l,c,e),s=v(l,c,e-1/3)}return o={r:Math.floor(255*i),g:Math.floor(255*a),b:Math.floor(255*s)},b[r]=o}function v(e,t,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function m(e){if(!e||e.length<=0)return"";var t="inverse-color-"+e,n=b[t];if(n)return n;var r=g(e),o=r.s,i=r.h,a=r.l;return a=1-.4*a,o<=.3&&.7<a&&(a=.7),n=_(i,o,a),b[t]=n}function a(e){var t=e.boundingClientRect;return void 0===t&&(t=e.node.getBoundingClientRect(),e.boundingClientRect=t),t}var C={},b={},s=i("#D0D3D8"),c=i("#0D141E"),E="rgb("+s.r+", "+s.g+", "+s.b+")",R="rgb("+c.r+", "+c.g+", "+c.b+")",k={getNodeOffsetTopRaw:function(e){var t=e.nodeOffsetTop;void 0===t&&(t=e.node.offsetTop,e.nodeOffsetTop=t);return t},getNodeOffsetLeftRaw:function(e){var t=e.nodeOffsetLeft;void 0===t&&(t=e.node.offsetLeft,e.nodeOffsetLeft=t);return t},getNodeWidthRaw:function(e){var t=e.nodeWidth;void 0===t&&(t=a(e).width,e.nodeWidth=t);return t},getNodeHeightRaw:function(e){var t=e.nodeHeight;void 0===t&&(t=a(e).height,e.nodeHeight=t);return t},getNodeLineHeightRaw:function(e){return e.node.offsetHeight},getNodeFontRaw:function(e,t){var n="",r=t.font.replace(/"/gi,"'");if(0<r.length)n=r;else{var o=t.fontStyle,i=t.fontVariant,a=t.fontWeight,s=t.fontSize;n=o+" "+i+" "+a+" "+s+"/"+s+" "+t.fontFamily}var c=this.getNodeLineHeightRaw(e);return n=n.replace(/\/\s*[0-9.]+px/,"/"+c+"px")},getNodeColorRaw:function(e,t,n){var r={colorOnWhite:"",colorOnBlack:""},o=t.color;if(n&&o===R)r.colorOnWhite=o,r.colorOnBlack=E;else if(n||o!==E){var i=m(r.colorOnWhite=o);r.colorOnBlack="rgb("+i.r+", "+i.g+", "+i.b+")"}else r.colorOnWhite=R,r.colorOnBlack=o;return r},getTop:function(e){return"top:"+this.getNodeOffsetTopRaw(e)+"px;"},getLeft:function(e){return"left:"+this.getNodeOffsetLeftRaw(e)+"px;"},getWidth:function(e){return"width:"+this.getNodeWidthRaw(e)+"px;"},getHeight:function(e){return"height:"+this.getNodeHeightRaw(e)+"px;"},getLineHeight:function(e){return"line-height:"+this.getNodeLineHeightRaw(e)+"px;"},getComputedWidth:function(e){return"width:"+e.width+";"},getComputedHeight:function(e){return"height:"+e.height+";"},getFont:function(e){var t=e.font.replace(/"/gi,"'");if(0<t.length)return"font:"+t+";";var n=e.fontSize,r=e.fontFamily,o=e.fontWeight,i=e.fontStyle,a=[];return 0<n.length&&a.push("font-size:"+n+";"),0<r.length&&a.push("font-family:"+r+";"),0<o.length&&a.push("font-weight:"+o+";"),0<i.length&&a.push("font-style:"+i+";"),a.join("")},getBorder:function(o,e){var t=1<arguments.length&&void 0!==e&&e,n=[],r={};function i(e){return 0<e.length&&!f.startsWith(e,"0px")&&-1===e.indexOf("none")}function a(e){var t=o[e+"Width"],n=o[e+"Style"],r=o[e+"Color"];return i(t)&&i(n)&&i(r)?t+" "+n+" "+r:""}var s="Firefox"===p.getBrowser(),c=s?a("border"):o.border;if(i(c))n.push("border:"+c+";"),r.border=c;else{var l=s?a("borderTop"):o.borderTop,u=s?a("borderRight"):o.borderRight,d=s?a("borderBottom"):o.borderBottom,h=s?a("borderLeft"):o.borderLeft;i(l)&&(n.push("border-top:"+l+";"),r["border-top"]=l),i(u)&&(n.push("border-right:"+u+";"),r["border-right"]=u),i(d)&&(n.push("border-bottom:"+d+";"),r["border-bottom"]=d),i(h)&&(n.push("border-left:"+h+";"),r["border-left"]=h)}return t?r:n.join("")},getBorderWidth:function(e){var t=e.borderWidth;return 0<t.length&&"0px"!==t?t:""},getRadius:function(e,t){var n=1<arguments.length&&void 0!==t&&t,r=e.borderRadius;return 0<r.length&&"0px"!==r?n?{"border-radius":r}:"border-radius:"+r+";":""},getBackground:function(e,t){var n=1<arguments.length&&void 0!==t&&t,r=[],o={},i=e.backgroundColor;return 0<i.length&&-1===i.indexOf("rgba(0, 0, 0, 0)")&&(r.push("background-color:"+i+";"),o["background-color"]=i),n?o:r.join("")}};t.default={style:k,getCustomTagStyle:function(e,t,n){var r={};if(t){var o=[];o.push(k.getFont(t)),o.push(k.getHeight(e)),o.push(k.getLineHeight(e));var i=t.color;i=n?i!==R?(o.push("color:"+i+";"),"color:"+i+";"):"":i!==E?(o.push("color:"+i+";"),"color:"+i+";"):"";var a=o.join(""),s=C[a];if(s)return s;r.className=h();var c="";if(0<i.length){var l=m(i);c="color:rgb("+l.r+", "+l.g+", "+l.b+");"}r.styleText="\n                .readerChapterContent ."+r.className+" {\n                    "+a+"\n                    "+c+"\n                 }\n                 .wr_whiteTheme .readerChapterContent ."+r.className+" {\n                      "+i+"\n                 }",C[a]={className:r.className,styleText:r.styleText}}return r},getOtherTagStyle:function(e){var t=[],n=e.nodeName;if("img"===n);else if("pre"===n){var r=getComputedStyle(e.node),o=k.getComputedWidth(r),i=k.getComputedHeight(r);0<o.length&&t.push(o),0<i.length&&t.push(i)}else if("hr"===n){t.push("margin:0;");var a=k.getWidth(e);0<a.length&&t.push(a)}else if("span"===n){var s=k.getWidth(e),c=k.getHeight(e);0<s.length&&t.push(s),0<c.length&&t.push(c)}else if("video"===n){var l=k.getWidth(e),u=k.getHeight(e);0<l.length&&t.push(l),0<u.length&&t.push(u)}else d.inDevelopment()&&(console.log("[zhoonlog] getOtherTagStyle inValid nodeName = ",n),alert("找 zhoon 看看 - getOtherTagStyle inValid nodeName = "+n));return t.push(k.getLeft(e)),t.push(k.getTop(e)),t.join("")},getDecorationTagStyle:function(e,t){var n={};if(t){var r=k.getBorder(t,!0),o=k.getBackground(t,!0);if(f.isEmpty(r)&&f.isEmpty(o))return{};var i=[k.getBorder(t),k.getBackground(t)].join(""),a=C[i];if(a)return a;n.className=h();var s="";f.isEmpty(o)||(0,u.default)(o).forEach(function(e){var t=function(e,t){if(!e||e.length<=0||"transparent"===e)return"";var n="inverse-background-"+e,r=b[n];if(r)return r;e.match(/,[^,]?([0]?\.[0-9]+)/gi);var o=RegExp.$1,i=g(e),a=i.s;return(r=_(i.h,a,t)).alpha=o,b[n]=r}(o[e],.1),n=!!t.alpha;s+=e+(n?":rgba("+t.r+", "+t.g+", "+t.b+", "+t.alpha+");":":rgb("+t.r+", "+t.g+", "+t.b+");")});var c=k.getRadius(t)+k.getBorder(t),l=k.getBorder(t)+k.getBackground(t)+k.getRadius(t);n.styleText="\n                .readerChapterContent ."+n.className+" {\n                    "+c+"\n                    "+s+"\n                 }\n                 .wr_whiteTheme .readerChapterContent ."+n.className+" {\n                    "+l+"\n                 }",C[i]={className:n.className,styleText:n.styleText}}return n}}},753:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(193)),o=a(n(194)),i=a(n(677));function a(e){return e&&e.__esModule?e:{default:e}}var s=((0,o.default)(c,[{key:"isTextOrCanvasType",value:function(){return 0===this.type||1===this.type}},{key:"getOffset",value:function(){return parseInt(this._offset)}},{key:"isHighLight",value:function(){return 1==(1&this.attr)}},{key:"setHighLight",value:function(e){e?this.attr|=1:this.attr&=-2}}]),c);function c(e){(0,r.default)(this,c),this.id=0,this.type=e,this.attr=0,this._offset="0",this.text="",this.rect=new i.default(0,0,0,0),this.html="",this.className="",this.colors={colorOnWhite:"",colorOnBlack:""},this.font=""}t.default=s},754:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BookMarkTypeBookMark=0,t.BookMarkTypeUnderline=1},755:function(e,t,n){"use strict";n.r(t);var r=n(809),o=n(637);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(756);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},756:function(e,t,n){"use strict";var r=n(639);n.n(r).a},757:function(e,t,n){"use strict";n.r(t);var r=n(807),o=n(640);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n(758);var a=n(3),s=Object(a.a)(o.default,r.a,r.b,!1,null,null,null);t.default=s.exports},758:function(e,t,n){"use strict";var r=n(642);n.n(r).a},760:function(e,t,n){"use strict";var r=n(643);n.n(r).a},796:function(e,t,n){"use strict";function r(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"readerContent"},[r("div",{ref:"appContent",staticClass:"app_content",on:{mousedown:n.onContentMouseDown,mousemove:n.onContentMouseMove,mouseup:n.onContentMouseUp}},[n.isShowReaderTopBar?r("reader-top-bar",{ref:"reader_top_bar",attrs:{"book-info":n.bookInfo,"current-chapter":n.currentChapter,"is-show-add-shelf":n.isShowTopBarAddShelfButton},on:{onClickItem:n.handleClickTopBarItem}}):n._e(),!n.isShowReaderTopBar||n.isFromWeReadApp?r("reader-book-info",{attrs:{"book-info":n.bookInfo,"chapter-infos":n.chapterInfos,"reading-stat":n.readingStat,"show-add-shelf-button":n.showFirstPageAddShelfButton},on:{clickStartReading:n.handleClickStartReading,clickAddShelf:n.handleClickShelfButtonInBookInfo,clickDownloadApp:n.downloadAppToRead,clickRatingButton:n.handleClickRatingButton,clickShowCatalog:n.showCatalog}}):n._e(),n.displayTopTotalReviewList&&0<n.displayTopTotalReviewList.length&&!n.isShowReaderTopBar?r("ReaderTopReviews",{staticClass:"reader_bookReviewList",attrs:{"book-id":n.bookId,"review-list":n.displayTopTotalReviewList},on:{"emit-book-review-click":n.handleTopWriteReviewClickEvent}}):n._e(),n.hasCurrentChapter?r("div",{class:["readerChapterContent","fontLevel"+n.fontSizeLevel,{navBarOffset:n.isShowReaderTopBar&&!n.isFromWeReadApp}]},[n.isShowLoading?r("div",{staticClass:"readerChapterContentLoading"},[r("loading",{attrs:{zoom:"0.3"}})],1):n._e(),n.isShowLoading||n.isEpub?n._e():r("div",{staticClass:"chapterTitle"},[n._v("\n                "+n._s(n.chapterTitleText)+"\n            ")]),n.isShowPreRender?r("div",{key:"preRenderContainer",ref:"preRenderContainer",staticClass:"preRenderContainer"},[n.isEpub&&n.chapterContentStyles?r("CustomStyle",[n._v("\n                    "+n._s(n.chapterContentStyles)+"\n                ")]):n._e(),r("div",{staticClass:"preRenderContent",attrs:{id:"preRenderContent"},domProps:{innerHTML:n._s(n.chapterContentForEPub)}})],1):n._e(),r("div",{key:"renderTargetContainerSibling",ref:"renderTargetContainerSibling"}),n.isShowLoading?n._e():r("div",{key:"renderTargetContainer",ref:"renderTargetContainer",class:["renderTargetContainer",{renderTargetContainer_needPay:n.isNeedPay}]},[r("div",{key:"chapterContentHighLightBgHtml",domProps:{innerHTML:n._s(n.chapterContentHighLightBgHtml)}}),r("div",{key:"renderTargetCanvasContainer",ref:"renderTargetCanvasContainer",staticClass:"wr_canvasContainer",domProps:{innerHTML:n._s(n.chapterContentTargetCanvasHtml)}}),n.isEpub&&n.chapterContentStyles?r("CustomStyle",[n._v("\n                    "+n._s(n.chapterContentStyles)+"\n                ")]):n._e(),r("div",{ref:"renderTargetContent",staticClass:"renderTargetContent",attrs:{id:"renderTargetContent"},domProps:{innerHTML:n._s(n.chapterContentTargetHtml)}}),r("div",{key:"chapterContentSelection",domProps:{innerHTML:n._s(n.chapterContentSelectionHtml)}}),n.isNeedShowNyNote?r("div",{key:"underline"},n._l(n.underlineRenderDatas,function(t){return r("div",{key:t.id,class:t.classNames,style:t.rect.toCSSPositionString(),on:{click:function(e){return e.stopPropagation(),n.handleClickUnderline(t)}}})}),0):n._e()],1)]):n._e(),!n.hasCurrentChapter||n.isChapterContentDirty||n.isShowLoading?n._e():r("div",{staticClass:"readerFooter"},[n.isNeedPay&&n.isSoldOut?r("div",{staticClass:"readerFooter_desc"},[n._v("\n                本书已下架"),r("br"),n._v("部分内容不再支持购买和阅读\n            ")]):n.isPhone?r("div",[n.isNeedPay?r("a",{class:["readerFooter_button","readerFooter_button_twoLines",{blue:n.payButtonDisplayInfos.isMCard}],attrs:{href:"javascript:"},on:{click:n.showPayDialog}},[r("span",{class:["line1",{withIcon:n.payButtonDisplayInfos.isMCard}],domProps:{innerHTML:n._s(n.payButtonDisplayInfos.lines[0])}}),1<n.payButtonDisplayInfos.lines.length?r("span",{staticClass:"line2",domProps:{innerHTML:n._s(n.payButtonDisplayInfos.lines[1])}}):n._e()]):n._e(),!n.isNeedPay&&n.hasNextChapter?r("a",{staticClass:"readerFooter_button",attrs:{title:"下一章",href:"javascript:"},on:{click:n.handleClickNextChapter}},[n._v("\n                    下一章\n                ")]):n._e(),r("a",{staticClass:"readerFooter_button blue",attrs:{href:"javascript:"},on:{click:n.downloadAppToRead}},[n._v("\n                    去微信读书 App 阅读本书\n                ")])]):r("div",[n.isNeedPay&&n.hasLogin&&n.canReceiveMemberCard?r("a",{staticClass:"readerFooter_button readerFooter_button_twoLines blue",attrs:{href:"javascript:"},on:{click:n.handleClickReceiveMemberCardButton}},[r("span",{staticClass:"line1 withIcon"},[n._v("送你一张无限卡 · 全场书籍免费读")])]):n._e(),n.isShowBuyMemberCardButton?r("a",{staticClass:"readerFooter_button readerFooter_button_twoLines blue",attrs:{href:"javascript:"},on:{click:n.downloadAppToMemberCard}},[r("span",{staticClass:"line1 withIcon"},[n._v(n._s(n.buyMemberCardButtonLine1))])]):n._e(),n.isNeedPay&&n.hasLogin&&!n.canReceiveMemberCard?r("a",{class:["readerFooter_button","readerFooter_button_twoLines",{blue:n.payButtonDisplayInfos.isMCard}],attrs:{href:"javascript:"},on:{click:n.showPayDialog}},[r("span",{class:["line1",{withIcon:n.payButtonDisplayInfos.isMCard}],domProps:{innerHTML:n._s(n.payButtonDisplayInfos.lines[0])}}),1<n.payButtonDisplayInfos.lines.length?r("span",{staticClass:"line2",domProps:{innerHTML:n._s(n.payButtonDisplayInfos.lines[1])}}):n._e()]):n._e(),n.isNeedShowLoginGuide?r("reader-login-guide",{ref:"readerLoginGuide",attrs:{"qr-code-img":n.loginGuideQRCodeImg,"get-uid-err":n.isLoginGetUidError,"get-info-err":n.isLoginGetInfoError,"loading-q-r-code":n.isLoginQRCodeLoading},on:{reload:n.checkIfNeedRequestLoginQRCode}}):n._e(),n.hasNextChapter?r("a",{staticClass:"readerFooter_button",attrs:{title:"下一章",href:"javascript:"},on:{click:n.handleClickNextChapter}},[n._v("\n                    下一章\n                ")]):n._e(),n.hasLogin&&!n.hasNextChapter?r("div",{staticClass:"readerFooter_ending"},[r("div",{staticClass:"line1"},[n._v(n._s(n.endingTexts[0]))]),1<n.endingTexts.length?r("div",{staticClass:"line2"},[n._v(n._s(n.endingTexts[1]))]):n._e()]):n._e()],1)])],1),r("reader-controls",{ref:"readerControls",staticClass:"readerControls",attrs:{"disable-chapter-link":n.isBookInfoError,"is-show-search-hint":n.isShowAutoSearchHint,"search-hint-total-count":n.searchResult.totalCount||0,"disable-font-size-slider":"DONE"!==n.chapterContentState,"init-font-size-level":n.fontSizeLevel,"font-size-level-count":n.fontSizeLevelCount},on:{onClickItem:n.handleClickControls,fontSizeLevelChange:n.changeFontSize}}),r("reader-bottom-bar",{class:n.isPhoneBottomBarActive?"active":"",attrs:{"show-shadow":!n.isShowBottomSettingPanel,"show-add-shelf-button":n.showBottomBarAddShelfButton},on:{onClickItem:n.handleClickBottomBarItem}}),n.isShowBottomSettingPanel?r("reader-bottom-setting-panel",{on:{onClickItem:n.handleClickBottomSettingPanelItem}}):n._e(),r("reader-member-card-tips",{ref:"readerMemberCardTips",class:n.isPhoneBottomBarActive?"":"atBottom"}),r("reader-catalog",{ref:"readerCatalog",attrs:{"book-info":n.bookInfo,"member-card-summary":n.memberCardSummary,"chapter-infos":n.chapterInfos,"current-chapter":n.currentChapter,"is-in-search-mode":n.isInSearchMode,"is-search-loading":n.isSearchLoading,"search-result":n.searchResult},on:{clickChapter:n.handleClickChapter,clickBookInfo:n.handleClickFirstChapter,search:n.doSearch,clickSearchItem:n.handleClickSearchItem,enterSearch:n.enterSearch,exitSearch:n.exitSearch}}),r("reader-note-panel",{ref:"readerNotePanel",attrs:{"book-info":n.bookInfo,"chapter-infos":n.chapterInfos,bookmarks:n.bookmarks},on:{clickNoteItem:n.handleClickNoteItem}}),n.isShowPayWholeDialog?r("pay-whole-book-dialog",{ref:"payWholeBookDialog",attrs:{"book-info":n.bookInfo,"member-card-summary":n.memberCardSummary,balance:n.balance},on:{doPay:n.payWholeBook}}):n._e(),n.isShowPayChapterDialog?r("pay-chapter-dialog",{ref:"payChapterDialog",attrs:{"book-info":n.bookInfo,chapters:n.chapterInfos,"member-card-summary":n.memberCardSummary,balance:n.balance},on:{doPay:n.payChapter}}):n._e()],1)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},807:function(e,t,n){"use strict";function r(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",[r("BackgroundMask",{ref:"mask",attrs:{"needs-close-button":!1},on:{click:n.close}}),r("transition",{attrs:{name:"fade"},on:{enter:n.onShow}},[r("div",{directives:[{name:"show",rawName:"v-show",value:n.isShow,expression:"isShow"}],staticClass:"readerNotePanel"},[r("div",{staticClass:"readerNoteList"},[n._l(n.bookmarkList,function(t){return r("reader-panel-section-list-item",{key:t.bookmarkId,attrs:{"divider-left-indent":!0,"show-section-title":t.firstInChapter,"section-title":n.getNoteItemChapterTitle(t),"custom-content-class":"noteItem_content"},on:{clickItem:function(e){return n.emitClickNoteItem(t)}}},[r("span",{staticClass:"icon"}),r("div",{staticClass:"text"},[n._v(n._s(t.markText))])])}),n.isLoading?r("reader-panel-list-loading-view"):n._e(),n.isLoading||0!==n.bookmarkList.length?n._e():r("reader-panel-list-empty-view",[n._v("\n                    暂无划线\n                ")])],2)])])],1)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},809:function(e,t,n){"use strict";function r(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"reader_topReview_contianer"},[r("div",{staticClass:"reader_topReview_header"},[r("p",{staticClass:"reader_topReview_title"},[n._v("精彩点评")]),r("ReviewStarControl",{staticClass:"reader_topReview_starControl",attrs:{title:"为此书评分","title-align":"right","init-score":0},on:{"emit-review-star-click":n.handleBookReviewClick}})],1),r("div",{staticClass:"reader_topReview_content"},n._l(n.reviewList,function(e,t){return r("div",{key:t,staticClass:"reader_topReview_item"},[r("div",{staticClass:"title"},[r("Avatar",{attrs:{clickable:!1,src:e.review.author.avatar,"custom-selector":"avatar"}}),r("span",{staticClass:"name"},[n._v(n._s(e.review.author.name))]),r("span",{staticClass:"action"},[n._v("点评")]),0<e.review.star?r("RankBar",{staticClass:"star",attrs:{star:e.review.star,"custom-selector":"wr_rankBar_Small"}}):n._e()],1),e.review.content&&0<e.review.content.length?r("p",{ref:"content",refInFor:!0,staticClass:"content content_Normal",on:{click:function(e){return n.handleContentClick(t)}}},[n._v(n._s(e.review.content))]):n._e()])}),0),r("div",{staticClass:"reader_topReview_footer"},[r("a",{staticClass:"reader_topReview_more",attrs:{href:n.bookReviewURL(n.bookId)},on:{click:function(e){return n.saveReportInfo("Reader_TopReview_MoreReviews_Clk")}}},[n._v("查看更多精彩评论")])])])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},811:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"},on:{enter:e.onShow}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showing,expression:"showing"}],class:["readerMemberCardTips",e.customSelector]},[n("span",{staticClass:"icon"}),n("span",{staticClass:"text"},[e._v(e._s(e.text))])])])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},814:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"readerLoginGuide"},[n("div",{staticClass:"readerLoginGuide_qrcode"},[e.loadingQRCode?n("div",{staticClass:"readerLoginGuide_qrcode_loading"},[n("Loading",{attrs:{zoom:"0.4"}})],1):e.getUidErr||e.getInfoErr?n("a",{staticClass:"readerLoginGuide_qrcode_retry",attrs:{href:"javascript:"},on:{click:e.emitReload}},[e._v("\n            重新加载\n        ")]):n("img",{attrs:{src:e.qrCodeImg,alt:"扫码登录",width:"100",height:"100"}})]),e._m(0)])}var o=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"readerLoginGuide_right"},[t("div",{staticClass:"line1"},[this._v("扫码登录")]),t("div",{staticClass:"line2"},[this._v("获得更多专属福利 · 全场书籍免费读")])])}];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},815:function(e,t,n){"use strict";function r(){var e=this.$createElement;return(this._self._c||e)("style",{tag:"div"},[this._t("default")],2)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},816:function(e,t,n){"use strict";function r(){var c=this,e=c.$createElement,t=c._self._c||e;return t("Dialog",{ref:"dialog",attrs:{"is-show-close-button":!1,"custom-selector":"payChapterDialogWrap"},on:{onShow:c.onShow}},[t("div",{staticClass:"payChapterDialog"},[t("div",{staticClass:"pcd_title"},[t("div",{staticClass:"pcd_bookTitle"},[c._v("购买章节")]),t("a",{staticClass:"pcd_selectAll",attrs:{href:"javascript:"},on:{click:c.toggleAllSelect}},[c._v(c._s(c.isSelectedAll?"取消全选":"全选"))])]),t("div",{ref:"scrollDom",staticClass:"pcd_content"},[t("ul",{staticClass:"pcd_chapter_list"},c._l(c.sections,function(s){return t("li",{key:s.key},[t("div",{class:["pcd_chapter_item",{selectable:0<s.unpaidPrice,checked:c.isTitleChecked(s)}],on:{click:function(e){return c.toggleSection(s)}}},[t("span",{class:["pcd_chapter_item_arrow",{expand:s.isExpand}],on:{click:function(e){return e.stopPropagation(),c.toggleSectionExpand(s)}}}),t("div",{staticClass:"pcd_chapter_item_content"},[t("div",{staticClass:"line1"},[c._v(c._s(s.title))]),t("div",{staticClass:"line2"},[c._v(c._s(s.isAllPaid?"已购":0<s.totalPrice?s.unpaidPrice.toFixed(2)+" 书币":"免费"))])]),0<s.unpaidPrice?t("input",{staticClass:"pcd_chapter_item_checkbox",attrs:{type:"checkbox"},domProps:{checked:c.isTitleChecked(s)},on:{change:function(e){return c.changeTitleChecked(s,e)}}}):c._e(),0<s.unpaidPrice?t("label",{staticClass:"pcd_chapter_item_checkbox_label"}):c._e()]),s.isExpand?t("ul",{staticClass:"pcd_section_content"},c._l(s.chapters,function(a){return t("li",{key:a.chapterUid,class:["pcd_chapter_item",{checked:-1!==s.selected.indexOf(a.chapterUid)}],attrs:{id:a.chapterUid===c.initSelectedChapterUid?"pcd_chapter_current":""},on:{click:function(e){return c.toggleChapter(s,a)}}},[t("div",{staticClass:"pcd_chapter_item_content"},[t("div",{staticClass:"line1"},[c._v("第"+c._s(a.chapterIdx)+"章 "+c._s(a.title))]),t("div",{staticClass:"line2"},[c._v(c._s(0<a.price?a.price.toFixed(2)+" 书币":"免费")+"\n                                ")])]),1===a.paid?t("span",[c._v("已购")]):c._e(),1!==a.paid&&0<a.price?t("input",{directives:[{name:"model",rawName:"v-model",value:s.selected,expression:"section.selected"}],staticClass:"pcd_chapter_item_checkbox",attrs:{type:"checkbox"},domProps:{value:a.chapterUid,checked:Array.isArray(s.selected)?-1<c._i(s.selected,a.chapterUid):s.selected},on:{change:function(e){var t=s.selected,n=e.target,r=!!n.checked;if(Array.isArray(t)){var o=a.chapterUid,i=c._i(t,o);n.checked?i<0&&c.$set(s,"selected",t.concat([o])):-1<i&&c.$set(s,"selected",t.slice(0,i).concat(t.slice(i+1)))}else c.$set(s,"selected",r)}}}):c._e(),1!==a.paid&&0<a.price?t("label",{staticClass:"pcd_chapter_item_checkbox_label"}):c._e()])}),0):c._e()])}),0)]),t("div",{staticClass:"pcd_actions"},[t("div",{staticClass:"pcd_actions_item",staticStyle:{"margin-top":"16px"}},[t("span",[c._v("已选")]),t("span",{staticClass:"pcd_actions_item_white"},[t("span",{staticClass:"pcd_actions_item_number"},[c._v(c._s(c.selectedChaptersSize))]),c._v("章\n                ")])]),t("div",{staticClass:"pcd_actions_item"},[t("span",[c._v(c._s(c.priceTitleWithMCardDiscount))]),t("span",[c.hasMCardDiscount&&0<c.selectedChaptersPrice?t("span",{staticClass:"pcd_actions_item_number pcd_actions_item_disabled"},[c._v("\n                        "+c._s(c.selectedChaptersPrice.toFixed(2))+"\n                    ")]):c._e(),t("span",{staticClass:"pcd_actions_item_blue pcd_actions_item_number"},[c._v("\n                        "+c._s(c.selectedChaptersPriceWithDiscount.toFixed(2))+"\n                    ")]),t("span",{staticClass:"pcd_actions_item_blue"},[c._v("书币")])])]),t("a",{class:{pcd_actions_buy:!0,disabled:!c.isValid},attrs:{href:"javascript:"},on:{click:c.emitDoPay}},[c.isNeedDeposit?t("span",{staticClass:"line1"},[c._v("去微信读书 App 充值")]):t("span",{staticClass:"line1"},[c._v("购买章节")])]),c.isNeedDeposit?t("div",{staticClass:"pcd_actions_account red"},[c._v("余额不足 · "+c._s(c.accountBalance)+" 书币")]):c.balance.hasFetched?t("div",{staticClass:"pcd_actions_account"},[c._v("余额 · "+c._s(c.accountBalance)+" 书币")]):c._e()])])])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},817:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dialog",{ref:"dialog",attrs:{"is-show-close-button":!1,"custom-selector":"payWholeBookDialogWrap"}},[n("div",{staticClass:"payDialog"},[n("div",{staticClass:"payDialog_content"},[n("div",{staticClass:"payDialog_price"},[e._v(e._s(e.payInfos.dialogPriceText))]),n("div",{class:["payDialog_account",{red:e.payInfos.isNeedDeposit}]},[e._v(e._s(e.payInfos.dialogAccountBalance))]),n("div",{staticClass:"payDialog_sectionTitle"},[e._v("书籍")]),n("div",{staticClass:"payDialog_sectionContent"},[e._v(e._s(e.bookInfo.title))]),n("div",{staticClass:"payDialog_sectionTitle"},[e._v("作者")]),n("div",{staticClass:"payDialog_sectionContent"},[e._v(e._s(e.bookInfo.author))])]),n("div",{staticClass:"payDialog_actions"},[n("a",{staticClass:"payDialog_action",attrs:{href:"javascript:"},on:{click:e.emitDoPay}},[e._v(e._s(e.payInfos.dialogBuyButtonText))])])])])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},818:function(e,t,n){"use strict";function r(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"readerBookInfo"},[t.isEmptyBookInfo?t._e():n("div",{class:["readerBookInfo_head",{readerBookInfo_head_NoBookInfoMore:!t.showRating&&t.readingCount<=0}]},[n("book-cover",{attrs:{clickable:!0,src:t.bookInfo.cover||"","custom-selector":"bookInfo_cover","need-gradient-decor":!0},on:{click:t.emitClickStartReading}}),n("div",{staticClass:"bookInfo_right"},[n("h2",{staticClass:"bookInfo_title"},[t._v(t._s(t.bookInfo.title))]),n("div",{staticClass:"bookInfo_author_container"},[t.isSupportBook?n("a",{staticClass:"bookInfo_author link",attrs:{href:"/web/search/books?author="+encodeURIComponent(t.bookInfo.author)}},[t._v(t._s(t.bookInfo.author))]):n("span",{staticClass:"bookInfo_author"},[t._v(t._s(t.bookInfo.author))])]),t.needShowRankListImg?n("a",{class:["bookInfo_rankList",t.rankListCategoryClassName],attrs:{href:"/web/category/"+t.rankListCategoryId,target:"_blank"},on:{click:function(e){return t.saveReportInfo("ReaderInfo_Enter_Category")}}}):t._e(),0<t.introParaArray.length?n("div",{ref:"introDom",staticClass:"bookInfo_intro",on:{click:t.showIntroDialog}},[t._v("\n                "+t._s(t.introParaArray.join(" "))+"\n            ")]):t._e(),n("div",{class:{bookInfo_more:!0,bookInfo_more_2children:2===t.moreChildCount,bookInfo_more_3children:3===t.moreChildCount}},[t.showRating?n("div",{staticClass:"bookInfo_more_rating",on:{click:t.emitClickRatingButton}},[n("div",{staticClass:"bookInfo_more_line1"},[n("span",{staticClass:"bookInfo_more_line1_number"},[t._v(t._s(t.starString))]),n("rank-bar",{attrs:{star:t.bookInfo.star,"custom-selector":"bookInfo_score_rankBar"}})],1),n("div",{staticClass:"bookInfo_more_line2"},[t._v(t._s(t.ratingCountString)+"人点评")])]):t._e(),0<t.readingCount?n("div",{staticClass:"bookInfo_more_reading"},[n("div",{staticClass:"bookInfo_more_line1",domProps:{innerHTML:t._s(t.readingCountStrings[0])}}),n("div",{staticClass:"bookInfo_more_line2"},[t._v(t._s(t.readingCountStrings[1]))])]):t._e(),t.showAddShelfButton?n("a",{staticClass:"bookInfo_more_addShelf wr_btn wr_btn_Big",attrs:{href:"javascript:"},on:{click:t.emitClickAddShelf}},[t._v("加入书架")]):n("a",{staticClass:"bookInfo_more_addShelf wr_btn wr_btn_Big",attrs:{href:"javascript:"},on:{click:t.emitClickStartReading}},[t._v("开始阅读")])])])],1),t.chaptersToPreview&&0<t.chaptersToPreview.length?n("div",{staticClass:"readerBookInfo_chapterPreview"},[t._l(t.chaptersToPreview,function(e){return n("a",{staticClass:"item",attrs:{href:e.link}},[e.line1?n("div",{staticClass:"line1"},[t._v(t._s(e.line1))]):t._e(),e.line2?n("div",{class:{line2:!0,blue:e.isLine2Blue,title:e.isLine2Title}},[t._v(t._s(e.line2))]):t._e()])}),n("a",{staticClass:"item showAll",attrs:{href:"javascript:"},on:{click:t.emitClickShowCatalog}},[n("div",{staticClass:"line1"},[t._v("查看全部章节")]),n("div",{staticClass:"line2"},[t._v("共"+t._s(this.chapterInfos.length)+"章")])])],2):t._e(),t.canShowDownloadButton?n("a",{staticClass:"readerFooter_button blue",attrs:{href:"javascript:"},on:{click:t.emitDownloadApp}},[t._v("\n        去微信读书 App 阅读本书\n    ")]):t._e(),n("Dialog",{ref:"introDialog",attrs:{"custom-selector":"introDialogWrap"}},[n("div",{staticClass:"introDialog_content"},[0<t.introParaArray.length?n("h3",{staticClass:"introDialog_content_title"},[t._v("简介")]):t._e(),0<t.introParaArray.length?n("div",t._l(t.introParaArray,function(e){return n("p",{staticClass:"introDialog_content_intro_para"},[t._v(t._s(e))])}),0):t._e(),0<t.publishInfos.length?n("h3",{staticClass:"introDialog_content_title"},[t._v("版权")]):t._e(),t._l(t.publishInfos,function(e){return n("div",{class:{introDialog_content_pub_line:!0,long:t.isPublishInfoLong}},[n("span",{staticClass:"introDialog_content_pub_title"},[t._v(t._s(e.title))]),n("span",[t._v(t._s(e.content))])])})],2)])],1)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},819:function(e,t,n){"use strict";function r(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"readerBottomSettingPanel"},[n("div",{staticClass:"rbsp_inner"},[n("div",{staticClass:"rbsp_color"},[n("a",{class:["rbsp_color_item","white",{current:t.isWhiteTheme}],attrs:{href:"javascript:",title:"浅色模式"},on:{click:function(e){return t.emitClick("white")}}},[t._v("浅色模式")]),n("a",{class:["rbsp_color_item","dark",{current:!t.isWhiteTheme}],attrs:{href:"javascript:",title:"深色模式"},on:{click:function(e){return t.emitClick("dark")}}},[t._v("深色模式")])]),t.canShowDownload?n("a",{staticClass:"rbsp_download",attrs:{href:"javascript:"},on:{click:function(e){return t.emitClick("download")}}},[t._v("下载微信读书 App 使用更多功能")]):t._e()])])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},820:function(e,t,n){"use strict";function r(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",[r("BackgroundMask",{ref:"mask",attrs:{"needs-close-button":!1},on:{click:n.close}}),r("transition",{attrs:{name:"fade"},on:{enter:n.onShow}},[r("div",{directives:[{name:"show",rawName:"v-show",value:n.isShow,expression:"isShow"}],staticClass:"readerCatalog"},[r("div",{staticClass:"readerCatalog_searchBar"},[r("div",{staticClass:"readerCatalog_searchBar_left"},[r("input",{directives:[{name:"model",rawName:"v-model",value:n.searchKeyword,expression:"searchKeyword"}],attrs:{placeholder:"搜索",type:"text"},domProps:{value:n.searchKeyword},on:{keyup:function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"enter",13,e.key,"Enter")?null:n.debouncedDoSearch(e)},focus:n.handleInputFocused,input:function(e){e.target.composing||(n.searchKeyword=e.target.value)}}}),r("span",{staticClass:"readerCatalog_searchBar_enter",attrs:{title:"搜索"},on:{click:n.debouncedDoSearch}})]),n.isInSearchMode?r("span",{staticClass:"readerCatalog_searchCancel",on:{click:n.exitSearch}},[n._v("取消")]):n._e()]),n.isInSearchMode?r("div",{ref:"searchResultDom",staticClass:"rc_search"},[n._l(n.searchResult.resultList,function(t){return r("reader-panel-section-list-item",{key:t.searchIdx,attrs:{"show-section-title":t.firstInChapter,"section-title":n.getSearchResultChapterTitle(t),"custom-content-class":"rc_search_itemContent"},on:{clickItem:function(e){return n.emitClickSearchItem(t)}}},[r("span",{domProps:{innerHTML:n._s(n.getSearchResultChapterContent(t))}})])}),r("reader-panel-list-loading-view",{directives:[{name:"show",rawName:"v-show",value:n.isSearchLoading,expression:"isSearchLoading"}]}),!n.isSearchLoading&&n.searchResult.keyword&&0===n.searchResult.resultList.length?r("reader-panel-list-empty-view",[n._v("\n                    无结果\n                ")]):n._e()],2):n._e(),r("reader-catalog-book-info",{directives:[{name:"show",rawName:"v-show",value:!n.isInSearchMode,expression:"!isInSearchMode"}],staticClass:"readerCatalog_bookInfo",attrs:{"book-info":n.bookInfo},on:{clickBookInfo:n.handleClickBookInfo}}),r("div",{directives:[{name:"show",rawName:"v-show",value:!n.isInSearchMode,expression:"!isInSearchMode"}],staticClass:"readerCatalog_actions"},[r("div",{class:["readerCatalog_actions_inner",{empty:!n.needShowScroller}]},[n.needShowScroller?r("span",{class:{readerCatalog_scroller:!0,rotate:!this.isScrollToBottom},attrs:{"data-ignore-toolbar-update-hidden":"1"},on:{click:n.handleClickScroller}}):n._e()])]),r("ul",{directives:[{name:"show",rawName:"v-show",value:!n.isInSearchMode,expression:"!isInSearchMode"}],ref:"catalogListDom",staticClass:"readerCatalog_list"},n._l(n.chapterInfos,function(t){return r("li",{key:t.chapterUid,class:{chapterItem:!0,chapterItem_current:n.isCurrent(t),chapterItem_disabled:n.isLock(t)}},[r("a",{class:["chapterItem_link","chapterItem_level"+t.level,{}],attrs:{href:"javascript:"},on:{click:function(e){return n.handleClickChapter(t.chapterUid)}}},[r("span",{staticClass:"chapterItem_text"},[n._v(n._s(n.getChapterTitle(t)))]),n.isLock(t)?r("span",{staticClass:"chapterItem_lock"}):n._e()])])}),0)],1)])],1)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},821:function(e,t,n){"use strict";function r(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["readerBottomBar",{showShadow:t.showShadow}]},[t._m(0),n("a",{staticClass:"rbb_item catalog",attrs:{title:"目录",href:"javascript:"},on:{click:function(e){return e.stopPropagation(),t.emitClick("catalog")}}},[n("span",{staticClass:"icon"}),n("span",{staticClass:"txt"},[t._v("目录")])]),n("a",{staticClass:"rbb_item setting",attrs:{title:"设置",href:"javascript:"},on:{click:function(e){return e.stopPropagation(),t.emitClick("setting")}}},[n("span",{staticClass:"icon"}),n("span",{staticClass:"txt"},[t._v("设置")])]),t.showAddShelfButton?n("a",{staticClass:"rbb_addShelf wr_btn wr_btn_Big",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),t.emitClick("shelf")}}},[n("span",{staticClass:"rbb_addShelf_icon"}),n("span",{staticStyle:{"vertical-align":"middle"}},[t._v("加入书架")])]):n("a",{staticClass:"rbb_addShelf wr_btn wr_btn_Big added",attrs:{href:"/web/shelf"},on:{click:function(e){return e.stopPropagation(),t.saveReportInfo("Reader_BottomBar")}}},[n("span",{staticClass:"rbb_addShelf_icon"}),n("span",{staticStyle:{"vertical-align":"middle"}},[t._v("去书架查看")])])])}var o=[function(){var e=this.$createElement,t=this._self._c||e;return t("a",{staticClass:"rbb_item home",attrs:{title:"书城",href:"/"}},[t("span",{staticClass:"icon"}),t("span",{staticClass:"txt"},[this._v("书城")])])}];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},822:function(e,t,n){"use strict";function r(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"readerTopBar"},[n("a",{staticClass:"readerTopBar_home",attrs:{href:"/",title:"微信读书书城"},on:{click:function(e){return t.saveReportInfo("Reader_Home")}}},[t._v("微信读书书城")]),n("span",{staticClass:"readerTopBar_title"},[n("a",{staticClass:"readerTopBar_title_link",attrs:{href:"javascript:"},on:{click:function(e){return t.emitClickItem("firstChapter")}}},[t._v(t._s(t.bookTitleString))]),n("span",{staticClass:"readerTopBar_title_chapter"},[t._v(t._s(t.chapterTitleString))])]),n("div",{staticClass:"readerTopBar_actions"},[t.isShowAddShelf?n("a",{staticClass:"actionItem addShelfItem added",attrs:{href:"javascript:"},on:{click:function(e){return t.emitClickItem("addShelf")}}},[t._v("\n            加入书架\n        ")]):n("a",{staticClass:"actionItem addShelfItem",attrs:{href:"/web/shelf"},on:{click:function(e){return t.saveReportInfo("Reader_NavBar")}}},[t._v("\n            去书架查看\n        ")])]),n("div",{staticClass:"readerTopBar_right"},[t.hasLogin?n("Menu",{ref:"topBar_avatarMenu",staticClass:"js_reader_navBarMenu",attrs:{defaultSelectedIndex:0,optionList:t.avatarOptionList,align:"right"},on:{"handle-click-menu-option":t.handleClickAvatarMenuOption}},[n("avatar",{attrs:{clickable:!0,src:t.user.avatar,"custom-selector":"readerTopBar_avatar"},on:{click:t.handleClickAvatar}})],1):t._e(),t.canShowLogin?n("a",{staticClass:"actionItem",attrs:{href:"javascript:"},on:{click:function(e){return t.emitClickItem("login")}}},[t._v("\n            登录\n        ")]):t._e()],1)])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},823:function(e,t,n){"use strict";function r(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"readerControls"},[n("a",{class:{readerControls_item:!0,catalog:!0,disabled:t.disableChapterLink},attrs:{href:"javascript:",title:"目录"},on:{click:function(e){return t.emitClick("catalog")}}},[n("span",{staticClass:"icon"})]),n("a",{staticClass:"readerControls_item note",attrs:{href:"javascript:",title:"笔记"},on:{click:function(e){return t.emitClick("note")}}},[n("span",{staticClass:"icon"})]),n("div",{class:["readerControls_fontSize",{expand:t.isFontSizeExpand}]},[n("a",{staticClass:"fontSizeButton",attrs:{href:"javascript:",title:"字号"},on:{click:t.toggleFontSizeExpand}},[n("span",{staticClass:"fontSizeButton_bg"}),n("span",{staticClass:"icon"})]),n("div",{staticClass:"fontSizeSliderContainer"},[n("vue-slider",{ref:"fontSizeSlider",attrs:{lazy:!0,adsorb:!0,contained:!1,tooltip:"none",hideLabel:!0,duration:0,data:t.fontSizeLevels,marks:t.fontSizeLevels,disabled:t.disableFontSizeSlider,dotSize:9,processStyle:{display:"none"}},on:{change:t.emitFontSizeLevelChange},model:{value:t.fontSizeLevel,callback:function(e){t.fontSizeLevel=e},expression:"fontSizeLevel"}})],1)]),t.isFromWeReadApp?t._e():n("a",{class:["readerControls_item",{dark:t.isWhiteTheme,white:!t.isWhiteTheme}],attrs:{href:"javascript:",title:t.isWhiteTheme?"深色":"浅色"},on:{click:function(e){return t.emitClick("theme")}}},[n("span",{staticClass:"icon"})]),n("a",{staticClass:"readerControls_item download",attrs:{href:"javascript:",title:"下载App"},on:{click:function(e){return t.emitClick("download")}}},[n("span",{staticClass:"icon"})]),t.isShowSearchHint?n("a",{staticClass:"readerControls_catalog_hint",style:{minWidth:t.searchHintTotalCount?"120px":"60px"},attrs:{href:"javascript:"},on:{click:function(e){return t.emitClick("catalog")}}},[t._v("\n        "+t._s(t.searchHint)+"\n    ")]):t._e()])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},824:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showing?n("div",[n("div",{staticClass:"reader_footerNote_mask",on:{click:e.handleMaskClick}}),n("div",{ref:"footerNote_container",staticClass:"reader_footerNote_container",style:e.customStyle},[n("div",{ref:"footerNote_bubble",staticClass:"reader_footerNote_bubble"},[n("p",{staticClass:"reader_footerNote_text"},[e._v(e._s(e.text))])])])]):e._e()}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},826:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dialog",{ref:"dialog"},[n("div",{staticClass:"rcv_succ_dialog_content"},[n("div",{staticClass:"rcv_succ_dialog_head"},[n("span",{staticClass:"rcv_succ_dialog_img"}),n("div",{staticClass:"rcv_succ_dialog_title"},[e._v(e._s(e.titleText))])]),n("div",{staticClass:"rcv_succ_dialog_foot"},[n("img",{staticClass:"rcv_succ_dialog_foot_qrcode",attrs:{src:e.qrCodeImg,alt:"扫码下载"}}),n("div",{staticClass:"rcv_succ_dialog_foot_right"},[n("div",{staticClass:"line1"},[e._v("下载微信读书 App")]),n("div",{staticClass:"line2"},[e._v("获得更多福利· 全场书籍免费读")])])])])])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},829:function(e,t,n){"use strict";function r(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{directives:[{name:"show",rawName:"v-show",value:n.showing,expression:"showing"}],ref:"toolbarContainer",class:["reader_toolbar_container",{below:n.isBelow}],style:n.posStyle},[r("div",{staticClass:"reader_toolbar_content"},[r("div",{staticClass:"reader_toolbar_itemContainer"},n._l(n.showItems,function(t){return r("a",{key:t.key,class:["toolbarItem"].concat(t.classNames),attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),n.handleClickItem(t)}}},[r("span",{staticClass:"icon"}),r("span",{staticClass:"text"},[n._v(n._s(t.text))])])}),0)]),r("span",{staticClass:"arrow",style:n.arrowStyle})])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},830:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sectionListItem"},[e.showSectionTitle?n("div",{staticClass:"sectionListItem_title"},[e._v(e._s(e.sectionTitle))]):n("div",{class:["sectionListItem_divider",{leftIndent:e.dividerLeftIndent}]}),n("a",{class:["sectionListItem_content",e.customContentClass],attrs:{href:"javascript:"},on:{click:e.emitClickItem}},[e._t("default")],2)])}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},831:function(e,t,n){"use strict";function r(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticClass:"readerCatalog_bookInfo",attrs:{href:"javascript:"},on:{click:e.emitClickBookInfo}},[n("book-cover",{attrs:{"custom-selector":"readerCatalog_bookInfo_cover",src:e.bookInfo.cover||"","need-gradient-decor":!0}}),n("div",{staticClass:"readerCatalog_bookInfo_right"},[n("h2",{staticClass:"readerCatalog_bookInfo_title"},[n("span",{staticClass:"readerCatalog_bookInfo_title_txt"},[e._v(e._s(e.bookInfo.title))]),n("span",{staticClass:"readerCatalog_bookInfo_title_arrow"})]),n("div",{staticClass:"readerCatalog_bookInfo_author"},[e._v(e._s(e.bookInfo.author))]),e.updateTimeString?n("div",{staticClass:"readerCatalog_bookInfo_updateTime"},[e._v(e._s(e.updateTimeString))]):e._e()])],1)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},832:function(e,t,n){"use strict";function r(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"panelListLoadingView"},[t("Loading",{attrs:{zoom:"0.3"}})],1)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},833:function(e,t,n){"use strict";function r(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"panelListEmptyView"},[this._t("default")],2)}var o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})}}]);